{"version":3,"sources":["fluent/Localized.js","functions.js","graphql/queries.js","components/PopoverMenu.js","hooks/useUser.js","graphql/mutations.js","markdown.js","components/DataTransmat.js","components/view/ViewerTextCard.js","components/view/ViewerButtonCard.js","components/view/ViewerDividerLine.js","components/view/ViewerCheckboxCard.js","components/view/ViewerLine.js","hooks/useBlockTrigger.js","components/view/ViewerAuto.js","hooks/useLoadBlocks.js","hooks/useMutation.js","components/Popover.js","fluent/fluentBy.js","components/DataTransmat.module.css","components/view/ViewerLine.module.css","components/view/ViewerAuto.module.css"],"names":["Localized","props","elems","br","Fragment","children","id","withLocalization","Inner","l10n","React","useContext","FluentContext","createElement","fluentByObject","object","fallback","globalSupportedLocales","supportedLocales","thisSupportedLocales","Object","keys","filter","locale","includes","currentLocales","negotiateLanguages","userLocales","defaultLocale","getString","args","translateBlock","block","properties","text","Array","isArray","translations","correct_translations","fluentBy","fluentByArray","length","useLocalization","fluentByAny","any","hexToRGBArray","color","startsWith","substring","charAt","Error","rgb","i","parseInt","substr","getContrastingColor","luma","colorToHex","rgba","cvs","ctx","document","height","width","getContext","fillStyle","fillRect","getImageData","data","colorToRGBA","map","idx","toString","slice","join","module","exports","getImageUrl","imageObj","type","url","getBlockColor","colors","colorRGB","contrastingColor","contrastingColorRGB","hasOwnProperty","newColor","parsedColor","getBlock_Query","gql","getBlocks_Query","getSelf_Query","getParentBlocks_Query","blockMatchesRoles_Query","checkPath_Query","PopoverMenu","trigger","onToogle","paperProps","closePopover","open","popoverProps","sx","paperPropsRest","maxWidth","maxHeight","overflow","background","elevation","autoFocus","style","marginTop","isOpen","close","opacity","marginBottom","className","onClick","defaultUser","userroles","useUser","forceRefetch","mountedRef","useRef","useEffect","current","useState","user","setUser","loggedIn","setLoggedIn","apollo_client","useApolloClient","window","logged_in","query","then","a","self","catch","error","console","saveBlock_Mutation","archiveBlock_Mutation","unarchiveBlock_Mutation","moveBlock_Mutation","getMD","options","md","mdit","html","xhtmlOut","linkify","typographer","breaks","use","kbd","emoji","renderInlineMarkdown","replace","renderInline","twemoji","parse","folder","ext","base","DataBothWays","onTransmit","onReceive","draggable","bothwayRef","unlistenTransmit","addListeners","event","transmat","Transmat","setData","unlistenReceive","hasType","accept","payload","getData","JSON","preventDefault","obs","TransmatObserver","entries","entry","target","classList","toggle","classes","drag_over","isTarget","drag_active","isActive","observe","disconnect","ref","tabIndex","ViewerTextCard","locales","__html","setHtml","textWithHtml","defaultProps","dir","whiteSpace","text_style","component","dangerouslySetInnerHTML","ViewerButtonCard","actions","action","colorStyles","hasClickAction","href","rel","margin","click","disabled","ViewerDividerLine","styles","ViewerCheckboxCard","checked","Boolean","checkboxStyle","verticalAlign","paddingInlineEnd","CheckBox","CheckBoxOutlineBlank","ViewerLine","link","setLink","path","setPath","newLink","newPath","blockId","_id","triggerProperties","triggerType","actionProperties","actionType","domains","frontend","useBlockTrigger","title","cron","stringify","isSquareIcon","icon_url","icon","coverphoto","iconComponent","square","round","backgroundImage","backend","imageFormat","encodeURIComponent","alt","cardOnClick","cardLink","root","display","cursor","alignItems","to","onClickProps","ViewerAuto","size","dragable","mutationFunction","useMutation","useCallback","movingBlock","mutation","variables","movingBlockId","newParentId","newIndex","useLoadBlocks","handleLoadBlocks","Promise","resolve","errors","blocks","option","reject","mutate","Popover","setOpenBlockMenuRef","anchorRef","setOpen","setOpenExternal","newOpen","Math","random","undefined","prevOpen","pointerEvents","position","top","right","bottom","left","zIndex","anchorEl","transition","placement","disablePortal","modifiers","name","enabled","altBoundary","rootBoundary","padding","TransitionProps","transformOrigin","require","lookupedLocale","strategy","array","key","item","result","value"],"mappings":"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","file":"static/js/2.535d1bd2.chunk.js","sourcesContent":["import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\nimport fluentBy from './fluentBy.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\n\nfunction translateBlock (block, userLocales, fallback) {\n  const {\n    properties = {}\n  } = block || {}\n  \n  let locale = properties.locale || 'en'\n  let text = properties.text || fallback || ''\n\n  if (!userLocales || !Array.isArray(userLocales)) {\n    userLocales = [locale]\n  }\n    \n  let translations = properties.translations || []\n  if (Array.isArray(translations)) {\n    translations = [\n      {\n        locale,\n        text,\n      },\n      ...translations,\n    ]\n\n    const correct_translations = fluentBy.fluentByArray(translations, userLocales, 'locale')\n    if (correct_translations.length > 0) {\n      text = correct_translations[0].text\n    }\n  }\n\n  return text\n}\n\nfunction useLocalization() {\n  const l10n = React.useContext(FluentContext)\n\n  const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n  const fluentByAny = (any = [], fallback = '') => fluentBy.fluentByAny(any, l10n.userLocales, fallback)\n\n  return {\n    ...l10n,\n    getString,\n    fluentByAny,\n    translateBlock,\n  }\n}\n\nexport {\n  negotiateLanguages,\n  withLocalization,\n  Localized,\n  Localized as default,\n  useLocalization,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","function getImageUrl(imageObj) {\n  if (\n    typeof imageObj === 'object'\n    && imageObj !== null\n    && !Array.isArray(imageObj)\n  ) {\n    if (imageObj.type === 'url') {\n      return imageObj.url || ''\n    }\n  }\n\n  return ''\n}\n\n\n\nfunction hexToRGBArray(color) {\n  if (color.startsWith('#')) {\n    color = color.substring(1)\n  }\n\n  if (color.length === 3) {\n    color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);\n  } else if (color.length !== 6) {\n    throw(new Error('Invalid hex color: ' + color));\n  }\n\n  let rgb = [];\n  for (var i = 0; i <= 2; i++) {\n    rgb[i] = parseInt(color.substr(i * 2, 2), 16);\n  }\n\n  return rgb;\n}\nfunction luma(color) { \n  // color can be a hex string or an array of RGB values 0-255\n  const rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;\n  return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings\n}\nfunction getContrastingColor(color) {\n  // source: https://stackoverflow.com/questions/635022/calculating-contrasting-colours-in-javascript\n  // exact answer: https://stackoverflow.com/a/6511606/2387277\n  // example: https://jsfiddle.net/thomasrosen/9njo6t7s/20/\n  \n  return (luma(color) >= 165) ? '000' : 'fff';\n}\n\n\n\n// function randomHexColor () {\n//   let color = ''\n//   for (let i = 0; i < 6; i++){\n//     const random = Math.random()\n//     const bit = (random * 16) | 0\n//     color += (bit).toString(16)\n//   }\n//   return '#'+color\n// }\n\n\n\nfunction colorToRGBA(color) {\n  // source: https://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes\n  // source: https://stackoverflow.com/a/24390910/2387277\n\n  // Returns the color as an array of [r, g, b, a] -- all range from 0 - 255\n  // color must be a valid canvas fillStyle. This will cover most anything\n  // you'd want to use.\n  // Examples:\n  // colorToRGBA('red')  # [255, 0, 0, 255]\n  // colorToRGBA('#f00') # [255, 0, 0, 255]\n  var cvs, ctx;\n  cvs = document.createElement('canvas');\n  cvs.height = 1;\n  cvs.width = 1;\n  ctx = cvs.getContext('2d');\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\nfunction byteToHex(num) {\n    // Turns a number (0-255) into a 2-character hex number (00-ff)\n    return ('0'+num.toString(16)).slice(-2);\n}\nfunction colorToHex(color) {\n    // Convert any CSS color to a hex representation\n    // Examples:\n    // colorToHex('red')            # '#ff0000'\n    // colorToHex('rgb(255, 0, 0)') # '#ff0000'\n    var rgba, hex;\n    rgba = colorToRGBA(color);\n    hex = [0,1,2].map(\n        function(idx) { return byteToHex(rgba[idx]); }\n        ).join('');\n    return \"#\"+hex;\n}\n\n\n\nfunction getBlockColor(block) {\n  const colors = {\n    color: null,\n    colorRGB: null,\n    contrastingColor: null,\n    contrastingColorRGB: null,\n  }\n\n  if (block.hasOwnProperty('properties') && block.properties.hasOwnProperty('color') && !!block.properties.color) {\n    const defaultColors = ['purple', 'red', 'green', 'blue', 'yellow']\n    let newColor = block.properties.color\n\n    if (defaultColors.includes(newColor)) {\n      colors.color = `var(--${newColor})`\n      colors.colorRGB = `var(--${newColor}-rgb)`\n      colors.contrastingColor = `var(--on-${newColor})`\n      colors.contrastingColorRGB = `var(--on-${newColor}-rgb)`\n    } else {\n      if (newColor.startsWith('#')) {\n        if (newColor.length !== 4 && newColor.length !== 7) {\n          newColor = null\n        }\n      } else {\n        const parsedColor = colorToHex(newColor)\n        if (parsedColor === '#000000' && newColor !== 'black') {\n          newColor = null\n        } else {\n          newColor = parsedColor\n        }\n      }\n\n      if (newColor) {\n        colors.color = newColor\n        const colorRGB = hexToRGBArray(newColor)\n        colors.colorRGB = colorRGB.join(', ')\n        colors.contrastingColor = '#'+getContrastingColor(newColor)\n        colors.contrastingColorRGB = hexToRGBArray(colors.contrastingColor)\n      }\n    }\n  }\n\n  return colors\n}\n\nmodule.exports = {\n  getImageUrl,\n  getBlockColor,\n}\n","import { gql } from '@apollo/client'\n\nexport const getBlock_Query = gql`\n  query getBlock ($_id: ObjectID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n        block {\n          _id\n          type\n          properties\n          content {\n            blockId\n          }\n          parent\n          metadata {\n            modified\n            modified_by\n          }\n          permissions\n          computed {\n            roles\n          }\n        }\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n      }\n    }\n  }\n`\n\nexport const getBlocks_Query = gql`\n  query getBlocks ($ids: [ObjectID], $types: [String], $archived: Boolean, $roots: [ObjectID]) {\n    blocks (ids: $ids, types: $types, archived: $archived, roots: $roots) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n      }\n    }\n  }\n`\n\nexport const getSelf_Query = gql`\n  query getSelf {\n    self {\n\t\t  logged_in\n\t\t  user\n\t\t  blockId\n      userroles\n    }\n  }\n`\n\nexport const getSiblingBlocks_Query = gql`\n  query getSiblingBlocks ($_id: ObjectID!, $types: [String]) {\n    blocks: siblingBlocks (_id: $_id, types: $types) {\n      _id\n      type\n      properties\n    }\n  }\n`\n\nexport const getParentBlocks_Query = gql`\n  query getParentBlocks ($_id: ObjectID!) {\n    blocks: parentBlocks (_id: $_id) {\n      _id\n      type\n      properties\n      computed {\n        sort\n      }\n    }\n  }\n`\n\nexport const blockMatchesRoles_Query = gql`\n  query blockMatchesRoles ($_id: ObjectID!, $roles: [String]) {\n    blockMatchesRoles (_id: $_id, roles: $roles)\n  }\n`\n\nexport const checkPath_Query = gql`\n  query checkPath ($path: String!) {\n    checkPath (path: $path) {\n      isOkay\n      errors\n    }\n  }\n`\n","import {\n  Paper,\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\nimport Popover from './Popover.js'\n\nexport default function PopoverMenu ({\n  trigger,\n  children,\n  onToogle,\n  paperProps = {},\n}) {\n  return <Popover\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({closePopover, open, ...popoverProps}) => {\n      const {\n        sx = {},\n        ...paperPropsRest\n      } = paperProps || {}\n\n      return (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n            ...sx,\n          }}\n          elevation={8}\n          {...paperPropsRest}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              marginTop: '-8px',\n            }}\n          >\n            <div>\n\n              {typeof children === 'function' ? children({ isOpen: open, close: closePopover }) : children}\n\n              <Divider style={{opacity: 0.2, marginBottom:'8px'}}  />\n\n              <MenuItem className=\"roundMenuItem\" onClick={closePopover}>\n                <ListItemIcon>\n                  <CloseIcon />\n                </ListItemIcon>\n                <ListItemText>\n                  <Localized id=\"block_menu_close_menu\" />\n                </ListItemText>\n              </MenuItem>\n\n            </div>\n          </MenuList>\n        </Paper>\n    )}}\n  </Popover>\n}\n","import { useState, useEffect, useRef } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSelf_Query } from '../graphql/queries'\n\nconst defaultUser = {\n  userroles: [],\n}\n\nexport default function useUser(forceRefetch = false) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const [user, setUser] = useState(defaultUser)\n  const [loggedIn, setLoggedIn] = useState(false)\n\n  const apollo_client = useApolloClient()\n\n  useEffect(() => {\n    if (forceRefetch !== true && window.hasOwnProperty('user')) {\n      setUser({\n        ...window.user,\n        userroles: window.user.userroles || [],\n      })\n      setLoggedIn(window.user.logged_in)\n    } else {\n      apollo_client.query({\n        query: getSelf_Query,\n      })\n        .then(async ({ data }) => {\n          if (mountedRef.current === true) {\n            if (data.hasOwnProperty('self') && data.self !== null) {\n              window.user = data.self\n              setUser({\n                ...data.self,\n                userroles: data.self.userroles || [],\n              })\n              setLoggedIn(data.self.logged_in)\n            } else {\n              setUser(defaultUser)\n              setLoggedIn(false)\n            }\n          }\n        })\n        .catch(error => {\n          console.error(error)\n          if (mountedRef.current === true) {\n            setUser(defaultUser)\n            setLoggedIn(false)\n          }\n        })\n    }\n  }, [forceRefetch, setUser, setLoggedIn, apollo_client])\n\n  return {\n    ...user,\n    loggedIn,\n  }\n}\n","import { gql } from '@apollo/client'\n\nexport const saveBlock_Mutation = gql`\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n`\n\nexport const archiveBlock_Mutation = gql`\n  mutation archiveBlock ($_id: ObjectID!) {\n    archiveBlock (_id: $_id)\n  }\n`\n\nexport const unarchiveBlock_Mutation = gql`\n  mutation unarchiveBlock ($_id: ObjectID!) {\n    unarchiveBlock (_id: $_id)\n  }\n`\n\nexport const moveBlock_Mutation = gql`\n  mutation moveBlock ($movingBlockId: ObjectID!, $newParentId: ObjectID!, $newIndex: Int!) {\n    moveBlock(movingBlockId: $movingBlockId, newParentId: $newParentId, newIndex: $newIndex)\n  }\n`\n","import mdit from 'markdown-it'\nimport kbd from 'markdown-it-kbd'\nimport emoji from 'markdown-it-emoji'\nimport twemoji from 'twemoji'\n\nfunction getMD(options){\n  // var hljs = require('highlight.js') // https://highlightjs.org/\n  const md = mdit({\n    html: false,\n    xhtmlOut: false,\n    linkify: true,\n    typographer: true,\n    breaks: false,\n    // highlight: function (str, lang) {\n    //   const language_obj = hljs.getLanguage(lang)\n    //   if (lang && language_obj) {\n    //     const language = language_obj.aliases[0]\n    //     return '<pre class=\"hljs language-'+language+'\"><code>' +\n    //       hljs.highlight(str, { language, ignoreIllegals: true }).value +\n    //     '</code></pre>';\n    //   } else {\n    //     const html = hljs.highlightAuto(str, { ignoreIllegals: true })\n    //     return '<pre class=\"hljs language-'+html.language+'\"><code>' +\n    //       html.value +\n    //     '</code></pre>';\n    //   }\n\n    //   return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n    // }\n    ...options,\n  })\n\n  // md.disable([ 'heading', 'heading', 'lheading', 'paragraph', 'image' ])\n  md.use(kbd)\n  md.use(emoji)\n\n  return md\n}\n\nfunction renderInlineMarkdown(text, options = {}){\n  text = text || ''\n  // text = text.replace(/\\n/g, '<br>')\n  // text = text.replace(/\\t/g, '&emsp;')\n\n  text = text\n  .replace(/\\(TM\\)/gi, '™')\n  .replace(/\\(SM\\)/gi, '℠')\n  .replace(/\\(C\\)/gi, '©')\n  .replace(/\\(R\\)/gi, '®')\n\n  const md = getMD(options)\n  text = md.renderInline(text)\n\n  text = twemoji.parse(text, {\n    folder: 'svg',\n    ext: '.svg',\n    base: '/public/twemoji/assets/',\n    // callback: function(icon, options, variant) {\n    //   switch ( icon ) {\n    //     case 'a9':      // © copyright\n    //     case 'ae':      // ® registered trademark\n    //     case '2122':    // ™ trademark\n    //       return false\n    //     default:\n    //       return ''.concat(options.base, options.size, '/', icon, options.ext)\n    //   }\n    // }\n  })\n    \n  return text\n}\n\nexport {\n  renderInlineMarkdown,\n}\n","import { useRef, useEffect } from 'react'\n\nimport { Transmat, addListeners, TransmatObserver } from 'transmat'\nimport classes from './DataTransmat.module.css'\n\nexport function DataReceiver({ onReceive, style, className, children }){\n  const receiverRef = useRef(null)\n\n  useEffect(() => {\n    const unlisten = addListeners(receiverRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      if (transmat.hasType('application/json') && transmat.accept()) {\n        const payload = transmat.getData('application/json')\n        if (typeof onReceive === 'function') {\n          onReceive({ data: JSON.parse(payload) })\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n        if (transmat.hasType('application/json')) { // TODO: accept more than just json\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(receiverRef.current)\n\n    return () => {\n      unlisten()\n      obs.disconnect()\n    }\n  }, [ onReceive ])\n\n  return <div ref={receiverRef} style={style} className={className}>\n    {children}\n  </div>\n}\n\nexport function DataTransmiter({ onTransmit, draggable, style, className, children }){\n  const transmiterRef = useRef(null)\n\n  useEffect(() => {\n    return addListeners(transmiterRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n  }, [ onTransmit ])\n\n  return <div ref={transmiterRef} style={style} className={className} draggable={draggable ? 'true' : 'false'} tabIndex=\"0\">\n    {children}\n  </div>\n}\n\nexport function DataBothWays({ onTransmit, onReceive, draggable, style, className, children }){\n  const bothwayRef = useRef(null)\n\n  useEffect(() => {\n    const unlistenTransmit = addListeners(bothwayRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n\n    const unlistenReceive = addListeners(bothwayRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      if (transmat.hasType('application/json') && transmat.accept()) {\n        const payload = transmat.getData('application/json')\n        if (typeof onReceive === 'function') {\n          onReceive({ data: JSON.parse(payload) })\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n        if (transmat.hasType('application/json')) { // TODO: accept more than just json\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(bothwayRef.current)\n\n    return () => {\n      unlistenTransmit()\n      unlistenReceive()\n      obs.disconnect()\n    }\n  }, [ onTransmit, onReceive ])\n\n  return <div\n    ref={bothwayRef}\n    style={style}\n    className={className}\n    draggable={draggable ? 'true' : 'false'}\n    tabIndex=\"0\"\n  >\n    {children}\n  </div>\n}\n\n// Examples:\n//\n// <DataTransmiter\n//   draggable={true}\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'blue',\n//   }}\n//   onTransmit={() => ({\n//     'text/plain': 'Hello world!',\n//     'text/html': '<h1>Hello world!</h1>',\n//     'text/uri-list': 'http://example.com',\n//     'application/json': {foo:'bar'},\n//   })}\n// >\n//   DataTransmiter\n// </DataTransmiter>\n//\n// <DataReceiver\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'red',\n//   }}\n//   onReceive={data => console.info('received', data)}\n// >\n//   DataReceiver\n// </DataReceiver>\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerTextCard ({ block, style, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, '')\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text)\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n  \n  const defaultProps = {\n    dir: 'auto',\n    style: {\n      whiteSpace: 'pre-wrap',\n      ...style,\n    },\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n  if (color) {\n    defaultProps.style.color = color\n  }\n\n  let text_style = 'body'\n  if (block.properties.hasOwnProperty('text_style')) {\n    text_style = block.properties.text_style\n  }\n\n  let component = null\n  switch (text_style) {\n    case 'h1':\n      component = <h1\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h2':\n      component = <h2\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h3':\n      component = <h3\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'caption':\n      component = <caption\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    default: // body\n      component = <p\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n  }\n\n  return component\n}\n\nexport default ViewerTextCard\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerButtonCard ({ block, actions = {}, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { getString, translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, getString('placeholder_main_headline'))\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text, { linkify: false })\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n\n  let url = ''\n  if (\n    block\n    && block.properties\n    && block.properties.trigger\n    && block.properties.action\n    && block.properties.action.url\n    && block.properties.trigger.type === 'click'\n    && block.properties.action.type === 'open_url'\n  ) {\n    url = block.properties.action.url\n  }\n\n  const {\n    color,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  const hasClickAction = actions.hasOwnProperty('click')\n\n  if (hasClickAction === false && url !== '') {\n    return <a\n        href={url}\n        target=\"_blank\" rel=\"noreferrer\"\n      >\n      <button\n        dir=\"auto\"\n        dangerouslySetInnerHTML={html}\n        className=\"default square\"\n        style={{\n          margin: '0',\n          whiteSpace: 'pre-wrap',\n          ...colorStyles,\n        }}\n      ></button>\n    </a>\n  }\n\n  if (hasClickAction === true && typeof actions.click === 'function') {\n    return <button\n      dir=\"auto\"\n      dangerouslySetInnerHTML={html}\n      className=\"default square\"\n      style={{\n        margin: '0',\n        whiteSpace: 'pre-wrap',\n        ...colorStyles,\n      }}\n      onClick={actions.click}\n    ></button>\n  }\n\n  return <button\n    dir=\"auto\"\n    dangerouslySetInnerHTML={html}\n    disabled=\"disabled\"\n    className=\"default square\"\n    style={{\n      margin: '0',\n      whiteSpace: 'pre-wrap',\n      ...colorStyles,\n    }}\n  ></button>\n}\n\nexport default ViewerButtonCard\n","import { getBlockColor } from '../../functions.js'\n\nexport default function ViewerDividerLine ({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction ViewerCheckboxCard ({ block }) {\n  const text = block.properties.text || ''\n\n  const checked = Boolean(block.properties.checked)\n\n  const checkboxStyle = {\n    verticalAlign: 'middle',\n    paddingInlineEnd: 'var(--basis)',\n    height: 'calc(var(--font-add) + var(--basis))',\n    width: 'auto',\n  }\n\n  return <p dir=\"auto\">\n    {\n      checked\n      ? <CheckBoxIcon style={checkboxStyle} />\n      : <CheckBoxOutlineBlankIcon style={checkboxStyle} />\n    }\n    {text}\n  </p>\n}\n\nexport default ViewerCheckboxCard\n","import { useLocalization } from '../../fluent/Localized.js'\n\nimport { getImageUrl, getBlockColor } from '../../functions.js'\nimport useBlockTrigger from '../../hooks/useBlockTrigger.js'\n\nimport {\n  InsertDriveFile as PageIcon,\n  Face as PersonIcon,\n  LinkSharp as RedirectIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport classes from './ViewerLine.module.css'\n\nfunction ViewerLine ({ block, actions = {}, locales }) {\n  const { getString, translateBlock, userLocales } = useLocalization()\n\n  const { link, path } = useBlockTrigger({ block })\n\n  let title = translateBlock(block, locales || userLocales, '')\n  if (title === '') {\n    const triggerProperties = ((block.properties || {}).trigger || {})\n    const triggerType = triggerProperties.type\n\n    if (triggerType === 'path') {\n      title = '/'+triggerProperties.path\n    } else if (block.type === 'redirect') {\n      if (triggerType === 'click') {\n        title = triggerProperties.blockId\n      } else if (triggerType === 'cron') {\n        title = triggerProperties.cron\n      } else if (triggerType === 'block_change') {\n        title = triggerProperties.blockId\n      } else if (Object.keys(triggerProperties).length > 0) {\n        title = JSON.stringify(triggerProperties)\n      } else {\n        title = getString('placeholder_main_headline')\n      }\n    } else {\n      title = getString('placeholder_main_headline')\n    }\n  }\n  \n  let isSquareIcon = false\n  let icon_url = getImageUrl(block.properties.icon)\n  if (!icon_url) {\n    isSquareIcon = true\n    icon_url = getImageUrl(block.properties.coverphoto)\n  }\n\n  let iconComponent = null\n  if (icon_url === '') {\n    switch (block.type) {\n      case 'person':\n        iconComponent = <PersonIcon className={classes.icon} />\n        break\n      case 'redirect':\n        iconComponent = <RedirectIcon className={classes.icon} />\n        break\n      default:\n      iconComponent = <PageIcon className={classes.icon} />\n    }\n  } else {\n    iconComponent = <div className={`${classes.icon} ${isSquareIcon ? classes.square : classes.round}`} style={{ backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=40&h=40&url=${encodeURIComponent(icon_url)})` }} alt={title}></div>\n  }\n\n\n\n  let cardOnClick = null\n  let cardLink = path || link\n\n  if (actions.hasOwnProperty('link')) {\n    if (typeof actions.link === 'string') {\n      cardLink = actions.link\n    }\n  } else if (actions.hasOwnProperty('click')) {\n    if (typeof actions.click === 'function') {\n      cardOnClick = actions.click\n    }\n  }\n\n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  if (typeof cardLink === 'string' && cardLink.length > 0) {\n    if (cardLink.includes(':')) {\n      return <a\n        href={cardLink}\n        target=\"_blank\" rel=\"noreferrer\"\n        title={title}\n        className={`clickable_card ${classes.root}`}\n        style={{\n          display: 'block',\n          cursor: 'pointer',\n          color,\n          '--on-background-rgb': colorRGB,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          {iconComponent}\n          <span dir=\"auto\" className={classes.title}>{title}</span>\n        </div>\n      </a>\n    } else {\n      return <Link\n      to={cardLink}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        display: 'block',\n        cursor: 'pointer',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </Link>\n    }\n  } else {\n    const onClickProps = {}\n    if (typeof cardOnClick === 'function') {\n      onClickProps.onClick = cardOnClick\n    }\n\n    return <div\n      {...onClickProps}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        cursor: typeof cardOnClick === 'function' ? 'pointer' : 'auto',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </div>\n  }\n}\n\nexport default ViewerLine\n","import { useState, useEffect } from 'react' // useCallback\n// import { useNavigate } from 'react-router-dom'\n\nexport default function useBlockTrigger({ block = null }) {\n  const [link, setLink] = useState(null)\n  const [path, setPath] = useState(null)\n  // const [onClick, setOnClick] = useState(null)\n\n  // let navigate = useNavigate()\n\n  useEffect(() => {\n    let newLink = null\n    let newPath = null\n    // let newOnClick = null\n\n    if (block !== null) {\n      const blockId = block._id\n\n      const triggerProperties = ((block.properties || {}).trigger || {})\n      const triggerType = triggerProperties.type\n\n      const actionProperties = ((block.properties || {}).action || {})\n      const actionType = actionProperties.type\n\n      if (\n        triggerType === 'path'\n        || triggerType === 'click'\n      ) {\n        if (\n          actionType === 'open_url'\n          && typeof actionProperties.url === 'string'\n          && actionProperties.url.length > 0\n        ) {\n          const url = actionProperties.url || ''\n          newLink = url\n          newPath = null // `/${triggerProperties.path}`\n          // newOnClick = () => window.open(newLink, '_blank')\n        } else if (\n          actionType === 'render_block'\n          && typeof triggerProperties.path === 'string'\n          && triggerProperties.path.length > 0\n        ) {\n          if (\n            typeof actionProperties.blockId === 'string'\n            && actionProperties.blockId.length > 0\n          ) {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${actionProperties.blockId}`\n            newPath = `/${triggerProperties.path}=${actionProperties.blockId}`\n            // newOnClick = () => navigate(newLink)\n          } else {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${blockId}`\n            newPath = `/${triggerProperties.path}=${blockId}`\n            // newOnClick = () => navigate(newLink)\n          }\n        } else {\n          newLink = `/${blockId}/view`\n          newPath = `/${blockId}`\n          // newOnClick = () => navigate(newLink)\n        }\n        // TODO: add support for other trigger types (run_script, ...)\n      } else {\n        newLink = `${window.domains.frontend}${blockId}/view`\n        newPath = `/${blockId}`\n        // newOnClick = () => navigate(newLink)\n      }\n    }\n\n    setLink(newLink)\n    setPath(newPath)\n    // setOnClick(newOnClick)\n  }, [block, setLink, setPath]) // setOnClick, navigate\n\n  return { link, path } // onClick\n}\n","import React, { useCallback } from 'react'\n\nimport { DataBothWays } from '../DataTransmat.js'\n\nimport ViewerTextCard from './ViewerTextCard.js'\nimport ViewerButtonCard from './ViewerButtonCard.js'\nimport ViewerDividerLine from './ViewerDividerLine.js'\nimport ViewerCheckboxCard from './ViewerCheckboxCard.js'\nimport ViewerLine from './ViewerLine.js'\n\nimport classes from './ViewerAuto.module.css'\n\nimport { moveBlock_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\n\nfunction ViewerAuto ({ block = {}, actions = {}, size = 'card', dragable = false, ...props }) {\n  let component = null\n\n  const type = block.type || null\n\n  switch (type) {\n    case 'text':\n      component = <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'button':\n      component = <ViewerButtonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'divider':\n      component = <ViewerDividerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'checkbox':\n      component = <ViewerCheckboxCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'page':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'person':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'redirect':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    default:\n      component = JSON.stringify(block) // <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n  }\n\n  const mutationFunction = useMutation()\n\n  const onReceive = useCallback(({ data: movingBlock }) => {\n    if (movingBlock._id !== block._id) {\n      mutationFunction({\n        mutation: moveBlock_Mutation,\n        variables: {\n          movingBlockId: movingBlock._id,\n          newParentId: block._id,\n          newIndex: 0,\n        },\n      })\n        // .then(() => {\n        //   // TODO: reload sidebar\n        // })\n        .catch(console.error)\n    }\n  }, [ mutationFunction, block ])\n\n  return <DataBothWays\n    key={block._id}\n    draggable={dragable}\n    className={classes.root}\n    onTransmit={() => ({\n      data: {\n        // 'text/plain': 'Hello world!',\n        // 'text/html': '<h1>Hello world!</h1>',\n        // 'text/uri-list': 'http://example.com',\n        'application/json': block,\n      }\n    })}\n    onReceive={onReceive}\n  >\n    {component}\n  </DataBothWays>\n}\n\nexport default ViewerAuto\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\n\nfunction useLoadBlocks() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadBlocks = useCallback(variables => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: getBlocks_Query,\n        variables,\n      })\n        .then(async ({ errors, data }) => {\n          if (Array.isArray(errors) && errors.length > 0) {\n            throw errors\n          } else if (Array.isArray(data.blocks)) {\n            resolve(data.blocks)\n          }else{\n            throw new Error('Unknown error while loading blocks.')\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve([])\n        })\n    })\n  }, [apollo_client])\n\n  return handleLoadBlocks\n}\n\nexport default useLoadBlocks\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\n\nfunction useMutation() {\n  const apollo_client = useApolloClient()\n\n  const handleMutation = useCallback(option => {\n    return new Promise((resolve,reject) => {\n      apollo_client.mutate(option)\n        .then(({ data }) => {\n          if (typeof data.error === 'string') {\n            reject(data.error)\n          } else {\n            resolve(data)\n          }\n        })\n        .catch(reject)\n    })\n  }, [ apollo_client ])\n\n  return handleMutation\n}\n\nexport default useMutation\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport {\n  Portal,\n  Fade,\n  Popper,\n} from '@mui/material'\n\nconst randomString = () => (Math.random() + 1).toString(36).substring(7)\n\nfunction Popover ({\n  trigger,\n  children = () => {},\n  onToogle = () => {},\n  setOpenBlockMenuRef,\n}) {\n  const anchorRef = useRef(null)\n  const [open, setOpen] = useState(false)\n\n  const setOpenExternal = useCallback((newOpen) => {\n    setOpen(newOpen)\n  }, [ setOpen ])\n\n  useEffect(() => {\n    if (!!setOpenBlockMenuRef) {\n      setOpenBlockMenuRef.current = setOpenExternal\n    }\n  }, [ setOpenExternal, setOpenBlockMenuRef ])\n\n  const handlePopoverToggleClick = () => {\n    setOpen((prevOpen) => {\n      onToogle(!prevOpen)\n      return !prevOpen\n    })\n  }\n\n  const closePopover = () => {\n    onToogle(false)\n    setOpen(false)\n  }\n\n  const id = open ? 'popover-'+randomString() : undefined\n\n  return <>\n\n    {trigger(\n      {\n        ref: anchorRef,\n        'aria-describedby': id,\n        onClick: handlePopoverToggleClick,\n        style: {\n          pointerEvents: open ? 'none' : 'all',\n        },\n      }, {\n        isOpen: open,\n      }\n    )}\n\n  <Portal>\n    <div\n      onClick={closePopover}\n      style={{\n        display: (open ? 'block' : 'none'),\n        position: 'fixed',\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n        zIndex: 1299,\n        cursor: 'pointer',\n      }}\n    />\n\n    <Popper\n      id={id}\n      open={open}\n      anchorEl={anchorRef.current}\n      transition\n      placement=\"bottom-start\"\n      disablePortal={true}\n      modifiers={[\n        {\n          name: 'flip',\n          enabled: true,\n          options: {\n            altBoundary: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n      ]}\n      style={{\n        zIndex: 1300,\n      }}\n    >\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps}>\n          <div>\n          {\n            !!children && typeof children === 'function'\n            ? children({\n              open,\n              style: {\n                transformOrigin: 'top left',\n              },\n              closePopover,\n            })\n            : null\n          }\n          </div>\n        </Fade>\n      )}\n    </Popper>\n\n    </Portal>\n  </>\n}\n\nexport default Popover\n","const { negotiateLanguages } = require('@fluent/langneg')\n\nfunction fluentByObject(object = {}, userLocales = ['en']){\n  const supportedLocales = Object.keys(object)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return object[lookupedLocale[0]]\n}\n\nfunction fluentByArray(array = [], userLocales = ['en'], key = 'locale') {\n  const supportedLocales = array.map(item => item[key]).filter(Boolean)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return array.filter(item => item[key] === lookupedLocale[0])\n}\n\nfunction fluentByAny(any = '', userLocales = ['en'], fallback = '') {\n  if (Array.isArray(any)) {\n    const result = fluentByArray(any, userLocales)\n    if (Array.isArray(result) && result.length > 0) {\n      any = result[0].value\n    }\n  } else if (typeof any === 'object') {\n    any = fluentByObject(any, userLocales)\n  }\n  if (typeof any !== 'string') {\n    any = fallback\n  }\n  return any\n}\n\nmodule.exports = {\n  fluentByObject,\n  fluentByArray,\n  fluentByAny,\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"drag_over\":\"DataTransmat_drag_over__3XVzh\",\"drag_active\":\"DataTransmat_drag_active__2nwCM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerLine_icon__DvsyX\",\"square\":\"ViewerLine_square__3knjg\",\"round\":\"ViewerLine_round__1pnCx\",\"title\":\"ViewerLine_title__35XNW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ViewerAuto_root__1p6KG\"};"],"sourceRoot":""}