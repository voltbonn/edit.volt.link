{"version":3,"sources":["fluent/Localized.js","functions.js","graphql/queries.js","hooks/useUser.js","components/PopoverMenu.js","graphql/mutations.js","markdown.js","components/DataTransmat.js","components/view/ViewerTextCard.js","components/view/ViewerButtonCard.js","components/view/ViewerDividerLine.js","components/view/ViewerCheckboxCard.js","components/view/ViewerLine.js","hooks/useBlockTrigger.js","components/view/ViewerAuto.js","hooks/useLoadBlocks.js","hooks/useMutation.js","components/Popover.js","fluent/fluentBy.js","components/DataTransmat.module.css","components/view/ViewerLine.module.css","components/view/ViewerAuto.module.css"],"names":["Localized","props","elems","br","Fragment","children","id","withLocalization","Inner","l10n","React","useContext","FluentContext","createElement","fluentByObject","object","fallback","globalSupportedLocales","supportedLocales","thisSupportedLocales","Object","keys","filter","locale","includes","currentLocales","negotiateLanguages","userLocales","defaultLocale","getString","args","translateBlock","block","properties","text","Array","isArray","translations","correct_translations","fluentBy","fluentByArray","length","useLocalization","fluentByAny","any","hexToRGBArray","color","startsWith","substring","charAt","Error","rgb","i","parseInt","substr","getContrastingColor","luma","colorToHex","rgba","cvs","ctx","document","height","width","getContext","fillStyle","fillRect","getImageData","data","colorToRGBA","map","idx","toString","slice","join","module","exports","getImageUrl","imageObj","type","url","getBlockColor","colors","colorRGB","contrastingColor","contrastingColorRGB","hasOwnProperty","newColor","parsedColor","getBlock_Query","gql","getBlocks_Query","getSelf_Query","getParentBlocks_Query","blockMatchesRoles_Query","checkPath_Query","defaultUser","userroles","useUser","forceRefetch","mountedRef","useRef","useEffect","current","useState","user","setUser","loggedIn","setLoggedIn","apollo_client","useApolloClient","window","logged_in","query","then","a","self","catch","error","console","PopoverMenu","trigger","onToogle","paperProps","closePopover","open","popoverProps","sx","paperPropsRest","maxWidth","maxHeight","overflow","background","elevation","autoFocus","style","marginTop","isOpen","close","opacity","marginBottom","className","onClick","saveBlock_Mutation","saveProperty_Mutation","archiveBlock_Mutation","unarchiveBlock_Mutation","moveBlock_Mutation","getMD","options","md","mdit","html","xhtmlOut","linkify","typographer","breaks","use","kbd","emoji","renderInlineMarkdown","replace","renderInline","twemoji","parse","folder","ext","base","getTransmatOptions","transmat","mimetypes","mimetype","hasType","JSON","getData","DataBothWays","onTransmit","onReceive","checkEntry","draggable","bothwayRef","unlistenTransmit","addListeners","event","Transmat","setData","unlistenReceive","isOkay","accept","preventDefault","obs","TransmatObserver","entries","entry","target","classList","toggle","classes","drag_over","isTarget","drag_active","isActive","observe","disconnect","ref","tabIndex","ViewerTextCard","locales","__html","setHtml","textWithHtml","defaultProps","dir","whiteSpace","text_style","component","dangerouslySetInnerHTML","ViewerButtonCard","actions","action","colorStyles","hasClickAction","href","rel","margin","click","disabled","ViewerDividerLine","styles","ViewerCheckboxCard","checked","Boolean","checkboxStyle","verticalAlign","paddingInlineEnd","CheckBox","CheckBoxOutlineBlank","ViewerLine","link","setLink","path","setPath","newLink","newPath","blockId","_id","triggerProperties","triggerType","actionProperties","actionType","domains","frontend","useBlockTrigger","title","cron","stringify","isSquareIcon","icon_url","icon","coverphoto","iconComponent","square","round","backgroundImage","backend","imageFormat","encodeURIComponent","alt","cardOnClick","cardLink","root","display","cursor","alignItems","to","onClickProps","removeProperty","obj","prop","ViewerAuto","size","dragable","getPressedKeys","pressedKeysRef","Set","onKeyDown","key","toLowerCase","add","onKeyUp","delete","addEventListener","removeEventListener","usePressedKeys","mutationFunction","useMutation","useCallback","json","movingBlock","block_roles","computed","roles","movingBlock_roles","pressedKeys","everything_updated","mutation","variables","movingBlockId","newParentId","newIndex","has","value","log","handleCheckEntry","this_roles","useLoadBlocks","handleLoadBlocks","Promise","resolve","errors","blocks","option","reject","mutate","Popover","setOpenBlockMenuRef","anchorRef","setOpen","setOpenExternal","newOpen","Math","random","undefined","prevOpen","pointerEvents","position","top","right","bottom","left","zIndex","anchorEl","transition","placement","disablePortal","modifiers","name","enabled","altBoundary","rootBoundary","padding","TransitionProps","transformOrigin","require","lookupedLocale","strategy","array","item","result"],"mappings":"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","file":"static/js/2.d6e13cd0.chunk.js","sourcesContent":["import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\nimport fluentBy from './fluentBy.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\n\nfunction translateBlock (block, userLocales, fallback) {\n  const {\n    properties = {}\n  } = block || {}\n  \n  let locale = properties.locale || 'en'\n  let text = properties.text || fallback || ''\n\n  if (!userLocales || !Array.isArray(userLocales)) {\n    userLocales = [locale]\n  }\n    \n  let translations = properties.translations || []\n  if (Array.isArray(translations)) {\n    translations = [\n      {\n        locale,\n        text,\n      },\n      ...translations,\n    ]\n\n    const correct_translations = fluentBy.fluentByArray(translations, userLocales, 'locale')\n    if (correct_translations.length > 0) {\n      text = correct_translations[0].text\n    }\n  }\n\n  return text\n}\n\nfunction useLocalization() {\n  const l10n = React.useContext(FluentContext)\n\n  const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n  const fluentByAny = (any = [], fallback = '') => fluentBy.fluentByAny(any, l10n.userLocales, fallback)\n\n  return {\n    ...l10n,\n    getString,\n    fluentByAny,\n    translateBlock,\n  }\n}\n\nexport {\n  negotiateLanguages,\n  withLocalization,\n  Localized,\n  Localized as default,\n  useLocalization,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","function getImageUrl(imageObj) {\n  if (\n    typeof imageObj === 'object'\n    && imageObj !== null\n    && !Array.isArray(imageObj)\n  ) {\n    if (imageObj.type === 'url') {\n      return imageObj.url || ''\n    }\n  }\n\n  return ''\n}\n\n\n\nfunction hexToRGBArray(color) {\n  if (color.startsWith('#')) {\n    color = color.substring(1)\n  }\n\n  if (color.length === 3) {\n    color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);\n  } else if (color.length !== 6) {\n    throw(new Error('Invalid hex color: ' + color));\n  }\n\n  let rgb = [];\n  for (var i = 0; i <= 2; i++) {\n    rgb[i] = parseInt(color.substr(i * 2, 2), 16);\n  }\n\n  return rgb;\n}\nfunction luma(color) { \n  // color can be a hex string or an array of RGB values 0-255\n  const rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;\n  return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings\n}\nfunction getContrastingColor(color) {\n  // source: https://stackoverflow.com/questions/635022/calculating-contrasting-colours-in-javascript\n  // exact answer: https://stackoverflow.com/a/6511606/2387277\n  // example: https://jsfiddle.net/thomasrosen/9njo6t7s/20/\n  \n  return (luma(color) >= 165) ? '000' : 'fff';\n}\n\n\n\n// function randomHexColor () {\n//   let color = ''\n//   for (let i = 0; i < 6; i++){\n//     const random = Math.random()\n//     const bit = (random * 16) | 0\n//     color += (bit).toString(16)\n//   }\n//   return '#'+color\n// }\n\n\n\nfunction colorToRGBA(color) {\n  // source: https://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes\n  // source: https://stackoverflow.com/a/24390910/2387277\n\n  // Returns the color as an array of [r, g, b, a] -- all range from 0 - 255\n  // color must be a valid canvas fillStyle. This will cover most anything\n  // you'd want to use.\n  // Examples:\n  // colorToRGBA('red')  # [255, 0, 0, 255]\n  // colorToRGBA('#f00') # [255, 0, 0, 255]\n  var cvs, ctx;\n  cvs = document.createElement('canvas');\n  cvs.height = 1;\n  cvs.width = 1;\n  ctx = cvs.getContext('2d');\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\nfunction byteToHex(num) {\n    // Turns a number (0-255) into a 2-character hex number (00-ff)\n    return ('0'+num.toString(16)).slice(-2);\n}\nfunction colorToHex(color) {\n    // Convert any CSS color to a hex representation\n    // Examples:\n    // colorToHex('red')            # '#ff0000'\n    // colorToHex('rgb(255, 0, 0)') # '#ff0000'\n    var rgba, hex;\n    rgba = colorToRGBA(color);\n    hex = [0,1,2].map(\n        function(idx) { return byteToHex(rgba[idx]); }\n        ).join('');\n    return \"#\"+hex;\n}\n\n\n\nfunction getBlockColor(block) {\n  const colors = {\n    color: null,\n    colorRGB: null,\n    contrastingColor: null,\n    contrastingColorRGB: null,\n  }\n\n  if (block.hasOwnProperty('properties') && block.properties.hasOwnProperty('color') && !!block.properties.color) {\n    const defaultColors = ['purple', 'red', 'green', 'blue', 'yellow']\n    let newColor = block.properties.color\n\n    if (defaultColors.includes(newColor)) {\n      colors.color = `var(--${newColor})`\n      colors.colorRGB = `var(--${newColor}-rgb)`\n      colors.contrastingColor = `var(--on-${newColor})`\n      colors.contrastingColorRGB = `var(--on-${newColor}-rgb)`\n    } else {\n      if (newColor.startsWith('#')) {\n        if (newColor.length !== 4 && newColor.length !== 7) {\n          newColor = null\n        }\n      } else {\n        const parsedColor = colorToHex(newColor)\n        if (parsedColor === '#000000' && newColor !== 'black') {\n          newColor = null\n        } else {\n          newColor = parsedColor\n        }\n      }\n\n      if (newColor) {\n        colors.color = newColor\n        const colorRGB = hexToRGBArray(newColor)\n        colors.colorRGB = colorRGB.join(', ')\n        colors.contrastingColor = '#'+getContrastingColor(newColor)\n        colors.contrastingColorRGB = hexToRGBArray(colors.contrastingColor)\n      }\n    }\n  }\n\n  return colors\n}\n\nmodule.exports = {\n  getImageUrl,\n  getBlockColor,\n}\n","import { gql } from '@apollo/client'\n\nexport const getBlock_Query = gql`\n  query getBlock ($_id: ObjectID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n        block {\n          _id\n          type\n          properties\n          content {\n            blockId\n          }\n          parent\n          metadata {\n            modified\n            modified_by\n          }\n          permissions\n          computed {\n            roles\n            inherited_block_permissions\n          }\n        }\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getBlocks_Query = gql`\n  query getBlocks ($ids: [ObjectID], $types: [String], $archived: Boolean, $roots: [ObjectID]) {\n    blocks (ids: $ids, types: $types, archived: $archived, roots: $roots) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getSelf_Query = gql`\n  query getSelf {\n    self {\n\t\t  logged_in\n\t\t  user\n\t\t  blockId\n      userroles\n    }\n  }\n`\n\nexport const getSiblingBlocks_Query = gql`\n  query getSiblingBlocks ($_id: ObjectID!, $types: [String]) {\n    blocks: siblingBlocks (_id: $_id, types: $types) {\n      _id\n      type\n      properties\n    }\n  }\n`\n\nexport const getParentBlocks_Query = gql`\n  query getParentBlocks ($_id: ObjectID!) {\n    blocks: parentBlocks (_id: $_id) {\n      _id\n      type\n      properties\n      computed {\n        sort\n      }\n    }\n  }\n`\n\nexport const blockMatchesRoles_Query = gql`\n  query blockMatchesRoles ($_id: ObjectID!, $roles: [String]) {\n    blockMatchesRoles (_id: $_id, roles: $roles)\n  }\n`\n\nexport const checkPath_Query = gql`\n  query checkPath ($path: String!) {\n    checkPath (path: $path) {\n      isOkay\n      errors\n    }\n  }\n`\n","import { useState, useEffect, useRef } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSelf_Query } from '../graphql/queries'\n\nconst defaultUser = {\n  userroles: [],\n}\n\nexport default function useUser(forceRefetch = false) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const [user, setUser] = useState(defaultUser)\n  const [loggedIn, setLoggedIn] = useState(false)\n\n  const apollo_client = useApolloClient()\n\n  useEffect(() => {\n    if (forceRefetch !== true && window.hasOwnProperty('user')) {\n      setUser({\n        ...window.user,\n        userroles: window.user.userroles || [],\n      })\n      setLoggedIn(window.user.logged_in)\n    } else {\n      apollo_client.query({\n        query: getSelf_Query,\n      })\n        .then(async ({ data }) => {\n          if (mountedRef.current === true) {\n            if (data.hasOwnProperty('self') && data.self !== null) {\n              window.user = data.self\n              setUser({\n                ...data.self,\n                userroles: data.self.userroles || [],\n              })\n              setLoggedIn(data.self.logged_in)\n            } else {\n              setUser(defaultUser)\n              setLoggedIn(false)\n            }\n          }\n        })\n        .catch(error => {\n          console.error(error)\n          if (mountedRef.current === true) {\n            setUser(defaultUser)\n            setLoggedIn(false)\n          }\n        })\n    }\n  }, [forceRefetch, setUser, setLoggedIn, apollo_client])\n\n  return {\n    ...user,\n    loggedIn,\n  }\n}\n","import {\n  Paper,\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\nimport Popover from './Popover.js'\n\nexport default function PopoverMenu ({\n  trigger,\n  children,\n  onToogle,\n  paperProps = {},\n}) {\n  return <Popover\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({closePopover, open, ...popoverProps}) => {\n      const {\n        sx = {},\n        ...paperPropsRest\n      } = paperProps || {}\n\n      return (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n            ...sx,\n          }}\n          elevation={8}\n          {...paperPropsRest}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              marginTop: '-8px',\n            }}\n          >\n            <div>\n\n              {typeof children === 'function' ? children({ isOpen: open, close: closePopover }) : children}\n\n              <Divider style={{opacity: 0.2, marginBottom:'8px'}}  />\n\n              <MenuItem className=\"roundMenuItem\" onClick={closePopover}>\n                <ListItemIcon>\n                  <CloseIcon />\n                </ListItemIcon>\n                <ListItemText>\n                  <Localized id=\"block_menu_close_menu\" />\n                </ListItemText>\n              </MenuItem>\n\n            </div>\n          </MenuList>\n        </Paper>\n    )}}\n  </Popover>\n}\n","import { gql } from '@apollo/client'\n\nexport const saveBlock_Mutation = gql`\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n`\n\nexport const saveProperty_Mutation = gql`\n  mutation saveProperty ($_id: ObjectID!, $key: String!, $value: JSON) {\n    saveProperty (_id: $_id, key: $key, value: $value)\n  }\n`\n\nexport const archiveBlock_Mutation = gql`\n  mutation archiveBlock ($_id: ObjectID!) {\n    archiveBlock (_id: $_id)\n  }\n`\n\nexport const unarchiveBlock_Mutation = gql`\n  mutation unarchiveBlock ($_id: ObjectID!) {\n    unarchiveBlock (_id: $_id)\n  }\n`\n\nexport const moveBlock_Mutation = gql`\n  mutation moveBlock ($movingBlockId: ObjectID!, $newParentId: ObjectID!, $newIndex: Int!) {\n    moveBlock(movingBlockId: $movingBlockId, newParentId: $newParentId, newIndex: $newIndex)\n  }\n`\n","import mdit from 'markdown-it'\nimport kbd from 'markdown-it-kbd'\nimport emoji from 'markdown-it-emoji'\nimport twemoji from 'twemoji'\n\nfunction getMD(options){\n  // var hljs = require('highlight.js') // https://highlightjs.org/\n  const md = mdit({\n    html: false,\n    xhtmlOut: false,\n    linkify: true,\n    typographer: true,\n    breaks: false,\n    // highlight: function (str, lang) {\n    //   const language_obj = hljs.getLanguage(lang)\n    //   if (lang && language_obj) {\n    //     const language = language_obj.aliases[0]\n    //     return '<pre class=\"hljs language-'+language+'\"><code>' +\n    //       hljs.highlight(str, { language, ignoreIllegals: true }).value +\n    //     '</code></pre>';\n    //   } else {\n    //     const html = hljs.highlightAuto(str, { ignoreIllegals: true })\n    //     return '<pre class=\"hljs language-'+html.language+'\"><code>' +\n    //       html.value +\n    //     '</code></pre>';\n    //   }\n\n    //   return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n    // }\n    ...options,\n  })\n\n  // md.disable([ 'heading', 'heading', 'lheading', 'paragraph', 'image' ])\n  md.use(kbd)\n  md.use(emoji)\n\n  return md\n}\n\nfunction renderInlineMarkdown(text, options = {}){\n  text = text || ''\n  // text = text.replace(/\\n/g, '<br>')\n  // text = text.replace(/\\t/g, '&emsp;')\n\n  text = text\n  .replace(/\\(TM\\)/gi, '™')\n  .replace(/\\(SM\\)/gi, '℠')\n  .replace(/\\(C\\)/gi, '©')\n  .replace(/\\(R\\)/gi, '®')\n\n  const md = getMD(options)\n  text = md.renderInline(text)\n\n  text = twemoji.parse(text, {\n    folder: 'svg',\n    ext: '.svg',\n    base: '/public/twemoji/assets/',\n    // callback: function(icon, options, variant) {\n    //   switch ( icon ) {\n    //     case 'a9':      // © copyright\n    //     case 'ae':      // ® registered trademark\n    //     case '2122':    // ™ trademark\n    //       return false\n    //     default:\n    //       return ''.concat(options.base, options.size, '/', icon, options.ext)\n    //   }\n    // }\n  })\n    \n  return text\n}\n\nexport {\n  renderInlineMarkdown,\n}\n","import { useRef, useEffect } from 'react'\n\nimport { Transmat, addListeners, TransmatObserver } from 'transmat'\n\nimport classes from './DataTransmat.module.css'\n\nfunction getTransmatOptions(transmat, mimetypes) {\n  let data = {}\n  for (const mimetype of mimetypes) {\n    if (transmat.hasType(mimetype)) {\n      if (mimetype === 'application/json') {\n        data[mimetype] = JSON.parse(transmat.getData(mimetype))\n      } else {\n        data[mimetype] = transmat.getData(mimetype)\n      }\n    }\n  }\n\n  const options = {\n    data,\n    transmat,\n  }\n\n  return options\n}\n\nexport function DataReceiver({ onReceive, style, className, children, checkEntry, mimetypes = ['application/json'] }){\n  const receiverRef = useRef(null)\n\n  useEffect(() => {\n    const unlisten = addListeners(receiverRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (isOkay && transmat.accept()) {\n        if (typeof onReceive === 'function') {\n          onReceive(options)\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n\n        const options = getTransmatOptions(transmat, mimetypes)\n      \n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(receiverRef.current)\n\n    return () => {\n      unlisten()\n      obs.disconnect()\n    }\n  }, [ onReceive, checkEntry, mimetypes ])\n\n  return <div ref={receiverRef} style={style} className={className}>\n    {children}\n  </div>\n}\n\nexport function DataTransmiter({ onTransmit, draggable, style, className, children }){\n  const transmiterRef = useRef(null)\n\n  useEffect(() => {\n    return addListeners(transmiterRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n  }, [ onTransmit ])\n\n  return <div ref={transmiterRef} style={style} className={className} draggable={draggable ? 'true' : 'false'} tabIndex=\"0\">\n    {children}\n  </div>\n}\n\nexport function DataBothWays({ onTransmit, onReceive, checkEntry, draggable, style, className, children, mimetypes = ['application/json'] }){\n  const bothwayRef = useRef(null)\n\n  useEffect(() => {\n    const unlistenTransmit = addListeners(bothwayRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n\n    const unlistenReceive = addListeners(bothwayRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (true && transmat.accept()) { // accept everything so wrong stuff like images does not get displayed in the browser\n        if (isOkay) {\n          if (typeof onReceive === 'function') {\n            onReceive(options)\n          }\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n        const options = getTransmatOptions(transmat, mimetypes)\n\n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(bothwayRef.current)\n\n    return () => {\n      unlistenTransmit()\n      unlistenReceive()\n      obs.disconnect()\n    }\n  }, [ onTransmit, onReceive, checkEntry, mimetypes ])\n\n  return <div\n    ref={bothwayRef}\n    style={style}\n    className={className}\n    draggable={draggable ? 'true' : 'false'}\n    tabIndex=\"0\"\n  >\n    {children}\n  </div>\n}\n\n// Examples:\n//\n// <DataTransmiter\n//   draggable={true}\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'blue',\n//   }}\n//   onTransmit={() => ({\n//     'text/plain': 'Hello world!',\n//     'text/html': '<h1>Hello world!</h1>',\n//     'text/uri-list': 'http://example.com',\n//     'application/json': {foo:'bar'},\n//   })}\n// >\n//   DataTransmiter\n// </DataTransmiter>\n//\n// <DataReceiver\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'red',\n//   }}\n//   onReceive={data => console.info('received', data)}\n// >\n//   DataReceiver\n// </DataReceiver>\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerTextCard ({ block, style, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, '')\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text)\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n  \n  const defaultProps = {\n    dir: 'auto',\n    style: {\n      whiteSpace: 'pre-wrap',\n      ...style,\n    },\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n  if (color) {\n    defaultProps.style.color = color\n  }\n\n  let text_style = 'body'\n  if (block.properties.hasOwnProperty('text_style')) {\n    text_style = block.properties.text_style\n  }\n\n  let component = null\n  switch (text_style) {\n    case 'h1':\n      component = <h1\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h2':\n      component = <h2\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h3':\n      component = <h3\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'caption':\n      component = <caption\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    default: // body\n      component = <p\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n  }\n\n  return component\n}\n\nexport default ViewerTextCard\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerButtonCard ({ block, actions = {}, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { getString, translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, getString('placeholder_main_headline'))\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text, { linkify: false })\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n\n  let url = ''\n  if (\n    block\n    && block.properties\n    && block.properties.trigger\n    && block.properties.action\n    && block.properties.action.url\n    && block.properties.trigger.type === 'click'\n    && block.properties.action.type === 'open_url'\n  ) {\n    url = block.properties.action.url\n  }\n\n  const {\n    color,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  const hasClickAction = actions.hasOwnProperty('click')\n\n  if (hasClickAction === false && url !== '') {\n    return <a\n        href={url}\n        target=\"_blank\" rel=\"noreferrer\"\n      >\n      <button\n        dir=\"auto\"\n        dangerouslySetInnerHTML={html}\n        className=\"default square\"\n        style={{\n          margin: '0',\n          whiteSpace: 'pre-wrap',\n          ...colorStyles,\n        }}\n      ></button>\n    </a>\n  }\n\n  if (hasClickAction === true && typeof actions.click === 'function') {\n    return <button\n      dir=\"auto\"\n      dangerouslySetInnerHTML={html}\n      className=\"default square\"\n      style={{\n        margin: '0',\n        whiteSpace: 'pre-wrap',\n        ...colorStyles,\n      }}\n      onClick={actions.click}\n    ></button>\n  }\n\n  return <button\n    dir=\"auto\"\n    dangerouslySetInnerHTML={html}\n    disabled=\"disabled\"\n    className=\"default square\"\n    style={{\n      margin: '0',\n      whiteSpace: 'pre-wrap',\n      ...colorStyles,\n    }}\n  ></button>\n}\n\nexport default ViewerButtonCard\n","import { getBlockColor } from '../../functions.js'\n\nexport default function ViewerDividerLine ({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction ViewerCheckboxCard ({ block }) {\n  const text = block.properties.text || ''\n\n  const checked = Boolean(block.properties.checked)\n\n  const checkboxStyle = {\n    verticalAlign: 'middle',\n    paddingInlineEnd: 'var(--basis)',\n    height: 'calc(var(--font-add) + var(--basis))',\n    width: 'auto',\n  }\n\n  return <p dir=\"auto\">\n    {\n      checked\n      ? <CheckBoxIcon style={checkboxStyle} />\n      : <CheckBoxOutlineBlankIcon style={checkboxStyle} />\n    }\n    {text}\n  </p>\n}\n\nexport default ViewerCheckboxCard\n","import { useLocalization } from '../../fluent/Localized.js'\n\nimport { getImageUrl, getBlockColor } from '../../functions.js'\nimport useBlockTrigger from '../../hooks/useBlockTrigger.js'\n\nimport {\n  InsertDriveFile as PageIcon,\n  Face as PersonIcon,\n  LinkSharp as RedirectIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport classes from './ViewerLine.module.css'\n\nfunction ViewerLine ({ block, actions = {}, locales }) {\n  const { getString, translateBlock, userLocales } = useLocalization()\n\n  const { link, path } = useBlockTrigger({ block })\n\n  let title = translateBlock(block, locales || userLocales, '')\n  if (title === '') {\n    const triggerProperties = ((block.properties || {}).trigger || {})\n    const triggerType = triggerProperties.type\n\n    if (triggerType === 'path') {\n      title = '/'+triggerProperties.path\n    } else if (block.type === 'redirect') {\n      if (triggerType === 'click') {\n        title = triggerProperties.blockId\n      } else if (triggerType === 'cron') {\n        title = triggerProperties.cron\n      } else if (triggerType === 'block_change') {\n        title = triggerProperties.blockId\n      } else if (Object.keys(triggerProperties).length > 0) {\n        title = JSON.stringify(triggerProperties)\n      } else {\n        title = getString('placeholder_main_headline')\n      }\n    } else {\n      title = getString('placeholder_main_headline')\n    }\n  }\n  \n  let isSquareIcon = false\n  let icon_url = getImageUrl(block.properties.icon)\n  if (!icon_url) {\n    isSquareIcon = true\n    icon_url = getImageUrl(block.properties.coverphoto)\n  }\n\n  let iconComponent = null\n  if (icon_url === '') {\n    switch (block.type) {\n      case 'person':\n        iconComponent = <PersonIcon className={classes.icon} />\n        break\n      case 'redirect':\n        iconComponent = <RedirectIcon className={classes.icon} />\n        break\n      default:\n      iconComponent = <PageIcon className={classes.icon} />\n    }\n  } else {\n    iconComponent = <div className={`${classes.icon} ${isSquareIcon ? classes.square : classes.round}`} style={{ backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=40&h=40&url=${encodeURIComponent(icon_url)})` }} alt={title}></div>\n  }\n\n\n\n  let cardOnClick = null\n  let cardLink = path || link\n\n  if (actions.hasOwnProperty('link')) {\n    if (typeof actions.link === 'string') {\n      cardLink = actions.link\n    }\n  } else if (actions.hasOwnProperty('click')) {\n    if (typeof actions.click === 'function') {\n      cardOnClick = actions.click\n    }\n  }\n\n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  if (typeof cardLink === 'string' && cardLink.length > 0) {\n    if (cardLink.includes(':')) {\n      return <a\n        href={cardLink}\n        target=\"_blank\" rel=\"noreferrer\"\n        title={title}\n        className={`clickable_card ${classes.root}`}\n        style={{\n          display: 'block',\n          cursor: 'pointer',\n          color,\n          '--on-background-rgb': colorRGB,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          {iconComponent}\n          <span dir=\"auto\" className={classes.title}>{title}</span>\n        </div>\n      </a>\n    } else {\n      return <Link\n      to={cardLink}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        display: 'block',\n        cursor: 'pointer',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </Link>\n    }\n  } else {\n    const onClickProps = {}\n    if (typeof cardOnClick === 'function') {\n      onClickProps.onClick = cardOnClick\n    }\n\n    return <div\n      {...onClickProps}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        cursor: typeof cardOnClick === 'function' ? 'pointer' : 'auto',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </div>\n  }\n}\n\nexport default ViewerLine\n","import { useState, useEffect } from 'react' // useCallback\n// import { useNavigate } from 'react-router-dom'\n\nexport default function useBlockTrigger({ block = null }) {\n  const [link, setLink] = useState(null)\n  const [path, setPath] = useState(null)\n  // const [onClick, setOnClick] = useState(null)\n\n  // let navigate = useNavigate()\n\n  useEffect(() => {\n    let newLink = null\n    let newPath = null\n    // let newOnClick = null\n\n    if (block !== null) {\n      const blockId = block._id\n\n      const triggerProperties = ((block.properties || {}).trigger || {})\n      const triggerType = triggerProperties.type\n\n      const actionProperties = ((block.properties || {}).action || {})\n      const actionType = actionProperties.type\n\n      if (\n        triggerType === 'path'\n        || triggerType === 'click'\n      ) {\n        if (\n          actionType === 'open_url'\n          && typeof actionProperties.url === 'string'\n          && actionProperties.url.length > 0\n        ) {\n          const url = actionProperties.url || ''\n          newLink = url\n          newPath = null // `/${triggerProperties.path}`\n          // newOnClick = () => window.open(newLink, '_blank')\n        } else if (\n          actionType === 'render_block'\n          && typeof triggerProperties.path === 'string'\n          && triggerProperties.path.length > 0\n        ) {\n          if (\n            typeof actionProperties.blockId === 'string'\n            && actionProperties.blockId.length > 0\n          ) {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${actionProperties.blockId}`\n            newPath = `/${triggerProperties.path}=${actionProperties.blockId}`\n            // newOnClick = () => navigate(newLink)\n          } else {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${blockId}`\n            newPath = `/${triggerProperties.path}=${blockId}`\n            // newOnClick = () => navigate(newLink)\n          }\n        } else {\n          newLink = `/${blockId}/view`\n          newPath = `/${blockId}`\n          // newOnClick = () => navigate(newLink)\n        }\n        // TODO: add support for other trigger types (run_script, ...)\n      } else {\n        newLink = `${window.domains.frontend}${blockId}/view`\n        newPath = `/${blockId}`\n        // newOnClick = () => navigate(newLink)\n      }\n    }\n\n    setLink(newLink)\n    setPath(newPath)\n    // setOnClick(newOnClick)\n  }, [block, setLink, setPath]) // setOnClick, navigate\n\n  return { link, path } // onClick\n}\n","import React, { useEffect, useRef, useCallback } from 'react'\n\nimport { DataBothWays } from '../DataTransmat.js'\n\nimport ViewerTextCard from './ViewerTextCard.js'\nimport ViewerButtonCard from './ViewerButtonCard.js'\nimport ViewerDividerLine from './ViewerDividerLine.js'\nimport ViewerCheckboxCard from './ViewerCheckboxCard.js'\nimport ViewerLine from './ViewerLine.js'\n\nimport classes from './ViewerAuto.module.css'\n\n// saveBlock_Mutation\nimport { moveBlock_Mutation, saveProperty_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\nimport useUser from '../../hooks/useUser.js'\n\nfunction usePressedKeys({ keys = [] }) { // keys needs to lowercase\n  const pressedKeysRef = useRef(new Set())\n\n  useEffect(() => {\n    function onKeyDown(event) {\n      const key = event.key.toLowerCase()\n      if (keys.includes(key)) {\n        pressedKeysRef.current.add(key)\n      }\n    }\n    function onKeyUp(event) {\n      const key = event.key.toLowerCase()\n      pressedKeysRef.current.delete(key)\n    }\n\n    window.addEventListener('keydown', onKeyDown)\n    window.addEventListener('keyup', onKeyUp)\n\n    return () => {\n      window.removeEventListener('keydown', onKeyDown)\n      window.removeEventListener('keyup', onKeyUp)\n    }\n  }, [keys])\n\n  const getPressedKeys = () => pressedKeysRef.current // returns a Set !!!\n\n  return { getPressedKeys }\n}\n\nfunction removeProperty(obj, prop) {\n  // remove property from objects, arrays and sub-objects\n\n  obj = JSON.parse(JSON.stringify(obj)) // clone object to make everything mutable\n\n  if (obj.hasOwnProperty(prop)) {\n    delete obj[prop]\n  }\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (typeof obj[i] == 'object' && obj[i] !== null) {\n        removeProperty(obj[i], prop)\n      }\n    }\n  }\n\n  return obj\n}\n\nfunction ViewerAuto ({ block = {}, actions = {}, size = 'card', dragable = false, ...props }) {\n  let component = null\n\n  const { userroles } = useUser()\n  const { getPressedKeys } = usePressedKeys({ keys: ['shift'] }) // returns a Set !!!\n\n  const type = block.type || null\n\n  switch (type) {\n    case 'text':\n      component = <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'button':\n      component = <ViewerButtonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'divider':\n      component = <ViewerDividerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'checkbox':\n      component = <ViewerCheckboxCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'page':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'person':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'redirect':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    default:\n      component = JSON.stringify(block) // <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n  }\n\n  const mutationFunction = useMutation()\n\n  const onReceive = useCallback(async ({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    if (typeof json === 'object' && json !== null) {\n      let movingBlock = json\n\n      movingBlock = removeProperty(movingBlock, '__typename')\n\n      const block_roles = block.computed.roles || []\n      const movingBlock_roles = movingBlock.computed.roles || []\n\n      if (\n        movingBlock._id !== block._id\n        && (\n          userroles.includes('admin')\n          || (\n            ( block_roles.includes('editor') || block_roles.includes('owner') )\n            && ( movingBlock_roles.includes('editor') || movingBlock_roles.includes('owner') )\n          )\n        )\n      ) {\n        const pressedKeys = getPressedKeys()\n        // TODO: handle alt-key to duplicate block (child-blocks also need to be duplicated)\n        // if (pressedKeys.has('alt')) {\n        //   // duplicate block\n        //   delete movingBlock._id\n        //   const save_result = await mutationFunction({\n        //     mutation: saveBlock_Mutation,\n        //     variables: {\n        //       block: movingBlock,\n        //     },\n        //   })\n        //\n        //   movingBlock._id = save_result.saveBlock\n        // }\n\n        let everything_updated = false\n\n        try {\n          await mutationFunction({\n            mutation: moveBlock_Mutation,\n            variables: {\n              movingBlockId: movingBlock._id,\n              newParentId: block._id,\n              newIndex: 0,\n            },\n          })\n        \n          if (pressedKeys.has('shift')) {\n            // auto hide the block        \n            await mutationFunction({\n              mutation: saveProperty_Mutation,\n              variables: {\n                _id: movingBlock._id,\n                key: 'active',\n                value: false,\n              },\n            })\n          }\n        \n          everything_updated = true\n        } catch (error) {\n          console.error(error)\n        }\n      \n        if (everything_updated) {\n          console.log('TODO reload sidebar')\n          // TODO: reload sidebar\n        }\n      }\n    } \n  }, [mutationFunction, block, getPressedKeys, userroles])\n\n  const handleCheckEntry = useCallback(({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    let isOkay = false\n\n    if (\n      typeof json === 'object'\n      && json !== null\n      && json.hasOwnProperty('computed')\n      && json.computed.hasOwnProperty('roles')\n    ) {\n      const this_roles = json.computed.roles || []\n      if (userroles.includes('admin') || this_roles.includes('editor') || this_roles.includes('owner')) {\n        isOkay = true\n      }\n    }\n\n    return isOkay\n  }, [userroles])\n\n  return <DataBothWays\n    key={block._id}\n    draggable={dragable}\n    className={classes.root}\n    onTransmit={() => ({\n      data: {\n        'text/plain': block.properties.text || '',\n        // 'text/html': '<h1>Hello world!</h1>',\n        // 'text/uri-list': 'http://example.com',\n        'application/json': block,\n      }\n    })}\n    onReceive={onReceive}\n    checkEntry={handleCheckEntry}\n  >\n    {component}\n  </DataBothWays>\n}\n\nexport default ViewerAuto\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\n\nfunction useLoadBlocks() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadBlocks = useCallback(variables => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: getBlocks_Query,\n        variables,\n      })\n        .then(async ({ errors, data }) => {\n          if (Array.isArray(errors) && errors.length > 0) {\n            throw errors\n          } else if (Array.isArray(data.blocks)) {\n            resolve(data.blocks)\n          }else{\n            throw new Error('Unknown error while loading blocks.')\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve([])\n        })\n    })\n  }, [apollo_client])\n\n  return handleLoadBlocks\n}\n\nexport default useLoadBlocks\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\n\nfunction useMutation() {\n  const apollo_client = useApolloClient()\n\n  const handleMutation = useCallback(option => {\n    return new Promise((resolve,reject) => {\n      apollo_client.mutate(option)\n        .then(({ data }) => {\n          if (typeof data.error === 'string') {\n            reject(data.error)\n          } else {\n            resolve(data)\n          }\n        })\n        .catch(reject)\n    })\n  }, [ apollo_client ])\n\n  return handleMutation\n}\n\nexport default useMutation\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport {\n  Portal,\n  Fade,\n  Popper,\n} from '@mui/material'\n\nconst randomString = () => (Math.random() + 1).toString(36).substring(7)\n\nfunction Popover ({\n  trigger,\n  children = () => {},\n  onToogle = () => {},\n  setOpenBlockMenuRef,\n}) {\n  const anchorRef = useRef(null)\n  const [open, setOpen] = useState(false)\n\n  const setOpenExternal = useCallback((newOpen) => {\n    setOpen(newOpen)\n  }, [ setOpen ])\n\n  useEffect(() => {\n    if (!!setOpenBlockMenuRef) {\n      setOpenBlockMenuRef.current = setOpenExternal\n    }\n  }, [ setOpenExternal, setOpenBlockMenuRef ])\n\n  const handlePopoverToggleClick = () => {\n    setOpen((prevOpen) => {\n      onToogle(!prevOpen)\n      return !prevOpen\n    })\n  }\n\n  const closePopover = () => {\n    onToogle(false)\n    setOpen(false)\n  }\n\n  const id = open ? 'popover-'+randomString() : undefined\n\n  return <>\n\n    {trigger(\n      {\n        ref: anchorRef,\n        'aria-describedby': id,\n        onClick: handlePopoverToggleClick,\n        style: {\n          pointerEvents: open ? 'none' : 'all',\n        },\n      }, {\n        isOpen: open,\n      }\n    )}\n\n  <Portal>\n    <div\n      onClick={closePopover}\n      style={{\n        display: (open ? 'block' : 'none'),\n        position: 'fixed',\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n        zIndex: 1299,\n        cursor: 'pointer',\n      }}\n    />\n\n    <Popper\n      id={id}\n      open={open}\n      anchorEl={anchorRef.current}\n      transition\n      placement=\"bottom-start\"\n      disablePortal={true}\n      modifiers={[\n        {\n          name: 'flip',\n          enabled: true,\n          options: {\n            altBoundary: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n      ]}\n      style={{\n        zIndex: 1300,\n      }}\n    >\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps}>\n          <div>\n          {\n            !!children && typeof children === 'function'\n            ? children({\n              open,\n              style: {\n                transformOrigin: 'top left',\n              },\n              closePopover,\n            })\n            : null\n          }\n          </div>\n        </Fade>\n      )}\n    </Popper>\n\n    </Portal>\n  </>\n}\n\nexport default Popover\n","const { negotiateLanguages } = require('@fluent/langneg')\n\nfunction fluentByObject(object = {}, userLocales = ['en']){\n  const supportedLocales = Object.keys(object)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return object[lookupedLocale[0]]\n}\n\nfunction fluentByArray(array = [], userLocales = ['en'], key = 'locale') {\n  const supportedLocales = array.map(item => item[key]).filter(Boolean)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return array.filter(item => item[key] === lookupedLocale[0])\n}\n\nfunction fluentByAny(any = '', userLocales = ['en'], fallback = '') {\n  if (Array.isArray(any)) {\n    const result = fluentByArray(any, userLocales)\n    if (Array.isArray(result) && result.length > 0) {\n      any = result[0].value\n    }\n  } else if (typeof any === 'object') {\n    any = fluentByObject(any, userLocales)\n  }\n  if (typeof any !== 'string') {\n    any = fallback\n  }\n  return any\n}\n\nmodule.exports = {\n  fluentByObject,\n  fluentByArray,\n  fluentByAny,\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"drag_over\":\"DataTransmat_drag_over__3XVzh\",\"drag_active\":\"DataTransmat_drag_active__2nwCM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerLine_icon__DvsyX\",\"square\":\"ViewerLine_square__3knjg\",\"round\":\"ViewerLine_round__1pnCx\",\"title\":\"ViewerLine_title__35XNW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ViewerAuto_root__1p6KG\"};"],"sourceRoot":""}