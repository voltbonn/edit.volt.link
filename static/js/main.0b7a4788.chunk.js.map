{"version":3,"sources":["components/DataTransmat.module.css","hooks/useUser.js","components/Header.module.css","graphql/mutations.js","components/Header.js","pages/App.module.css","components/Sidebar.module.css","fluent/fluentBy.js","hooks/useLoadBlocks.js","hooks/useMutation.js","components/Popover.js","components/edit/LocaleSelect.js","hooks/useLoadBlock.js","hooks/useBlockMatchesRoles.js","components/ErrorPages.js","components/view/ViewerAuto.module.css","locales lazy /^/.//.*/.ftl$/ groupOptions: {} namespace object","pages/Viewer.js","pages/App.js","fluent/l10n.js","index.js","fluent/Localized.js","pages/Viewer.module.css","functions.js","components/view/ViewerLine.module.css","graphql/queries.js","Snackbar.module.css","hooks/useMediaQuery.js","components/Sidebar.js","markdown.js","components/PopoverMenu.js","components/DataTransmat.js","components/view/ViewerTextCard.js","components/view/ViewerButtonCard.js","components/view/ViewerDividerLine.js","components/view/ViewerCheckboxCard.js","components/view/ViewerLine.js","hooks/useBlockTrigger.js","components/view/ViewerAuto.js"],"names":["module","exports","defaultUser","userroles","useUser","forceRefetch","mountedRef","useRef","useEffect","current","useState","user","setUser","loggedIn","setLoggedIn","apollo_client","useApolloClient","window","hasOwnProperty","logged_in","query","getSelf_Query","then","a","data","self","catch","error","console","saveBlock_Mutation","gql","saveProperty_Mutation","archiveBlock_Mutation","unarchiveBlock_Mutation","moveBlock_Mutation","Header","title","block","rightActions","notificationBanner","useSidebarContext","open","toggleSidebar","blockId","_id","parentId","parent","parentBlocks","setParentBlocks","siblingBlocks","setSiblingBlocks","loadParentBlocks","useCallback","getParentBlocks_Query","variables","blocks","parentBlocksSorted","sort","b","computed","loadSiblingBlocks","getBlocks_Query","roots","types","archived","filter","leftActions","onClick","className","style","margin","flexGrow","to","verticalAlign","opacity","length","trigger","triggerProps","padding","map","size","fontWeight","classes","header","headerBar","negotiateLanguages","require","fluentByObject","object","userLocales","supportedLocales","Object","keys","lookupedLocale","defaultLocale","strategy","fluentByArray","array","key","item","Boolean","fluentByAny","any","fallback","Array","isArray","result","value","useLoadBlocks","handleLoadBlocks","Promise","resolve","errors","Error","useMutation","option","reject","mutate","Popover","children","onToogle","setOpenBlockMenuRef","anchorRef","setOpen","setOpenExternal","newOpen","closePopover","id","Math","random","toString","substring","undefined","ref","prevOpen","pointerEvents","isOpen","display","position","top","right","bottom","left","zIndex","cursor","anchorEl","transition","placement","disablePortal","modifiers","name","enabled","options","altBoundary","rootBoundary","TransitionProps","transformOrigin","locales","_","en","de","es","pt","fr","it","nl","da","sv","nb","fi","mt","pl","ru","bg","tr","ar","el","ro","sl","localesArray","entries","code","nativeName","defaultOptions","LocaleSelect","defaultValue","onChange","changedLocale","setChangedLocale","handleLocaleChange","newLocale","flexShrink","width","textAlign","path","mdiTranslate","toUpperCase","marginLeft","lineHeight","paperProps","sx","maxHeight","close","includes","selected","useLoadBlock","getString","useLocalization","useSnackbar","enqueueSnackbar","closeSnackbar","handleLoadBlock","final_resolve","snackbarKey","loadingDataPromise","getBlock_Query","loadedBlock","variant","preventDuplicate","autoHideDuration","message","race","setTimeout","response","persist","type","useBlockMatchesRoles","handleLoadRoles","roles","blockMatchesRoles_Query","blockMatchesRoles","ErrorPage","errorName","description","buttons","href","domains","backend","encodeURIComponent","location","webpackAsyncContext","req","__webpack_require__","o","e","ids","Viewer","loadingTheBlock","translateBlock","loadBlock","loadBlocks","useParams","properties","content","setBlock","contentBlocks","setContentBlocks","possibleLocales","setPossibleLocales","locale","setLocales","canView","setCanView","matchesRoles","newLoadedBlock","newContentConfigs","ids2load","contentConfig","loadedContentBlocks","find","newPossibleLocales","Set","flatMap","thisBlock","translations","t","text","viewer","app","spine_aligned","dir","contentWrapper","coverphoto_url","getImageUrl","coverphoto","icon_url","icon","rightHeaderActions","whiteSpace","marginRight","Localized","titleWithRenderedMarkdown","__html","renderInlineMarkdown","metadata_image_url","Helmet","property","dangerouslySetInnerHTML","backgroundImage","imageFormat","coverphotoIsNotSet","coverphotoIsSet","items","active","contentBlock","ViewerAuto","Editor","lazy","App","matchesStartpage","useMatch","useLocation","customLocation","setCustomLocation","slugAndIdMatch","pathname","match","slugOrId","suffix","newPathname","fallback_title","fallback_description","isStartpage","Sidebar","element","_supportedLocales_","_defaultLocale_","fetchMessages","fetch","default","messages","FluentResource","createMessagesGenerator","currentLocales","all","fetched","reduce","obj","cur","assign","generateBundles","bundle","FluentBundle","addResource","f","AppLocalizationProvider","onLocaleChange","ReactLocalization","getDefaultBundles","bundles","setBundles","new_bundles","loadBundles","l10n","process","env","frontend","client","ApolloClient","uri","cache","InMemoryCache","credentials","watchQuery","fetchPolicy","errorPolicy","Start","navigator","languages","setUserLocales","currentLocale","setCurrentLocale","umami","systemLocales","language","toLowerCase","split","trackEvent","handleLanguageChange","event","target","dataset","handleCurrentLocalesChange","prefersDarkMode","useMediaQuery","theme","React","useMemo","createTheme","palette","mode","ApolloProvider","ThemeProvider","anchorOrigin","vertical","horizontal","minWidth","variantSuccess","snackbarClasses","snackbar","success","variantError","variantWarning","warning","variantInfo","info","domRoot","document","getElementById","onLanguageChange","container","createRoot","render","props","elems","br","Fragment","withLocalization","Inner","useContext","FluentContext","createElement","globalSupportedLocales","thisSupportedLocales","args","correct_translations","fluentBy","hexToRGBArray","color","startsWith","charAt","rgb","i","parseInt","substr","getContrastingColor","luma","colorToHex","rgba","cvs","ctx","height","getContext","fillStyle","fillRect","getImageData","colorToRGBA","idx","slice","join","imageObj","url","getBlockColor","colors","colorRGB","contrastingColor","contrastingColorRGB","newColor","parsedColor","checkPath_Query","matches","setMatches","media","matchMedia","listener","addEventListener","removeEventListener","LazySidebarContent","SidebarContext","createContext","SidebarProvider","realOpen","oldOpen","Provider","iOS","test","userAgent","isDesktop","SwipeableDrawer","anchor","onOpen","onClose","disableBackdropTransition","disableDiscovery","boxSizing","backgroundColor","border","PaperProps","background","SidebarContent","Main","main","sidebarWidth","getMD","md","mdit","html","xhtmlOut","linkify","typographer","breaks","use","kbd","emoji","replace","renderInline","twemoji","parse","folder","ext","base","PopoverMenu","popoverProps","paperPropsRest","maxWidth","overflow","elevation","autoFocus","marginTop","marginBottom","getTransmatOptions","transmat","mimetypes","mimetype","hasType","JSON","getData","DataBothWays","onTransmit","onReceive","checkEntry","draggable","bothwayRef","unlistenTransmit","addListeners","Transmat","setData","unlistenReceive","isOkay","accept","preventDefault","obs","TransmatObserver","entry","classList","toggle","drag_over","isTarget","drag_active","isActive","observe","disconnect","tabIndex","ViewerTextCard","setHtml","textWithHtml","defaultProps","text_style","component","ViewerButtonCard","actions","action","colorStyles","hasClickAction","rel","click","disabled","ViewerDividerLine","styles","ViewerCheckboxCard","checked","checkboxStyle","paddingInlineEnd","CheckBox","CheckBoxOutlineBlank","ViewerLine","link","setLink","setPath","newLink","newPath","triggerProperties","triggerType","actionProperties","actionType","useBlockTrigger","cron","stringify","isSquareIcon","iconComponent","square","round","alt","cardOnClick","cardLink","root","alignItems","onClickProps","removeProperty","prop","dragable","getPressedKeys","pressedKeysRef","onKeyDown","add","onKeyUp","delete","usePressedKeys","mutationFunction","json","movingBlock","block_roles","movingBlock_roles","pressedKeys","everything_updated","mutation","movingBlockId","newParentId","newIndex","has","log","handleCheckEntry","this_roles"],"mappings":"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","file":"static/js/main.0b7a4788.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"drag_over\":\"DataTransmat_drag_over__3XVzh\",\"drag_active\":\"DataTransmat_drag_active__2nwCM\"};","import { useState, useEffect, useRef } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSelf_Query } from '../graphql/queries'\n\nconst defaultUser = {\n  userroles: [],\n}\n\nexport default function useUser(forceRefetch = false) {\n  const mountedRef = useRef(false)\n  useEffect(() => {\n    mountedRef.current = true\n    return () => {\n      mountedRef.current = false\n    }\n  }, [])\n\n  const [user, setUser] = useState(defaultUser)\n  const [loggedIn, setLoggedIn] = useState(false)\n\n  const apollo_client = useApolloClient()\n\n  useEffect(() => {\n    if (forceRefetch !== true && window.hasOwnProperty('user')) {\n      setUser({\n        ...window.user,\n        userroles: window.user.userroles || [],\n      })\n      setLoggedIn(window.user.logged_in)\n    } else {\n      apollo_client.query({\n        query: getSelf_Query,\n      })\n        .then(async ({ data }) => {\n          if (mountedRef.current === true) {\n            if (data.hasOwnProperty('self') && data.self !== null) {\n              window.user = data.self\n              setUser({\n                ...data.self,\n                userroles: data.self.userroles || [],\n              })\n              setLoggedIn(data.self.logged_in)\n            } else {\n              setUser(defaultUser)\n              setLoggedIn(false)\n            }\n          }\n        })\n        .catch(error => {\n          console.error(error)\n          if (mountedRef.current === true) {\n            setUser(defaultUser)\n            setLoggedIn(false)\n          }\n        })\n    }\n  }, [forceRefetch, setUser, setLoggedIn, apollo_client])\n\n  return {\n    ...user,\n    loggedIn,\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__3mObx\",\"headerBar\":\"Header_headerBar__2YU41\",\"notificationBanner\":\"Header_notificationBanner__104SP\"};","import { gql } from '@apollo/client'\n\nexport const saveBlock_Mutation = gql`\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n`\n\nexport const saveProperty_Mutation = gql`\n  mutation saveProperty ($_id: ObjectID!, $key: String!, $value: JSON) {\n    saveProperty (_id: $_id, key: $key, value: $value)\n  }\n`\n\nexport const archiveBlock_Mutation = gql`\n  mutation archiveBlock ($_id: ObjectID!) {\n    archiveBlock (_id: $_id)\n  }\n`\n\nexport const unarchiveBlock_Mutation = gql`\n  mutation unarchiveBlock ($_id: ObjectID!) {\n    unarchiveBlock (_id: $_id)\n  }\n`\n\nexport const moveBlock_Mutation = gql`\n  mutation moveBlock ($movingBlockId: ObjectID!, $newParentId: ObjectID!, $newIndex: Int!) {\n    moveBlock(movingBlockId: $movingBlockId, newParentId: $newParentId, newIndex: $newIndex)\n  }\n`\n","import { useState, useCallback, useEffect } from 'react'\n\nimport classes from './Header.module.css'\n\nimport {\n  Menu as MenuIcon,\n  MoreHoriz as MoreHorizIcon,\n  Home as HomeIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport { useSidebarContext } from './Sidebar.js'\nimport ViewerAuto from './view/ViewerAuto.js'\nimport PopoverMenu from './PopoverMenu.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query, getParentBlocks_Query } from '../graphql/queries'\n\nexport default function Header({ title, block = {}, rightActions, notificationBanner }) {\n  const { open, toggleSidebar } = useSidebarContext()\n  const apollo_client = useApolloClient()\n\n  const blockId = block ? block._id : null\n  const parentId = block ? block.parent : null\n\n  const [parentBlocks, setParentBlocks] = useState([])\n  const [siblingBlocks, setSiblingBlocks] = useState([])\n\n  const loadParentBlocks = useCallback(blockId => {\n    apollo_client.query({\n      query: getParentBlocks_Query,\n      variables: {\n        _id: blockId,\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.blocks) {\n          console.error(data.error)\n          setParentBlocks([])\n        }else{\n          const parentBlocksSorted = (data.blocks || [])\n            .sort((a, b) => b.computed.sort - a.computed.sort)\n\n          setParentBlocks(parentBlocksSorted)\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setParentBlocks([])\n      })\n  }, [apollo_client, setParentBlocks])\n\n  const loadSiblingBlocks = useCallback((parentId, blockId) => {\n    apollo_client.query({\n      query: getBlocks_Query,\n      variables: {\n        roots: [parentId || blockId],\n        types: ['page', 'person', 'redirect'],\n        archived: false,\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.blocks) {\n          console.error(data.error)\n          setSiblingBlocks([])\n        }else{\n          setSiblingBlocks(\n            (data.blocks || [])\n              .filter(block => block._id !== blockId)\n          )\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setSiblingBlocks([])\n      })\n  }, [apollo_client, setSiblingBlocks])\n\n  useEffect(() => {\n    if (blockId) {\n      loadParentBlocks(blockId)\n      loadSiblingBlocks(parentId, blockId)\n    }\n  }, [blockId, parentId, loadParentBlocks, loadSiblingBlocks])\n\n  const leftActions = <>\n    {\n      !open\n      ? <button onClick={toggleSidebar} className=\"text hasIcon\" style={{ margin: '0' }}>\n          <MenuIcon className=\"icon\" />\n        </button>\n      : null\n    }\n\n    <div style={{ flexGrow: '1' }}>\n      <Link to=\"/\">\n        <button className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n          <HomeIcon style={{ verticalAlign: 'middle' }} />\n        </button>\n      </Link>\n      <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n\n    {\n      blockId\n      && parentBlocks.length > 0\n        ? <>\n          <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <MoreHorizIcon style={{ verticalAlign: 'middle' }} />\n              </button>\n            )}\n          >\n            <div style={{\n              padding: 'var(--basis_x2)',\n            }}>\n              {\n                parentBlocks\n                .map((block) => {\n                  return <ViewerAuto\n                    key={block._id}\n                    block={block}\n                    size=\"line\"\n                  />\n                })\n              }\n            </div>\n          </PopoverMenu>\n          <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n        </>\n        : null\n    }\n\n    {\n      siblingBlocks.length > 0\n        ? <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <span style={{ fontWeight: 'bold' }}>\n                  {title}\n                </span>\n              </button>\n            )}\n          >\n            <div style={{\n              padding: 'var(--basis_x2)',\n            }}>\n              {\n                siblingBlocks\n                .map((block) => {\n                  return <ViewerAuto\n                    key={block._id}\n                    block={block}\n                    size=\"line\"\n                  />\n                })\n              }\n            </div>\n          </PopoverMenu>\n        : <span style={{ fontWeight: 'bold' }}>\n            {title}\n          </span>\n    }\n    </div>\n  </>\n\n  return <header className={classes.header}>\n    <div className={classes.headerBar}>\n      {leftActions}\n      {rightActions}\n    </div>\n    {\n      !!notificationBanner\n        ? <div className={classes.notificationBanner}>{notificationBanner}</div>\n        : null\n    }\n  </header>\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3hbGO\",\"isStartpage\":\"App_isStartpage__1Q6rs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"Sidebar_main__1MCX5\",\"open\":\"Sidebar_open__gnBQb\"};","const { negotiateLanguages } = require('@fluent/langneg')\n\nfunction fluentByObject(object = {}, userLocales = ['en']){\n  const supportedLocales = Object.keys(object)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return object[lookupedLocale[0]]\n}\n\nfunction fluentByArray(array = [], userLocales = ['en'], key = 'locale') {\n  const supportedLocales = array.map(item => item[key]).filter(Boolean)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return array.filter(item => item[key] === lookupedLocale[0])\n}\n\nfunction fluentByAny(any = '', userLocales = ['en'], fallback = '') {\n  if (Array.isArray(any)) {\n    const result = fluentByArray(any, userLocales)\n    if (Array.isArray(result) && result.length > 0) {\n      any = result[0].value\n    }\n  } else if (typeof any === 'object') {\n    any = fluentByObject(any, userLocales)\n  }\n  if (typeof any !== 'string') {\n    any = fallback\n  }\n  return any\n}\n\nmodule.exports = {\n  fluentByObject,\n  fluentByArray,\n  fluentByAny,\n}\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\n\nfunction useLoadBlocks() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadBlocks = useCallback(variables => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: getBlocks_Query,\n        variables,\n      })\n        .then(async ({ errors, data }) => {\n          if (Array.isArray(errors) && errors.length > 0) {\n            throw errors\n          } else if (Array.isArray(data.blocks)) {\n            resolve(data.blocks)\n          }else{\n            throw new Error('Unknown error while loading blocks.')\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve([])\n        })\n    })\n  }, [apollo_client])\n\n  return handleLoadBlocks\n}\n\nexport default useLoadBlocks\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\n\nfunction useMutation() {\n  const apollo_client = useApolloClient()\n\n  const handleMutation = useCallback(option => {\n    return new Promise((resolve,reject) => {\n      apollo_client.mutate(option)\n        .then(({ data }) => {\n          if (typeof data.error === 'string') {\n            reject(data.error)\n          } else {\n            resolve(data)\n          }\n        })\n        .catch(reject)\n    })\n  }, [ apollo_client ])\n\n  return handleMutation\n}\n\nexport default useMutation\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport {\n  Portal,\n  Fade,\n  Popper,\n} from '@mui/material'\n\nconst randomString = () => (Math.random() + 1).toString(36).substring(7)\n\nfunction Popover ({\n  trigger,\n  children = () => {},\n  onToogle = () => {},\n  setOpenBlockMenuRef,\n}) {\n  const anchorRef = useRef(null)\n  const [open, setOpen] = useState(false)\n\n  const setOpenExternal = useCallback((newOpen) => {\n    setOpen(newOpen)\n  }, [ setOpen ])\n\n  useEffect(() => {\n    if (!!setOpenBlockMenuRef) {\n      setOpenBlockMenuRef.current = setOpenExternal\n    }\n  }, [ setOpenExternal, setOpenBlockMenuRef ])\n\n  const handlePopoverToggleClick = () => {\n    setOpen((prevOpen) => {\n      onToogle(!prevOpen)\n      return !prevOpen\n    })\n  }\n\n  const closePopover = () => {\n    onToogle(false)\n    setOpen(false)\n  }\n\n  const id = open ? 'popover-'+randomString() : undefined\n\n  return <>\n\n    {trigger(\n      {\n        ref: anchorRef,\n        'aria-describedby': id,\n        onClick: handlePopoverToggleClick,\n        style: {\n          pointerEvents: open ? 'none' : 'all',\n        },\n      }, {\n        isOpen: open,\n      }\n    )}\n\n  <Portal>\n    <div\n      onClick={closePopover}\n      style={{\n        display: (open ? 'block' : 'none'),\n        position: 'fixed',\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n        zIndex: 1299,\n        cursor: 'pointer',\n      }}\n    />\n\n    <Popper\n      id={id}\n      open={open}\n      anchorEl={anchorRef.current}\n      transition\n      placement=\"bottom-start\"\n      disablePortal={true}\n      modifiers={[\n        {\n          name: 'flip',\n          enabled: true,\n          options: {\n            altBoundary: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n      ]}\n      style={{\n        zIndex: 1300,\n      }}\n    >\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps}>\n          <div>\n          {\n            !!children && typeof children === 'function'\n            ? children({\n              open,\n              style: {\n                transformOrigin: 'top left',\n              },\n              closePopover,\n            })\n            : null\n          }\n          </div>\n        </Fade>\n      )}\n    </Popper>\n\n    </Portal>\n  </>\n}\n\nexport default Popover\n","import { useState, useCallback } from 'react'\n\nimport {\n  MenuItem,\n} from '@mui/material'\n\nimport PopoverMenu from '../PopoverMenu.js'\n\nimport MdiIcon from '@mdi/react'\nimport {\n  mdiTranslate,\n} from '@mdi/js'\n\nconst locales = {\n  _: '??',\n  en: 'English',\n  de: 'Deutsch',\n  es: 'Español',\n  pt: 'Português',\n  fr: 'Français',\n  it: 'Italiano',\n  nl: 'Nederlands', // Dutch\n  da: 'Dansk', // Danish\n  sv: 'Svenska', // Swedish\n  nb: 'Norsk bokmål', // Norwegian\n  fi: 'Suomi', // Finish\n  mt: 'Malti', // Maltese\n  pl: 'Język polski', // Polish\n  ru: 'русский язык', // Russian\n  bg: 'български език', // Bulgarian\n  tr: 'Türkçe',\n  ar: 'اَلْعَرَبِيَّة', // Arabic\n  el: 'ελληνικά', // Greek\n  ro: 'limba română', // Romanian\n  sl: 'slovenščina', // Slovenian\n  // uk: 'украї́нська мо́ва', // Ukrainian\n  // cy: 'Cymraeg', // Welsh\n}\n\nconst localesArray = Object.entries(locales)\n.map(([code, nativeName]) => ({code, nativeName}))\n\nconst defaultOptions = Object.keys(locales)\n\nfunction LocaleSelect({\n  defaultValue,\n  onChange,\n  options = defaultOptions,\n}) {\n  if (\n    defaultValue === null\n    || defaultValue === undefined\n    || defaultValue === ''\n    || locales.hasOwnProperty(defaultValue) === false\n  ) {\n    defaultValue = '_'\n  }\n\n  const [changedLocale, setChangedLocale] = useState(defaultValue)\n\n  const handleLocaleChange = useCallback(newLocale => {\n    setChangedLocale(newLocale)\n    \n    if (newLocale === '_') {\n      newLocale = null\n    }\n\n    if (onChange) {\n      onChange(newLocale)\n    }\n  }, [ setChangedLocale, onChange ])\n  \n  return (\n    <PopoverMenu\n      trigger={(triggerProps, { isOpen }) => (\n        <button\n          {...triggerProps}\n          className=\"default hasIcon\"\n          style={{\n            margin: '0',\n            flexShrink: '0',\n          }}\n        >\n          <span style={{ width: '100%', textAlign: 'start' }}>\n          {\n            changedLocale === '_'\n            ? <MdiIcon\n              path={mdiTranslate}\n              className=\"icon\"\n            />\n            : changedLocale.toUpperCase()\n          }\n          </span>\n          <span style={{\n            marginLeft: 'var(--basis)',\n            lineHeight: '1',\n            verticalAlign: 'text-top',\n          }}>\n            { isOpen ? '▴' : '▾' }\n          </span>\n        </button>\n      )}\n      paperProps={{\n        sx: {\n          maxHeight: '300px',\n        }\n      }}\n    >\n      {({ close }) => (\n        <div style={{\n          padding: 'var(--basis_x2) 0',\n        }}>\n          {\n            localesArray\n            .filter(({ code }) => options.includes(code))\n            .map(({ code, nativeName }) => (\n              <MenuItem\n                key={code}\n                onClick={() => {\n                  handleLocaleChange(code)\n                  close()\n                }}\n                className=\"roundMenuItem\"\n                selected={code === changedLocale}\n              >\n                {code === '_' ? nativeName : `${code.toUpperCase()} — ${nativeName}`}\n              </MenuItem>\n            ))\n          }\n        </div>\n      )}\n    </PopoverMenu>    \n  )\n}\n\nexport default LocaleSelect\n","import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlock_Query } from '../graphql/queries'\n\nimport { useSnackbar } from 'notistack'\n\nfunction useLoadBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleLoadBlock = useCallback(_id => {\n    return new Promise(final_resolve => {\n    let snackbarKey = null\n\n    if (!_id || _id === '') {\n      final_resolve({\n        type: 'text',\n      })\n    } else {\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.query({\n          query: getBlock_Query,\n          variables: {\n            _id,\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string' || !data.block) {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              }\n            }else{\n              const loadedBlock = data.block\n              final_resolve(loadedBlock)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar('[could not load data] '+error.message, {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_loading'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n    }\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleLoadBlock\n}\n\nexport default useLoadBlock\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { blockMatchesRoles_Query } from '../graphql/queries'\n\nexport default function useBlockMatchesRoles() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadRoles = useCallback((_id, roles = []) => {\n    return new Promise(resolve => {\n      if (!_id || _id === '') {\n        resolve(false)\n      } else {\n        apollo_client.query({\n          query: blockMatchesRoles_Query,\n          variables: {\n            _id,\n            roles,\n          },\n        })\n          .then(async ({ data }) => {\n            if (data.hasOwnProperty('blockMatchesRoles')) {\n              resolve(data.blockMatchesRoles)\n            }else{\n              resolve(false)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve(false)\n          })\n      }\n    })\n  }, [ apollo_client ])\n\n  return handleLoadRoles\n}\n","\nimport {\n  Login as LoginIcon,\n} from '@mui/icons-material'\n\nimport Localized from '../fluent/Localized.js'\n\nexport default function LoginScreen () {\n  return <>\n    <h1>Login to view content</h1>\n    <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  </>\n}\n\nexport function ErrorPage ({ errorName }) {\n  let title = 'Unknown Error'\n  let description = ''\n  let buttons = ''\n\n  if (errorName === 'no_access') {\n    title = `You don't have access to this page!`\n    \n    description = <>\n      <h2>If you are not logged in:</h2>\n      You propably need to login with a Volt Europa account to view this page. Contact your local community lead if you are unsure about your Volt Europa account.<br/>\n\n      <h2>If you are logged in:</h2>\n        You propably don't have access to this page.\n    </>\n\n    buttons = <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  } else if (errorName === 'not_found') {\n    title = 'We could not find the requested URL…'\n    description = \"The URL you requested does currently not exist. Did you type the URL correctly?\"\n\n    buttons = <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"text hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  }\n\n  \n  return <>\n    <h1>{title}</h1>\n    <div className=\"type_p\">{description}</div>\n    {buttons}\n\n    <br/> {/* Spacing */}\n    <br/>\n    <br/>\n    <br/>\n\n    <p>\n      Please contact <a href=\"mailto:thomas.rosen@volteuropa.org\">thomas.rosen@volteuropa.org</a> if you think this is a bug.<br/>\n      Go to <a href=\"https://volteuropa.org\">volteuropa.org</a> for information about the Pan-European Political Movement.\n    </p>\n  </>\n\n  // <hr/>\n  // <p>\n  //   <a href=\"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_client_errors\">HTTP Error Code</a>: {errorCode}\n  // </p>\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ViewerAuto_root__1p6KG\"};","var map = {\n\t\"./de.ftl\": [\n\t\t329,\n\t\t8\n\t],\n\t\"./en.ftl\": [\n\t\t330,\n\t\t9\n\t],\n\t\"./es.ftl\": [\n\t\t331,\n\t\t10\n\t],\n\t\"./fr.ftl\": [\n\t\t332,\n\t\t11\n\t],\n\t\"./it.ftl\": [\n\t\t333,\n\t\t12\n\t],\n\t\"./nl.ftl\": [\n\t\t334,\n\t\t13\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 301;\nmodule.exports = webpackAsyncContext;","import React, { useRef, useState, useEffect, useCallback } from 'react'\n\nimport {\n  useParams,\n  Link,\n} from 'react-router-dom'\n\nimport { Helmet } from 'react-helmet'\n\nimport { getImageUrl } from '../functions.js'\n\nimport { Localized, useLocalization } from '../fluent/Localized.js'\nimport useLoadBlock from '../hooks/useLoadBlock.js'\nimport useLoadBlocks from '../hooks/useLoadBlocks.js'\nimport useUser from '../hooks/useUser.js'\nimport useBlockMatchesRoles from '../hooks/useBlockMatchesRoles.js'\n\nimport { ErrorPage } from '../components/ErrorPages.js'\nimport Header from '../components/Header.js'\nimport ViewerAuto from '../components/view/ViewerAuto.js'\n\nimport LocaleSelect from '../components/edit/LocaleSelect.js'\n\nimport classes from './Viewer.module.css'\n\nimport {\n  EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport { renderInlineMarkdown } from '../markdown.js'\n\nfunction Viewer () {\n  const loadingTheBlock = useRef(false)\n  const { getString, translateBlock, userLocales } = useLocalization()\n\n  const { loggedIn } = useUser()\n\n  const loadBlock = useLoadBlock()\n  const loadBlocks = useLoadBlocks()\n\n  let { id = '' } = useParams()\n\n  const [block, setBlock] = useState({\n    type: 'page',\n    properties: {},\n    content: [],\n  })\n  const [contentBlocks, setContentBlocks] = useState([])\n\n  const [possibleLocales, setPossibleLocales] = useState([])\n  const [locales, setLocales] = useState(block.properties.locale || userLocales || ['en'])\n  const handleLocaleChange = useCallback((newLocale) => {\n    setLocales([newLocale])\n  }, [ setLocales ])\n\n  const [canView, setCanView] = useState(null)\n  const blockMatchesRoles = useBlockMatchesRoles()\n  useEffect(() => {\n    blockMatchesRoles(id, ['viewer', 'owner'])\n      .then(matchesRoles => {\n        setCanView(matchesRoles)\n      })\n      .catch(error => {\n        console.error(error)\n        setCanView(false)\n      })\n  }, [ id, blockMatchesRoles, setCanView ])\n\n  useEffect(() => {\n    if (\n      canView\n      && loadingTheBlock.current === false\n      && typeof id === 'string'\n      && id !== ''\n      && id !== block._id\n    ) {\n      loadingTheBlock.current = true\n      loadBlock(id)\n        .then(async loadedBlock => {\n\n          let newLoadedBlock = loadedBlock\n\n          if (\n            Array.isArray(loadedBlock.content)\n            && loadedBlock.content.length > 0\n          ) {\n            let newContentConfigs = [...loadedBlock.content]\n\n            const ids2load = loadedBlock.content\n              .filter(contentConfig => !contentConfig.hasOwnProperty('block'))\n              .map(contentConfig => contentConfig.blockId)\n\n            let loadedContentBlocks = []\n            if (ids2load.length > 0) {\n              loadedContentBlocks = await loadBlocks({ ids: ids2load })\n            }\n          \n            newContentConfigs = newContentConfigs\n              .map(contentConfig => {\n                if (!contentConfig.hasOwnProperty('block')) {\n                  contentConfig.block = loadedContentBlocks.find(block => block._id === contentConfig.blockId)\n                }\n                return contentConfig\n              })\n\n            newLoadedBlock = {\n              ...newLoadedBlock,\n              content: newContentConfigs,\n            }\n          }\n\n          const blocks = (newLoadedBlock.content || [])\n          .map(contentConfig => contentConfig.block)\n\n          const newPossibleLocales = [...new Set(\n            [\n              loadedBlock,\n              ...blocks,\n            ]\n            .flatMap(thisBlock => [\n              thisBlock.properties.locale,\n              ...(thisBlock.properties.translations || [])\n                .filter(t => t.text && t.text.length > 0)\n                .map(t => t.locale),\n            ])\n            .filter(Boolean)\n          )]\n          setPossibleLocales(newPossibleLocales)\n\n          setBlock(newLoadedBlock)\n          setContentBlocks(blocks)\n          loadingTheBlock.current = false\n        })\n    }\n  }, [\n    canView,\n    id,\n    block,\n    block._id,\n    loadBlock,\n    setBlock,\n    loadBlocks,\n    setContentBlocks,\n    setPossibleLocales\n  ])\n\n  if (canView === false) {\n    return <div className={classes.viewer}>\n      <Header\n        block={null}\n        title=\"Error\"\n        rightActions={null}\n      />\n      <div className={`basis_x1 ${classes.app} ${classes.spine_aligned}`} dir=\"auto\">\n        <main className={`${classes.contentWrapper}`}>\n          <ErrorPage errorName=\"no_access\" />\n        </main>\n      </div>\n    </div>\n  } else {\n  const type = block.type || null\n\n  const title = translateBlock(block, locales, getString('placeholder_main_headline'))\n  const coverphoto_url = getImageUrl(block.properties.coverphoto)\n  const icon_url = getImageUrl(block.properties.icon)\n\n  // const pronouns = block.properties.pronouns || ''\n  \n  const rightHeaderActions = <>\n    <div className=\"buttonRow\" style={{ whiteSpace: 'nowrap' }}>\n      {\n        (loggedIn && !!block._id)\n        && <Link to={`/${block._id}/edit`} style={{ marginRight: 'var(--basis_x2)' }}>\n            <button className=\"text hasIcon\">\n              <EditIcon className=\"icon\" />\n              <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"edit_block\" /></span>\n            </button>\n          </Link>\n      }\n\n      {\n        possibleLocales.length > 1\n        && <LocaleSelect\n          onChange={handleLocaleChange}\n          defaultValue={locales[0] || userLocales[0] || 'en'}\n          options={possibleLocales}\n        />\n      }\n    </div>\n  </>\n\n  const titleWithRenderedMarkdown = {\n    __html: renderInlineMarkdown(title)\n  }\n\n  let metadata_image_url = ''\n  if (typeof coverphoto_url === 'string' && coverphoto_url.length > 0) {\n    metadata_image_url = `${window.domains.backend}download_url?f=jpg&w=1000&h=1000&url=${encodeURIComponent(coverphoto_url)}`\n  }\n\n  return <div className={classes.viewer}>\n    <Helmet>\n      <title>{title}</title>\n      <meta name=\"title\" content={title} />\n      <meta name=\"og:title\" content={title} />\n      <meta name=\"twitter:title\" content={title} />\n\n      <meta name=\"description\" content=\"\" />\n      <meta property=\"og:description\" content=\"\" />\n      <meta name=\"twitter:description\" content=\"\" />\n\n      <meta property=\"og:image\" content={metadata_image_url} />\n      <meta name=\"twitter:image\" content={metadata_image_url} />\n\n      <meta property=\"twitter:card\" content=\"summary\" />\n    </Helmet>\n\n    <Header\n      block={block}\n      title={\n        <span\n          dir=\"auto\"\n          dangerouslySetInnerHTML={titleWithRenderedMarkdown}\n        />\n      }\n      rightActions={rightHeaderActions}\n    />\n\n    <div className={`basis_x1 ${classes.app} ${classes.spine_aligned}`} dir=\"auto\">\n      {\n      (type === 'page' || type === 'person' || type === 'redirect')\n      && coverphoto_url !== ''\n          ? <div style={{ backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=1400&h=400&url=${encodeURIComponent(coverphoto_url)})` }} className={classes.coverphoto}></div>\n          : null\n      }\n      <main className={`${classes.contentWrapper}`}>\n        {\n          (type === 'page' || type === 'person' || type === 'redirect')\n          && icon_url !== ''\n            ? <div\n                style={{\n                  backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=400&h=400&url=${encodeURIComponent(icon_url)})`\n                }}\n                className={`${classes.icon} ${coverphoto_url === '' ? classes.coverphotoIsNotSet : classes.coverphotoIsSet}`}\n              ></div>\n            : null\n        }\n        {\n          title !== ''\n          ? <h1\n              dir=\"auto\"\n              dangerouslySetInnerHTML={titleWithRenderedMarkdown}\n              style={{\n                whiteSpace: 'pre-wrap',\n              }}\n            />\n          : null\n        }\n        { /* type === 'person' && pronouns !== '' ? <p dir=\"auto\"><strong style={{\n          padding: 'var(--basis)',\n          margin: 'var(--basis_x0_5) calc(-1 * var(--basis))',\n          display: 'inline-block',\n          backgroundColor: 'rgba(var(--on-background-rgb), var(--alpha-less))',\n        }}>{pronouns}</strong></p> : null */ }\n        <div className={classes.items}>\n          {\n            contentBlocks\n            .filter(block => !!block)\n            .filter(block => block.properties.active !== false)\n            .map(contentBlock => <ViewerAuto key={contentBlock._id} block={contentBlock} locales={locales} />)\n          }\n        </div>\n      </main>\n    </div>\n  </div>\n  }\n}\n\nexport default Viewer\n","import React, { Suspense, lazy, useState, useEffect } from 'react'\n\nimport classes from './App.module.css'\n\nimport {\n  Routes,\n  Route,\n  useLocation,\n  useMatch,\n  // useNavigate,\n} from 'react-router-dom'\n\nimport { SidebarProvider, Sidebar, SidebarContent, Main } from '../components/Sidebar.js'\n// import Shortcode from './Shortcode.js'\nimport { Helmet } from 'react-helmet'\n\nimport Viewer from './Viewer.js'\nconst Editor = lazy(() => import('./Editor.js'))\n\n// function useScrollMemory() {\n//   // const navigate = useNavigate()\n//   const location = useLocation()\n//\n//   const pathRef = useRef(null)\n//\n//   useEffect(() => {\n//     console.log('location', location)\n//     pathRef.current = location.pathname\n//   }, [location])\n//\n//   useEffect(() => {\n//     // Listen for location changes and set the scroll position accordingly.\n//     const setFromHistoryState = state => {\n//       console.log('popstate-state', state)\n//       let scrollY = 0\n//       if (state && state.scrollY) {\n//         scrollY = state.scrollY\n//       }\n//       console.log('A-popstate-scrollY', scrollY)\n//       if (scrollY < 100) {\n//         scrollY = 0\n//       }\n//\n//       console.log('B-popstate-scrollY', scrollY)\n//       window.scrollTo(0, scrollY)\n//       setTimeout(()=>{\n//         window.scrollTo(0, scrollY)\n//       }, 500)\n//     }\n//\n//     setFromHistoryState(window.history.state)\n//     const popstateListener = event => {\n//       if (event.type === 'popstate') {\n//         setFromHistoryState(event.state)\n//       }\n//     }\n//     window.addEventListener('popstate', popstateListener)\n//\n//     const scrollListener = () => {\n//       const newScrollY = window.scrollY\n//       console.log(' ')\n//       console.log('scrollListener-window.history.state', window.history.state)\n//       console.log('scrollListener-newScrollY', newScrollY)\n//       console.log('pathRef.current', pathRef.current)\n//\n//       if (typeof pathRef.current === 'string') {\n//         window.history.replaceState(\n//           {\n//             ...(window.history.state || {}),\n//             scrollY: newScrollY,\n//           },\n//           '',\n//           pathRef.current\n//         )\n//         console.log('window.history.state', window.history.state)\n//\n//         // navigate(pathRef.current, {\n//         //   replace: true,\n//         //   state: {\n//         //     // ...(window.history.state || {}),\n//         //     scrollY: newScrollY,\n//         //   },\n//         // })\n//       }\n//     }\n//     window.addEventListener('scroll', scrollListener)\n//\n//     // Unregister listener when component unmounts.\n//     return () => {\n//       console.log('Unregister')\n//       window.removeEventListener('popstate', popstateListener)\n//       window.removeEventListener('scroll', scrollListener)\n//     }\n//   }, [])\n// }\n\nfunction App() {\n  // useScrollMemory()\n\n  const matchesStartpage = useMatch('/')\n  const location = useLocation()\n\n  const [customLocation, setCustomLocation] = useState({})\n\n  useEffect(() => {\n    //    /slug=id/suffix\n    //    /slugOrId/suffix\n\n    const slugAndIdRegex = /^\\/([^=/]*)(?:=?)([^=/]*)(.*)/\n\n    const slugAndIdMatch = location.pathname.match(slugAndIdRegex)\n    const slugOrId = slugAndIdMatch[1]\n    let id = slugAndIdMatch[2]\n    let suffix = slugAndIdMatch[3]\n\n    if (!id && slugOrId) {\n      id = slugOrId\n    }\n\n    if (\n      id !== ''\n      && suffix !== '/edit'\n      && suffix !== '/view'\n    ) {\n      suffix = '/view'\n    }\n\n    const newPathname = `/${id}${suffix}`\n    if (customLocation.pathname !== newPathname) {\n      // TODO: save scroll position\n      \n\n\n      setCustomLocation({\n        pathname: newPathname,\n      })\n    }\n  }, [ location, customLocation, setCustomLocation ])\n\n  const fallback_title = 'VoltLink'\n  const fallback_description = 'VoltLink is an information-hub about Volt Europa.'\n\n  return (<>\n    <div className={`${classes.app} ${matchesStartpage ? classes.isStartpage : ''}`}>\n      <SidebarProvider>\n        {\n          matchesStartpage\n          ? null\n          : <Sidebar />\n        }\n        <Main>\n          <Routes location={customLocation}>\n            <Route path=\"/:id/view\" element={<Viewer />} />\n            <Route path=\"/:id/edit\" element={\n              <Suspense>\n                <Editor />\n              </Suspense>\n            } />\n            {/* <Route path=\"/shortcode\" element={<Shortcode />} /> */}\n            <Route path=\"/\" element={<>\n              <Helmet>\n                <title>{fallback_title}</title>\n                <meta name=\"title\" content={fallback_title} />\n                <meta name=\"og:title\" content={fallback_title} />\n                <meta name=\"twitter:title\" content={fallback_title} />\n\n                <meta name=\"description\" content={fallback_description} />\n                <meta name=\"og:description\" content={fallback_description} />\n                <meta name=\"twitter:description\" content={fallback_description} />\n              </Helmet>\n              <SidebarContent />\n            </>} />\n          </Routes>\n        </Main>\n      </SidebarProvider>\n    </div>\n  </>)\n}\n\nexport default App\n","import React, { useEffect, useState } from 'react'\n\n// https://projectfluent.org/play/\n\n// import { LocalizationProvider, Localized } from '@fluent/react' // '@fluent/react/compat'\nimport { ReactLocalization, LocalizationProvider } from '@fluent/react'\nimport { FluentBundle, FluentResource } from '@fluent/bundle'\nimport { negotiateLanguages } from '@fluent/langneg'\n\n\nexport const locales = {\n  de: 'Deutsch',\n  en: 'English',\n  nl: 'Dutch',\n  es: 'Español',\n  // pt: 'Português',\n  fr: 'Français',\n  it: 'Italiano',\n  // pl: 'Polska',\n  // ru: 'Pусский',\n}\n\nconst _supportedLocales_ = Object.keys(locales)\nconst _defaultLocale_ = 'en'\n\n\nasync function fetchMessages(locale) {\n  const path = await import('../locales/' + locale + '.ftl')\n\n  const response = await fetch(path.default)\n  const messages = await response.text()\n\n  return { [locale]: new FluentResource(messages) }\n}\n\nfunction getDefaultBundles() {\n  const bundle = new FluentBundle('')\n  bundle.addResource(new FluentResource(''))\n  return new ReactLocalization([bundle])\n}\n\nasync function createMessagesGenerator(currentLocales) {\n  const fetched = await Promise.all(\n    currentLocales.map(fetchMessages)\n  )\n  const messages = fetched.reduce(\n    (obj, cur) => Object.assign(obj, cur)\n  )\n\n  return function* generateBundles() {\n    for (const locale of currentLocales) {\n      const bundle = new FluentBundle(locale)\n      bundle.addResource(messages[locale])\n      yield bundle\n    }\n  }\n}\n\nexport function AppLocalizationProvider({ userLocales, children, onLocaleChange }) {\n  const [bundles, setBundles] = useState(getDefaultBundles())\n\n  useEffect(() => {\n    async function loadBundles() {\n      const currentLocales = negotiateLanguages(\n        userLocales,\n        _supportedLocales_,\n        { defaultLocale: _defaultLocale_ }\n      )\n\n      if (!!onLocaleChange) {\n        onLocaleChange(currentLocales)\n      }\n\n      const generateBundles = await createMessagesGenerator(currentLocales)\n\n      const new_bundles = new ReactLocalization(generateBundles())\n      new_bundles.userLocales = userLocales\n      new_bundles.defaultLocale = _defaultLocale_\n      new_bundles.supportedLocales = _supportedLocales_\n      setBundles(new_bundles)\n    }\n    loadBundles()\n  }, [userLocales, onLocaleChange])\n\n  if (!bundles) {\n    // Show a loader.\n    return <div>Loading texts…</div>\n  }\n\n  return <LocalizationProvider l10n={bundles}>\n    {children}\n  </LocalizationProvider>\n}\n\n","import React, { useState, useEffect, useCallback } from 'react'\nimport { createRoot } from 'react-dom/client'\n\nimport './index.css'\n\nimport snackbarClasses from './Snackbar.module.css'\n\nimport App from './pages/App.js'\n// import reportWebVitals from './reportWebVitals'\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nimport 'intl-pluralrules'\nimport { AppLocalizationProvider, locales } from './fluent/l10n.js'\n// import { TranslatedInputProvider } from './components/edit/TranslatedInput.js'\n\nimport useMediaQuery from '@mui/material/useMediaQuery'\nimport { createTheme, ThemeProvider } from '@mui/material/styles'\n\nimport { SnackbarProvider } from 'notistack'\n\nimport {\n  ApolloClient,\n  InMemoryCache,\n  ApolloProvider,\n} from '@apollo/client'\n\nwindow.process = {} // BUGFIX for CRA4 error-page after hot-reloading.\n\nwindow.env = 'prod' // dev / prod\nwindow.domains = {\n  frontend: 'https://volt.link/',\n  backend: 'https://api.volt.link/',\n  // frontend: 'http://localhost:4003/',\n  // backend: 'http://localhost:4004/',\n}\n\nconst client = new ApolloClient({\n  uri: window.domains.backend+'graphql/v1/',\n  cache: new InMemoryCache(),\n  credentials: 'include',\n  defaultOptions: {\n    watchQuery: {\n      // fetchPolicy: 'cache-and-network',\n      fetchPolicy: 'no-cache',\n      errorPolicy: 'ignore',\n    },\n    query: {\n      fetchPolicy: 'no-cache',\n      errorPolicy: 'all',\n    },\n  },\n})\n\n// client\n//   .query({\n//     query: gql`\n//       query GetRates {\n//         rates(currency: \"USD\") {\n//           currency\n//         }\n//       }\n//     `\n//   })\n//   .then(result => console.info(result));\n\nfunction Start() {\n  // const [userLocales, setUserLocales] = useState(['de'])\n  const [userLocales, setUserLocales] = useState(navigator.languages)\n  const [currentLocale, setCurrentLocale] = useState(null)\n\n  useEffect(() => {\n    if (!!window.umami) {\n      let systemLocales = navigator.languages\n      if (!!systemLocales || Array.isArray(systemLocales)) {\n        for (let locale of systemLocales) {\n          locale = locale.toLowerCase() // Not really correct but the system locales sadly don't conform to the standard.\n\n          const language = locale.split('-')[0]\n          if (language !== locale) {\n            window.umami.trackEvent('L: ' + language) // Log just the language.\n          }\n          window.umami.trackEvent('L: ' + locale) // Log the full locale.\n        }\n      }\n    }\n  }, [])\n\n  const handleLanguageChange = useCallback(event => {\n    setUserLocales([event.target.dataset.locale])\n  }, [setUserLocales])\n\n  const handleCurrentLocalesChange = useCallback(currentLocales => {\n    setCurrentLocale(currentLocales.length > 0 ? currentLocales[0] : '')\n  }, [setCurrentLocale])\n\n\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)')\n\n  const theme = React.useMemo(\n    () =>\n      createTheme({\n        palette: {\n          mode: prefersDarkMode ? 'dark' : 'light',\n        },\n      }),\n    [prefersDarkMode],\n  )\n\n  return <>\n  <div\n    id=\"react-notification\"\n    key=\"react-notification\"\n    style={{zIndex: '10000'}}\n  ></div>\n\n  <AppLocalizationProvider\n    key=\"AppLocalizationProvider\"\n    userLocales={userLocales}\n    onLocaleChange={handleCurrentLocalesChange}\n  >\n    <ApolloProvider client={client}>\n      <ThemeProvider theme={theme}>\n        <SnackbarProvider\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n          style={{ minWidth: 'unset' }}\n          classes={{\n            variantSuccess: `${snackbarClasses.snackbar} ${snackbarClasses.success}`,\n            variantError: `${snackbarClasses.snackbar} ${snackbarClasses.error}`,\n            variantWarning: `${snackbarClasses.snackbar} ${snackbarClasses.warning}`,\n            variantInfo: `${snackbarClasses.snackbar} ${snackbarClasses.info}`,\n          }}\n          domRoot={document.getElementById('react-notification')}\n        >\n          {/* <TranslatedInputProvider> */}\n            <Router>\n              <App locales={locales} currentLocale={currentLocale} onLanguageChange={handleLanguageChange} />\n            </Router>\n          {/* </TranslatedInputProvider> */}\n        </SnackbarProvider>\n      </ThemeProvider>\n    </ApolloProvider>\n  </AppLocalizationProvider>\n  </>\n}\n\nconst container = document.getElementById('root')\nconst root = createRoot(container)\nroot.render(<Start />)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.info))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals()\n","import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\nimport fluentBy from './fluentBy.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\n\nfunction translateBlock (block, userLocales, fallback) {\n  const {\n    properties = {}\n  } = block || {}\n  \n  let locale = properties.locale || 'en'\n  let text = properties.text || fallback || ''\n\n  if (!userLocales || !Array.isArray(userLocales)) {\n    userLocales = [locale]\n  }\n    \n  let translations = properties.translations || []\n  if (Array.isArray(translations)) {\n    translations = [\n      {\n        locale,\n        text,\n      },\n      ...translations,\n    ]\n\n    const correct_translations = fluentBy.fluentByArray(translations, userLocales, 'locale')\n    if (correct_translations.length > 0) {\n      text = correct_translations[0].text\n    }\n  }\n\n  return text\n}\n\nfunction useLocalization() {\n  const l10n = React.useContext(FluentContext)\n\n  const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n  const fluentByAny = (any = [], fallback = '') => fluentBy.fluentByAny(any, l10n.userLocales, fallback)\n\n  return {\n    ...l10n,\n    getString,\n    fluentByAny,\n    translateBlock,\n  }\n}\n\nexport {\n  negotiateLanguages,\n  withLocalization,\n  Localized,\n  Localized as default,\n  useLocalization,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Viewer_app__1_jMF\",\"spine_aligned\":\"Viewer_spine_aligned__2mJuq\",\"items\":\"Viewer_items__2FgjF\",\"coverphoto\":\"Viewer_coverphoto__16R-U\",\"icon\":\"Viewer_icon__219E5\",\"coverphotoIsSet\":\"Viewer_coverphotoIsSet__26PSP\",\"contentWrapper\":\"Viewer_contentWrapper__1HLN8\",\"type_p\":\"Viewer_type_p__O5DZS\",\"viewer\":\"Viewer_viewer__JHrvB\"};","function getImageUrl(imageObj) {\n  if (\n    typeof imageObj === 'object'\n    && imageObj !== null\n    && !Array.isArray(imageObj)\n  ) {\n    if (imageObj.type === 'url') {\n      return imageObj.url || ''\n    }\n  }\n\n  return ''\n}\n\n\n\nfunction hexToRGBArray(color) {\n  if (color.startsWith('#')) {\n    color = color.substring(1)\n  }\n\n  if (color.length === 3) {\n    color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);\n  } else if (color.length !== 6) {\n    throw(new Error('Invalid hex color: ' + color));\n  }\n\n  let rgb = [];\n  for (var i = 0; i <= 2; i++) {\n    rgb[i] = parseInt(color.substr(i * 2, 2), 16);\n  }\n\n  return rgb;\n}\nfunction luma(color) { \n  // color can be a hex string or an array of RGB values 0-255\n  const rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;\n  return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings\n}\nfunction getContrastingColor(color) {\n  // source: https://stackoverflow.com/questions/635022/calculating-contrasting-colours-in-javascript\n  // exact answer: https://stackoverflow.com/a/6511606/2387277\n  // example: https://jsfiddle.net/thomasrosen/9njo6t7s/20/\n  \n  return (luma(color) >= 165) ? '000' : 'fff';\n}\n\n\n\n// function randomHexColor () {\n//   let color = ''\n//   for (let i = 0; i < 6; i++){\n//     const random = Math.random()\n//     const bit = (random * 16) | 0\n//     color += (bit).toString(16)\n//   }\n//   return '#'+color\n// }\n\n\n\nfunction colorToRGBA(color) {\n  // source: https://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes\n  // source: https://stackoverflow.com/a/24390910/2387277\n\n  // Returns the color as an array of [r, g, b, a] -- all range from 0 - 255\n  // color must be a valid canvas fillStyle. This will cover most anything\n  // you'd want to use.\n  // Examples:\n  // colorToRGBA('red')  # [255, 0, 0, 255]\n  // colorToRGBA('#f00') # [255, 0, 0, 255]\n  var cvs, ctx;\n  cvs = document.createElement('canvas');\n  cvs.height = 1;\n  cvs.width = 1;\n  ctx = cvs.getContext('2d');\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\nfunction byteToHex(num) {\n    // Turns a number (0-255) into a 2-character hex number (00-ff)\n    return ('0'+num.toString(16)).slice(-2);\n}\nfunction colorToHex(color) {\n    // Convert any CSS color to a hex representation\n    // Examples:\n    // colorToHex('red')            # '#ff0000'\n    // colorToHex('rgb(255, 0, 0)') # '#ff0000'\n    var rgba, hex;\n    rgba = colorToRGBA(color);\n    hex = [0,1,2].map(\n        function(idx) { return byteToHex(rgba[idx]); }\n        ).join('');\n    return \"#\"+hex;\n}\n\n\n\nfunction getBlockColor(block) {\n  const colors = {\n    color: null,\n    colorRGB: null,\n    contrastingColor: null,\n    contrastingColorRGB: null,\n  }\n\n  if (block.hasOwnProperty('properties') && block.properties.hasOwnProperty('color') && !!block.properties.color) {\n    const defaultColors = ['purple', 'red', 'green', 'blue', 'yellow']\n    let newColor = block.properties.color\n\n    if (defaultColors.includes(newColor)) {\n      colors.color = `var(--${newColor})`\n      colors.colorRGB = `var(--${newColor}-rgb)`\n      colors.contrastingColor = `var(--on-${newColor})`\n      colors.contrastingColorRGB = `var(--on-${newColor}-rgb)`\n    } else {\n      if (newColor.startsWith('#')) {\n        if (newColor.length !== 4 && newColor.length !== 7) {\n          newColor = null\n        }\n      } else {\n        const parsedColor = colorToHex(newColor)\n        if (parsedColor === '#000000' && newColor !== 'black') {\n          newColor = null\n        } else {\n          newColor = parsedColor\n        }\n      }\n\n      if (newColor) {\n        colors.color = newColor\n        const colorRGB = hexToRGBArray(newColor)\n        colors.colorRGB = colorRGB.join(', ')\n        colors.contrastingColor = '#'+getContrastingColor(newColor)\n        colors.contrastingColorRGB = hexToRGBArray(colors.contrastingColor)\n      }\n    }\n  }\n\n  return colors\n}\n\nmodule.exports = {\n  getImageUrl,\n  getBlockColor,\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerLine_icon__DvsyX\",\"square\":\"ViewerLine_square__3knjg\",\"round\":\"ViewerLine_round__1pnCx\",\"title\":\"ViewerLine_title__35XNW\"};","import { gql } from '@apollo/client'\n\nexport const getBlock_Query = gql`\n  query getBlock ($_id: ObjectID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n        block {\n          _id\n          type\n          properties\n          content {\n            blockId\n          }\n          parent\n          metadata {\n            modified\n            modified_by\n          }\n          permissions\n          computed {\n            roles\n            inherited_block_permissions\n          }\n        }\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getBlocks_Query = gql`\n  query getBlocks ($ids: [ObjectID], $types: [String], $archived: Boolean, $roots: [ObjectID]) {\n    blocks (ids: $ids, types: $types, archived: $archived, roots: $roots) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        modified\n        modified_by\n      }\n      permissions\n      computed {\n        roles\n        inherited_block_permissions\n      }\n    }\n  }\n`\n\nexport const getSelf_Query = gql`\n  query getSelf {\n    self {\n\t\t  logged_in\n\t\t  user\n\t\t  blockId\n      userroles\n    }\n  }\n`\n\nexport const getSiblingBlocks_Query = gql`\n  query getSiblingBlocks ($_id: ObjectID!, $types: [String]) {\n    blocks: siblingBlocks (_id: $_id, types: $types) {\n      _id\n      type\n      properties\n    }\n  }\n`\n\nexport const getParentBlocks_Query = gql`\n  query getParentBlocks ($_id: ObjectID!) {\n    blocks: parentBlocks (_id: $_id) {\n      _id\n      type\n      properties\n      computed {\n        sort\n      }\n    }\n  }\n`\n\nexport const blockMatchesRoles_Query = gql`\n  query blockMatchesRoles ($_id: ObjectID!, $roles: [String]) {\n    blockMatchesRoles (_id: $_id, roles: $roles)\n  }\n`\n\nexport const checkPath_Query = gql`\n  query checkPath ($path: String!) {\n    checkPath (path: $path) {\n      isOkay\n      errors\n    }\n  }\n`\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"snackbar\":\"Snackbar_snackbar__119_w\",\"default\":\"Snackbar_default__31-eU\",\"success\":\"Snackbar_success__zvTW8\",\"error\":\"Snackbar_error__3XeD6\",\"warning\":\"Snackbar_warning__2CBXt\",\"info\":\"Snackbar_info__EuVSN\"};","import { useState, useEffect } from \"react\";\n\nconst useMediaQuery = (query) => {\n  const [matches, setMatches] = useState(false);\n\n  useEffect(() => {\n    const media = window.matchMedia(query);\n    if (media.matches !== matches) {\n      setMatches(media.matches);\n    }\n    const listener = () => setMatches(media.matches);\n    window.addEventListener(\"resize\", listener);\n    return () => window.removeEventListener(\"resize\", listener);\n  }, [matches, query]);\n\n  return matches;\n}\n\nexport default useMediaQuery;\n","import React, {\n  Suspense,\n  lazy,\n  useState,\n  useCallback,\n  createContext,\n  useContext,\n} from 'react'\n\nimport {\n  SwipeableDrawer,\n} from '@mui/material'\n\nimport { useMatch } from 'react-router-dom'\n\nimport useMediaQuery from '../hooks/useMediaQuery.js'\n\nimport classes from './Sidebar.module.css'\n\nconst LazySidebarContent = lazy(() => import('./SidebarContent.js'))\n\nconst SidebarContext = createContext({})\n\nfunction useSidebarContext() {\n  return useContext(SidebarContext)\n}\n\nfunction SidebarProvider({ children }) {\n  const [open, setOpen] = useState(false)\n\n  const matchesStartpage = useMatch('/')\n  const realOpen = matchesStartpage ? false : open\n\n  const toggleSidebar = useCallback(() => {\n    setOpen(oldOpen => !oldOpen)\n  }, [ setOpen ])\n\n  return (\n    <SidebarContext.Provider value={{\n      open: realOpen,\n      setOpen,\n      toggleSidebar,\n    }}>\n      {children}\n    </SidebarContext.Provider>\n  )\n}\n\nconst sidebarWidth = 320\n\nfunction Sidebar() {\n  const { open, toggleSidebar } = useSidebarContext()\n\n  const iOS = (typeof navigator !== 'undefined' && /iPad|iPhone|iPod/.test(navigator.userAgent))\n  const isDesktop = useMediaQuery('(min-width: 960px)')\n\n  if (open) {\n    return <SwipeableDrawer\n      variant={isDesktop ? 'permanent' : 'temporary'}\n      anchor=\"left\"\n      open={open}\n      onOpen={toggleSidebar}\n      onClose={toggleSidebar}\n      disableBackdropTransition={!iOS}\n      disableDiscovery={iOS}\n      sx={{\n        width: sidebarWidth,\n        flexShrink: 0,\n        [`& .MuiDrawer-paper`]: {\n          width: sidebarWidth,\n          boxSizing: 'border-box',\n          backgroundColor: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n          border: 'none',\n        },\n      }}\n      PaperProps={{\n        sx: {\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n        }\n      }}\n    >\n      <Suspense>\n        <SidebarContent />\n      </Suspense>\n    </SwipeableDrawer>\n  }\n\n  return null\n}\n\nfunction SidebarContent() {\n  return <Suspense>\n    <LazySidebarContent />\n  </Suspense>\n}\nfunction Main({ children }) {\n  const { open } = useSidebarContext()\n\n  return <main\n    className={`${classes.main} ${open ? classes.open : ''}`}\n    style={{\n      '--sidebarWidth': sidebarWidth+'px',\n    }}\n  >\n    {children}\n  </main>\n}\n\nexport {\n  SidebarContext,\n  useSidebarContext,\n  SidebarProvider,\n  SidebarContent,\n  Sidebar,\n  Main,\n}\n\n/*\n      <Drawer\n        variant={isDesktop ? 'permanent' : ''}\n        anchor=\"left\"\n        open={open}\n        sx={{\n          width: drawerWidth,\n          flexShrink: 0,\n          [`& .MuiDrawer-paper`]: {\n            width: drawerWidth,\n            boxSizing: 'border-box',\n            backgroundColor: 'var(--background)',\n            color: 'var(--on-background)',\n          },\n        }}\n        PaperProps={{\n          sx: {\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }\n        }}\n      >\n        <Sidebar />\n      </Drawer>\n      */\n","import mdit from 'markdown-it'\nimport kbd from 'markdown-it-kbd'\nimport emoji from 'markdown-it-emoji'\nimport twemoji from 'twemoji'\n\nfunction getMD(options){\n  // var hljs = require('highlight.js') // https://highlightjs.org/\n  const md = mdit({\n    html: false,\n    xhtmlOut: false,\n    linkify: true,\n    typographer: true,\n    breaks: false,\n    // highlight: function (str, lang) {\n    //   const language_obj = hljs.getLanguage(lang)\n    //   if (lang && language_obj) {\n    //     const language = language_obj.aliases[0]\n    //     return '<pre class=\"hljs language-'+language+'\"><code>' +\n    //       hljs.highlight(str, { language, ignoreIllegals: true }).value +\n    //     '</code></pre>';\n    //   } else {\n    //     const html = hljs.highlightAuto(str, { ignoreIllegals: true })\n    //     return '<pre class=\"hljs language-'+html.language+'\"><code>' +\n    //       html.value +\n    //     '</code></pre>';\n    //   }\n\n    //   return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n    // }\n    ...options,\n  })\n\n  // md.disable([ 'heading', 'heading', 'lheading', 'paragraph', 'image' ])\n  md.use(kbd)\n  md.use(emoji)\n\n  return md\n}\n\nfunction renderInlineMarkdown(text, options = {}){\n  text = text || ''\n  // text = text.replace(/\\n/g, '<br>')\n  // text = text.replace(/\\t/g, '&emsp;')\n\n  text = text\n  .replace(/\\(TM\\)/gi, '™')\n  .replace(/\\(SM\\)/gi, '℠')\n  .replace(/\\(C\\)/gi, '©')\n  .replace(/\\(R\\)/gi, '®')\n\n  const md = getMD(options)\n  text = md.renderInline(text)\n\n  text = twemoji.parse(text, {\n    folder: 'svg',\n    ext: '.svg',\n    base: '/public/twemoji/assets/',\n    // callback: function(icon, options, variant) {\n    //   switch ( icon ) {\n    //     case 'a9':      // © copyright\n    //     case 'ae':      // ® registered trademark\n    //     case '2122':    // ™ trademark\n    //       return false\n    //     default:\n    //       return ''.concat(options.base, options.size, '/', icon, options.ext)\n    //   }\n    // }\n  })\n    \n  return text\n}\n\nexport {\n  renderInlineMarkdown,\n}\n","import {\n  Paper,\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\nimport Popover from './Popover.js'\n\nexport default function PopoverMenu ({\n  trigger,\n  children,\n  onToogle,\n  paperProps = {},\n}) {\n  return <Popover\n    trigger={trigger}\n    onToogle={onToogle}\n  >\n    {({closePopover, open, ...popoverProps}) => {\n      const {\n        sx = {},\n        ...paperPropsRest\n      } = paperProps || {}\n\n      return (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n            ...sx,\n          }}\n          elevation={8}\n          {...paperPropsRest}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              marginTop: '-8px',\n            }}\n          >\n            <div>\n\n              {typeof children === 'function' ? children({ isOpen: open, close: closePopover }) : children}\n\n              <Divider style={{opacity: 0.2, marginBottom:'8px'}}  />\n\n              <MenuItem className=\"roundMenuItem\" onClick={closePopover}>\n                <ListItemIcon>\n                  <CloseIcon />\n                </ListItemIcon>\n                <ListItemText>\n                  <Localized id=\"block_menu_close_menu\" />\n                </ListItemText>\n              </MenuItem>\n\n            </div>\n          </MenuList>\n        </Paper>\n    )}}\n  </Popover>\n}\n","import { useRef, useEffect } from 'react'\n\nimport { Transmat, addListeners, TransmatObserver } from 'transmat'\n\nimport classes from './DataTransmat.module.css'\n\nfunction getTransmatOptions(transmat, mimetypes) {\n  let data = {}\n  for (const mimetype of mimetypes) {\n    if (transmat.hasType(mimetype)) {\n      if (mimetype === 'application/json') {\n        data[mimetype] = JSON.parse(transmat.getData(mimetype))\n      } else {\n        data[mimetype] = transmat.getData(mimetype)\n      }\n    }\n  }\n\n  const options = {\n    data,\n    transmat,\n  }\n\n  return options\n}\n\nexport function DataReceiver({ onReceive, style, className, children, checkEntry, mimetypes = ['application/json'] }){\n  const receiverRef = useRef(null)\n\n  useEffect(() => {\n    const unlisten = addListeners(receiverRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (isOkay && transmat.accept()) {\n        if (typeof onReceive === 'function') {\n          onReceive(options)\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n\n        const options = getTransmatOptions(transmat, mimetypes)\n      \n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(receiverRef.current)\n\n    return () => {\n      unlisten()\n      obs.disconnect()\n    }\n  }, [ onReceive, checkEntry, mimetypes ])\n\n  return <div ref={receiverRef} style={style} className={className}>\n    {children}\n  </div>\n}\n\nexport function DataTransmiter({ onTransmit, draggable, style, className, children }){\n  const transmiterRef = useRef(null)\n\n  useEffect(() => {\n    return addListeners(transmiterRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n  }, [ onTransmit ])\n\n  return <div ref={transmiterRef} style={style} className={className} draggable={draggable ? 'true' : 'false'} tabIndex=\"0\">\n    {children}\n  </div>\n}\n\nexport function DataBothWays({ onTransmit, onReceive, checkEntry, draggable, style, className, children, mimetypes = ['application/json'] }){\n  const bothwayRef = useRef(null)\n\n  useEffect(() => {\n    const unlistenTransmit = addListeners(bothwayRef.current, 'transmit', async event => {\n      const transmat = new Transmat(event)\n\n      if (typeof onTransmit === 'function') {\n        const options = await onTransmit(transmat)\n        if (\n          typeof options === 'object'\n          && options !== null\n          && !Array.isArray(options.data)\n          && typeof options.data === 'object'\n          && options.data !== null\n        ) {\n          transmat.setData(options.data)\n          // transmat.setData({\n          //   'text/plain': 'Hello world!',\n          //   'text/html': '<h1>Hello world!</h1>',\n          //   'text/uri-list': 'http://example.com',\n          //   'application/json': {foo:'bar'},\n          // })\n        }\n      }\n    })\n\n    const unlistenReceive = addListeners(bothwayRef.current, 'receive', event => {\n      const transmat = new Transmat(event)\n      const options = getTransmatOptions(transmat, mimetypes)\n      \n      let isOkay = false\n      if (typeof checkEntry === 'function') {\n        isOkay = checkEntry(options)\n      }\n\n      if (true && transmat.accept()) { // accept everything so wrong stuff like images does not get displayed in the browser\n        if (isOkay) {\n          if (typeof onReceive === 'function') {\n            onReceive(options)\n          }\n        }\n        event.preventDefault()\n      }\n    })\n\n    const obs = new TransmatObserver(entries => {\n      for (const entry of entries) {\n        const transmat = new Transmat(entry.event)\n        const options = getTransmatOptions(transmat, mimetypes)\n\n        let isOkay = false\n        if (typeof checkEntry === 'function') {\n          isOkay = checkEntry(options)\n        }\n\n        if (isOkay) {\n          entry.target.classList.toggle(classes.drag_over, entry.isTarget)\n          entry.target.classList.toggle(classes.drag_active, entry.isActive)\n        }\n      }\n    })\n    obs.observe(bothwayRef.current)\n\n    return () => {\n      unlistenTransmit()\n      unlistenReceive()\n      obs.disconnect()\n    }\n  }, [ onTransmit, onReceive, checkEntry, mimetypes ])\n\n  return <div\n    ref={bothwayRef}\n    style={style}\n    className={className}\n    draggable={draggable ? 'true' : 'false'}\n    tabIndex=\"0\"\n  >\n    {children}\n  </div>\n}\n\n// Examples:\n//\n// <DataTransmiter\n//   draggable={true}\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'blue',\n//   }}\n//   onTransmit={() => ({\n//     'text/plain': 'Hello world!',\n//     'text/html': '<h1>Hello world!</h1>',\n//     'text/uri-list': 'http://example.com',\n//     'application/json': {foo:'bar'},\n//   })}\n// >\n//   DataTransmiter\n// </DataTransmiter>\n//\n// <DataReceiver\n//   style={{\n//     width: '100%',\n//     height: '200px',\n//     backgroundColor: 'red',\n//   }}\n//   onReceive={data => console.info('received', data)}\n// >\n//   DataReceiver\n// </DataReceiver>\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerTextCard ({ block, style, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, '')\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text)\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n  \n  const defaultProps = {\n    dir: 'auto',\n    style: {\n      whiteSpace: 'pre-wrap',\n      ...style,\n    },\n  }\n\n  const {\n    color,\n  } = getBlockColor(block)\n  if (color) {\n    defaultProps.style.color = color\n  }\n\n  let text_style = 'body'\n  if (block.properties.hasOwnProperty('text_style')) {\n    text_style = block.properties.text_style\n  }\n\n  let component = null\n  switch (text_style) {\n    case 'h1':\n      component = <h1\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h2':\n      component = <h2\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'h3':\n      component = <h3\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    case 'caption':\n      component = <caption\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n      break\n    default: // body\n      component = <p\n        dangerouslySetInnerHTML={html}\n        {...defaultProps}\n      />\n  }\n\n  return component\n}\n\nexport default ViewerTextCard\n","import { useState, useEffect } from 'react'\n\nimport { renderInlineMarkdown } from '../../markdown.js'\nimport { useLocalization } from '../../fluent/Localized.js'\nimport { getBlockColor } from '../../functions.js'\n\nfunction ViewerButtonCard ({ block, actions = {}, locales }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  const { getString, translateBlock } = useLocalization()\n  const text = translateBlock(block, locales, getString('placeholder_main_headline'))\n\n  useEffect(() => {\n    const textWithHtml = renderInlineMarkdown(text, { linkify: false })\n    setHtml({ __html: textWithHtml })\n  }, [text, setHtml])\n\n  let url = ''\n  if (\n    block\n    && block.properties\n    && block.properties.trigger\n    && block.properties.action\n    && block.properties.action.url\n    && block.properties.trigger.type === 'click'\n    && block.properties.action.type === 'open_url'\n  ) {\n    url = block.properties.action.url\n  }\n\n  const {\n    color,\n    contrastingColor,\n  } = getBlockColor(block)\n\n  const colorStyles = {}\n  if (color) {\n    colorStyles['--button-background'] = color\n    colorStyles['--button-color'] = contrastingColor\n  }\n\n  const hasClickAction = actions.hasOwnProperty('click')\n\n  if (hasClickAction === false && url !== '') {\n    return <a\n        href={url}\n        target=\"_blank\" rel=\"noreferrer\"\n      >\n      <button\n        dir=\"auto\"\n        dangerouslySetInnerHTML={html}\n        className=\"default square\"\n        style={{\n          margin: '0',\n          whiteSpace: 'pre-wrap',\n          ...colorStyles,\n        }}\n      ></button>\n    </a>\n  }\n\n  if (hasClickAction === true && typeof actions.click === 'function') {\n    return <button\n      dir=\"auto\"\n      dangerouslySetInnerHTML={html}\n      className=\"default square\"\n      style={{\n        margin: '0',\n        whiteSpace: 'pre-wrap',\n        ...colorStyles,\n      }}\n      onClick={actions.click}\n    ></button>\n  }\n\n  return <button\n    dir=\"auto\"\n    dangerouslySetInnerHTML={html}\n    disabled=\"disabled\"\n    className=\"default square\"\n    style={{\n      margin: '0',\n      whiteSpace: 'pre-wrap',\n      ...colorStyles,\n    }}\n  ></button>\n}\n\nexport default ViewerButtonCard\n","import { getBlockColor } from '../../functions.js'\n\nexport default function ViewerDividerLine ({ block }) {\n  const {\n    color,\n  } = getBlockColor(block)\n\n  const styles = {}\n  if (color) {\n    styles['--on-background'] = color\n  }\n\n  return <hr style={styles} />\n}\n","import {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction ViewerCheckboxCard ({ block }) {\n  const text = block.properties.text || ''\n\n  const checked = Boolean(block.properties.checked)\n\n  const checkboxStyle = {\n    verticalAlign: 'middle',\n    paddingInlineEnd: 'var(--basis)',\n    height: 'calc(var(--font-add) + var(--basis))',\n    width: 'auto',\n  }\n\n  return <p dir=\"auto\">\n    {\n      checked\n      ? <CheckBoxIcon style={checkboxStyle} />\n      : <CheckBoxOutlineBlankIcon style={checkboxStyle} />\n    }\n    {text}\n  </p>\n}\n\nexport default ViewerCheckboxCard\n","import { useLocalization } from '../../fluent/Localized.js'\n\nimport { getImageUrl, getBlockColor } from '../../functions.js'\nimport useBlockTrigger from '../../hooks/useBlockTrigger.js'\n\nimport {\n  InsertDriveFile as PageIcon,\n  Face as PersonIcon,\n  LinkSharp as RedirectIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport classes from './ViewerLine.module.css'\n\nfunction ViewerLine ({ block, actions = {}, locales }) {\n  const { getString, translateBlock, userLocales } = useLocalization()\n\n  const { link, path } = useBlockTrigger({ block })\n\n  let title = translateBlock(block, locales || userLocales, '')\n  if (title === '') {\n    const triggerProperties = ((block.properties || {}).trigger || {})\n    const triggerType = triggerProperties.type\n\n    if (triggerType === 'path') {\n      title = '/'+triggerProperties.path\n    } else if (block.type === 'redirect') {\n      if (triggerType === 'click') {\n        title = triggerProperties.blockId\n      } else if (triggerType === 'cron') {\n        title = triggerProperties.cron\n      } else if (triggerType === 'block_change') {\n        title = triggerProperties.blockId\n      } else if (Object.keys(triggerProperties).length > 0) {\n        title = JSON.stringify(triggerProperties)\n      } else {\n        title = getString('placeholder_main_headline')\n      }\n    } else {\n      title = getString('placeholder_main_headline')\n    }\n  }\n  \n  let isSquareIcon = false\n  let icon_url = getImageUrl(block.properties.icon)\n  if (!icon_url) {\n    isSquareIcon = true\n    icon_url = getImageUrl(block.properties.coverphoto)\n  }\n\n  let iconComponent = null\n  if (icon_url === '') {\n    switch (block.type) {\n      case 'person':\n        iconComponent = <PersonIcon className={classes.icon} />\n        break\n      case 'redirect':\n        iconComponent = <RedirectIcon className={classes.icon} />\n        break\n      default:\n      iconComponent = <PageIcon className={classes.icon} />\n    }\n  } else {\n    iconComponent = <div className={`${classes.icon} ${isSquareIcon ? classes.square : classes.round}`} style={{ backgroundImage: `url(${window.domains.backend}download_url?f=${window.imageFormat || 'jpg'}&w=40&h=40&url=${encodeURIComponent(icon_url)})` }} alt={title}></div>\n  }\n\n\n\n  let cardOnClick = null\n  let cardLink = path || link\n\n  if (actions.hasOwnProperty('link')) {\n    if (typeof actions.link === 'string') {\n      cardLink = actions.link\n    }\n  } else if (actions.hasOwnProperty('click')) {\n    if (typeof actions.click === 'function') {\n      cardOnClick = actions.click\n    }\n  }\n\n  const {\n    color = 'inherit',\n    colorRGB = '--on-background-rgb',\n  } = getBlockColor(block)\n\n  if (typeof cardLink === 'string' && cardLink.length > 0) {\n    if (cardLink.includes(':')) {\n      return <a\n        href={cardLink}\n        target=\"_blank\" rel=\"noreferrer\"\n        title={title}\n        className={`clickable_card ${classes.root}`}\n        style={{\n          display: 'block',\n          cursor: 'pointer',\n          color,\n          '--on-background-rgb': colorRGB,\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center' }}>\n          {iconComponent}\n          <span dir=\"auto\" className={classes.title}>{title}</span>\n        </div>\n      </a>\n    } else {\n      return <Link\n      to={cardLink}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        display: 'block',\n        cursor: 'pointer',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </Link>\n    }\n  } else {\n    const onClickProps = {}\n    if (typeof cardOnClick === 'function') {\n      onClickProps.onClick = cardOnClick\n    }\n\n    return <div\n      {...onClickProps}\n      title={title}\n      className={`clickable_card ${classes.root}`}\n      style={{\n        cursor: typeof cardOnClick === 'function' ? 'pointer' : 'auto',\n        color,\n        '--on-background-rgb': colorRGB,\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        {iconComponent}\n        <span dir=\"auto\" className={classes.title}>{title}</span>\n      </div>\n    </div>\n  }\n}\n\nexport default ViewerLine\n","import { useState, useEffect } from 'react' // useCallback\n// import { useNavigate } from 'react-router-dom'\n\nexport default function useBlockTrigger({ block = null }) {\n  const [link, setLink] = useState(null)\n  const [path, setPath] = useState(null)\n  // const [onClick, setOnClick] = useState(null)\n\n  // let navigate = useNavigate()\n\n  useEffect(() => {\n    let newLink = null\n    let newPath = null\n    // let newOnClick = null\n\n    if (block !== null) {\n      const blockId = block._id\n\n      const triggerProperties = ((block.properties || {}).trigger || {})\n      const triggerType = triggerProperties.type\n\n      const actionProperties = ((block.properties || {}).action || {})\n      const actionType = actionProperties.type\n\n      if (\n        triggerType === 'path'\n        || triggerType === 'click'\n      ) {\n        if (\n          actionType === 'open_url'\n          && typeof actionProperties.url === 'string'\n          && actionProperties.url.length > 0\n        ) {\n          const url = actionProperties.url || ''\n          newLink = url\n          newPath = null // `/${triggerProperties.path}`\n          // newOnClick = () => window.open(newLink, '_blank')\n        } else if (\n          actionType === 'render_block'\n          && typeof triggerProperties.path === 'string'\n          && triggerProperties.path.length > 0\n        ) {\n          if (\n            typeof actionProperties.blockId === 'string'\n            && actionProperties.blockId.length > 0\n          ) {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${actionProperties.blockId}`\n            newPath = `/${triggerProperties.path}=${actionProperties.blockId}`\n            // newOnClick = () => navigate(newLink)\n          } else {\n            newLink = `${window.domains.frontend}${triggerProperties.path}=${blockId}`\n            newPath = `/${triggerProperties.path}=${blockId}`\n            // newOnClick = () => navigate(newLink)\n          }\n        } else {\n          newLink = `/${blockId}/view`\n          newPath = `/${blockId}`\n          // newOnClick = () => navigate(newLink)\n        }\n        // TODO: add support for other trigger types (run_script, ...)\n      } else {\n        newLink = `${window.domains.frontend}${blockId}/view`\n        newPath = `/${blockId}`\n        // newOnClick = () => navigate(newLink)\n      }\n    }\n\n    setLink(newLink)\n    setPath(newPath)\n    // setOnClick(newOnClick)\n  }, [block, setLink, setPath]) // setOnClick, navigate\n\n  return { link, path } // onClick\n}\n","import React, { useEffect, useRef, useCallback } from 'react'\n\nimport { DataBothWays } from '../DataTransmat.js'\n\nimport ViewerTextCard from './ViewerTextCard.js'\nimport ViewerButtonCard from './ViewerButtonCard.js'\nimport ViewerDividerLine from './ViewerDividerLine.js'\nimport ViewerCheckboxCard from './ViewerCheckboxCard.js'\nimport ViewerLine from './ViewerLine.js'\n\nimport classes from './ViewerAuto.module.css'\n\n// saveBlock_Mutation\nimport { moveBlock_Mutation, saveProperty_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\nimport useUser from '../../hooks/useUser.js'\n\nfunction usePressedKeys({ keys = [] }) { // keys needs to lowercase\n  const pressedKeysRef = useRef(new Set())\n\n  useEffect(() => {\n    function onKeyDown(event) {\n      const key = event.key.toLowerCase()\n      if (keys.includes(key)) {\n        pressedKeysRef.current.add(key)\n      }\n    }\n    function onKeyUp(event) {\n      const key = event.key.toLowerCase()\n      pressedKeysRef.current.delete(key)\n    }\n\n    window.addEventListener('keydown', onKeyDown)\n    window.addEventListener('keyup', onKeyUp)\n\n    return () => {\n      window.removeEventListener('keydown', onKeyDown)\n      window.removeEventListener('keyup', onKeyUp)\n    }\n  }, [keys])\n\n  const getPressedKeys = () => pressedKeysRef.current // returns a Set !!!\n\n  return { getPressedKeys }\n}\n\nfunction removeProperty(obj, prop) {\n  // remove property from objects, arrays and sub-objects\n\n  obj = JSON.parse(JSON.stringify(obj)) // clone object to make everything mutable\n\n  if (obj.hasOwnProperty(prop)) {\n    delete obj[prop]\n  }\n  for (const i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      if (typeof obj[i] == 'object' && obj[i] !== null) {\n        removeProperty(obj[i], prop)\n      }\n    }\n  }\n\n  return obj\n}\n\nfunction ViewerAuto ({ block = {}, actions = {}, size = 'card', dragable = false, ...props }) {\n  let component = null\n\n  const { userroles } = useUser()\n  const { getPressedKeys } = usePressedKeys({ keys: ['shift'] }) // returns a Set !!!\n\n  const type = block.type || null\n\n  switch (type) {\n    case 'text':\n      component = <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'button':\n      component = <ViewerButtonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'divider':\n      component = <ViewerDividerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'checkbox':\n      component = <ViewerCheckboxCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'page':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'person':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'redirect':\n      component = <ViewerLine key={block._id} block={block} actions={actions} {...props} />\n      break\n    default:\n      component = JSON.stringify(block) // <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n  }\n\n  const mutationFunction = useMutation()\n\n  const onReceive = useCallback(async ({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    if (typeof json === 'object' && json !== null) {\n      let movingBlock = json\n\n      movingBlock = removeProperty(movingBlock, '__typename')\n\n      const block_roles = block.computed.roles || []\n      const movingBlock_roles = movingBlock.computed.roles || []\n\n      if (\n        movingBlock._id !== block._id\n        && (\n          userroles.includes('admin')\n          || (\n            ( block_roles.includes('editor') || block_roles.includes('owner') )\n            && ( movingBlock_roles.includes('editor') || movingBlock_roles.includes('owner') )\n          )\n        )\n      ) {\n        const pressedKeys = getPressedKeys()\n        // TODO: handle alt-key to duplicate block (child-blocks also need to be duplicated)\n        // if (pressedKeys.has('alt')) {\n        //   // duplicate block\n        //   delete movingBlock._id\n        //   const save_result = await mutationFunction({\n        //     mutation: saveBlock_Mutation,\n        //     variables: {\n        //       block: movingBlock,\n        //     },\n        //   })\n        //\n        //   movingBlock._id = save_result.saveBlock\n        // }\n\n        let everything_updated = false\n\n        try {\n          await mutationFunction({\n            mutation: moveBlock_Mutation,\n            variables: {\n              movingBlockId: movingBlock._id,\n              newParentId: block._id,\n              newIndex: 0,\n            },\n          })\n        \n          if (pressedKeys.has('shift')) {\n            // auto hide the block        \n            await mutationFunction({\n              mutation: saveProperty_Mutation,\n              variables: {\n                _id: movingBlock._id,\n                key: 'active',\n                value: false,\n              },\n            })\n          }\n        \n          everything_updated = true\n        } catch (error) {\n          console.error(error)\n        }\n      \n        if (everything_updated) {\n          console.log('TODO reload sidebar')\n          // TODO: reload sidebar\n        }\n      }\n    } \n  }, [mutationFunction, block, getPressedKeys, userroles])\n\n  const handleCheckEntry = useCallback(({ data = {} }) => {\n    const {\n      'application/json': json\n    } = data || {}\n\n    let isOkay = false\n\n    if (\n      typeof json === 'object'\n      && json !== null\n      && json.hasOwnProperty('computed')\n      && json.computed.hasOwnProperty('roles')\n    ) {\n      const this_roles = json.computed.roles || []\n      if (userroles.includes('admin') || this_roles.includes('editor') || this_roles.includes('owner')) {\n        isOkay = true\n      }\n    }\n\n    return isOkay\n  }, [userroles])\n\n  return <DataBothWays\n    key={block._id}\n    draggable={dragable}\n    className={classes.root}\n    onTransmit={() => ({\n      data: {\n        'text/plain': block.properties.text || '',\n        // 'text/html': '<h1>Hello world!</h1>',\n        // 'text/uri-list': 'http://example.com',\n        'application/json': block,\n      }\n    })}\n    onReceive={onReceive}\n    checkEntry={handleCheckEntry}\n  >\n    {component}\n  </DataBothWays>\n}\n\nexport default ViewerAuto\n"],"sourceRoot":""}