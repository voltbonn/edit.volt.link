{"version":3,"sources":["components/view/ViewerPageLine.module.css","components/view/ViewerPageCard.module.css","components/SidebarContent.module.css","components/BlockTree.module.css","components/view/ViewerPersonCard.module.css","components/Header.module.css","pages/App.module.css","components/Sidebar.module.css","pages/Shortcode.module.css","components/edit/HtmlInput.module.css","fluent/fluentBy.js","components/view/ViewerAuto.module.css","components/edit/FancyInput.module.css","pages/Editor.module.css","locales lazy /^/.//.*/.ftl$/ groupOptions: {} namespace object","graphql/queries.js","hooks/useUser.js","hooks/useMediaQuery.js","fluent/Localized.js","graphql/mutations.js","hooks/useSaveBlock.js","components/Popover.js","components/PopoverMenu.js","components/edit/AddMenu.js","hooks/useMutation.js","components/SubMenu.js","components/edit/BlockMenu.js","components/view/ViewerHeadlineCard.js","components/view/ViewerTextCard.js","components/view/ViewerButtonCard.js","components/view/ViewerDividerCard.js","components/view/ViewerCheckboxCard.js","components/view/ViewerPageLine.js","components/view/ViewerPageCard.js","components/view/ViewerPersonCard.js","components/view/ViewerActionCard.js","components/view/ViewerAuto.js","components/BlockTree.js","components/SidebarContent.js","components/Sidebar.js","components/Header.js","components/edit/UrlInput.js","components/edit/FancyInput.js","pages/Shortcode.js","hooks/useKeyPress.js","hooks/useLoadBlock.js","hooks/useBlockMatchesRoles.js","components/edit/HtmlInput.js","components/edit/SharingEditor.js","components/edit/EmailInput.js","components/edit/PermissionsEditor.js","components/edit/CheckboxInput.js","components/MultiButton.js","images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png","images/coverphotos/thumbs/Aktion.png","images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png","images/coverphotos/thumbs/Welcome-to-Volt.png","images/coverphotos/thumbs/portugal.jpg","components/edit/CoverphotoPicker.js","components/edit/IconPicker.js","components/edit/TriggerInput.js","components/edit/ActionInput.js","components/edit/PropertiesEditor.js","components/edit/InlineEditorBlockText.js","components/edit/InlineEditorBlockButton.js","components/edit/InlineEditorBlockHeadline.js","components/edit/InlineEditorBlockDivider.js","components/edit/InlineEditorBlockCheckbox.js","components/edit/InlineEditorBlockPerson.js","components/edit/InlineEditorBlockPage.js","components/edit/InlineEditorBlock.js","hooks/useLoadBlocks.js","hooks/useDeleteBlock.js","components/edit/ContentEditor.js","components/LoginScreen.js","pages/Editor.js","pages/Viewer.js","pages/App.js","fluent/l10n.js","index.js","components/view/ViewerActionCard.module.css","components/edit/PermissionsEditor.module.css","components/edit/PropertiesEditor.module.css","components/edit/IconPicker.module.css","Snackbar.module.css","components/edit/CoverphotoPicker.module.css","pages/Viewer.module.css","components/edit/SharingEditor.module.css","components/edit/InlineEditorBlock.module.css","components/edit/ContentEditor.module.css"],"names":["module","exports","negotiateLanguages","require","fluentByObject","object","userLocales","supportedLocales","Object","keys","length","lookupedLocale","defaultLocale","strategy","fluentByArray","array","key","map","item","filter","Boolean","fluentByAny","any","fallback","Array","isArray","result","value","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","getBlock_Query","gql","getBlocks_Query","getSelf_Query","getSiblingBlocks_Query","getParentBlocks_Query","blockMatchesRoles_Query","useUser","forceRefetch","useState","user","setUser","loggedIn","setLoggedIn","apollo_client","useApolloClient","useEffect","query","a","data","hasOwnProperty","self","logged_in","catch","error","console","useMediaQuery","matches","setMatches","media","window","matchMedia","listener","addEventListener","removeEventListener","Localized","props","elems","br","Fragment","children","withLocalization","Inner","l10n","React","useContext","FluentContext","createElement","globalSupportedLocales","thisSupportedLocales","locale","includes","currentLocales","getString","args","useLocalization","fluentBy","saveBlock_Mutation","deleteBlock_Mutation","moveBlock_Mutation","useSaveBlock","useSnackbar","enqueueSnackbar","closeSnackbar","useCallback","newBlock","final_resolve","snackbarKey","__typename","loadingDataPromise","mutate","mutation","variables","block","variant","preventDuplicate","autoHideDuration","_id","saveBlock","message","race","setTimeout","response","persist","Popover","trigger","anchorRef","useRef","open","setOpen","closePopover","Math","random","toString","substring","undefined","ref","onClick","prevOpen","style","pointerEvents","Portal","display","position","top","right","bottom","left","zIndex","cursor","Popper","anchorEl","current","transition","placement","disablePortal","modifiers","name","enabled","options","altBoundary","rootBoundary","padding","altAxis","tether","TransitionProps","Fade","transformOrigin","PopoverMenu","popoverProps","Paper","sx","maxWidth","maxHeight","overflow","background","color","elevation","MenuList","autoFocus","width","marginTop","Divider","opacity","MenuItem","ListItemIcon","Close","ListItemText","blockTypeIcons","page","person","action","types","AddMenuContent","createBlock","type","AddMenu","useMutation","option","reject","SubMenu","parentMenuIsOpen","label","triggerProps","MenuListProps","onOpen","triggerRef","isSubMenuOpen","setIsSubMenuOpen","toggleSubmenu","newOpen","closeSubmenu","justifyContent","ArrowRight","marginRight","Menu","anchorOrigin","vertical","horizontal","disableAutoFocus","disableEnforceFocus","onClose","setType","toggle_active","active","onRemoveRow","navigate","addRowBefore","useNavigate","viewBlock","editBlock","createChildBlock","parent","mutationFunction","setParent","newParentId","movingBlockId","newIndex","log","metadata","ListSubheader","whiteSpace","lineHeight","margin","backgroundColor","height","icon","selected","Add","thisBlock","marginBottom","BlockTree","blockMenu","filterBlockIds","VisibilityOff","Visibility","ListItem","paddingTop","paddingBottom","primary","secondary","created","replace","modified","ViewerHeadlineCard","dir","properties","text","ViewerTextCard","__html","html","setHtml","dangerouslySetInnerHTML","ViewerButtonCard","actions","url","hasClickAction","href","disabled","onclick","ViewerDividerCard","ViewerCheckboxCard","checked","checkboxStyle","verticalAlign","paddingInlineEnd","CheckBox","CheckBoxOutlineBlank","ViewerPageLine","blockId","icon_url","click","className","classes","root","alignItems","backgroundImage","domains","backend","encodeURIComponent","alt","title","ViewerPageCard","coverphoto_url","coverphoto","description","ViewerPersonCard","ViewerActionCard","triggerInfo","triggerProperties","triggerType","path","mdiOpenInApp","size","mdiGestureTapButton","mdiTimer","cron","mdiSetRight","JSON","stringify","actionInfo","actionProperties","actionType","mdiWeb","mdiApplicationOutline","mdiFileCode","mdiCubeSend","mdiRayStartArrow","iconLine","ViewerAuto","component","checkIfArrayHasContent","level","BlockRows","levels","BlockRow","handleExpandToggle","oldOpen","rowContent","flexGrow","blockRowActions","flexShrink","nextLevel","minHeight","flexDirection","blockRow","marginLeft","Collapse","in","timeout","onGetRefetch","useQuery","refetch","blocks","reduce","acc","parentId","find","possibleParentBlock","content","some","cc","push","levelKeys","sort","b","localeCompare","SidebarContent","toggleSidebar","useSidebarContext","matchesStartpage","useMatch","refetchRef","setTypes","filteredTypes","entries","gottenBlock","toggleType","type2toggle","newTypes","header","headerBar","MenuOpen","FilterList","newRefetchFunction","location","Logout","Login","target","rel","SidebarContext","createContext","SidebarProvider","realOpen","Provider","Sidebar","iOS","navigator","test","userAgent","isDesktop","SwipeableDrawer","anchor","disableBackdropTransition","disableDiscovery","boxSizing","border","PaperProps","Main","main","sidebarWidth","Header","rightActions","notificationBanner","parentBlocks","setParentBlocks","siblingBlocks","setSiblingBlocks","loadParentBlocks","loadSiblingBlocks","leftActions","to","Home","MoreHoriz","fontWeight","url_regex","email_regex","is_email_not_url_regex","UrlInput","defaultValue","onChange","onBlur","onError","placeholder","setText","handleTextChange","event","schema_parts","split","schema","shift","after_schema","join","match","handleBlur","FancyInput","setError","callback","rightHeaderActions","redirectLink","setRedirectLink","isSubmittable","setIsSubmittable","generateRedirectLink","onKeyup","handleRedirectLink","use_as","redirect","fetch","mode","credentials","method","headers","body","r","json","input","hideSubmitButton","useLoadBlock","loadedBlock","useBlockMatchesRoles","roles","blockMatchesRoles","getInLineRangeLength","element","whichLine","normalize","getSelection","selection","range","rangeCount","getRangeAt","clonedRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","cloneContents","rangeLength","childNodes","nodeType","detach","getCaretPosition","cs","getComputedStyle","paddingY","parseFloat","borderY","borderTopWidth","borderBottomWidth","elementHeight","offsetHeight","offset","getOffset","caretOffset","getCaretOffset","inFirstLine","inLastLine","caretPositionFromStart","node","textContent","nodeName","getRangeLengthWithLinebreaks","textLength","innerText","caretPositionFromEnd","positionFromLineStart","positionFromStart","positionFromEnd","HtmlInput","linebreaks","onInputRef","onGoToPrevInput","onGoToNextInput","onSplitText","onMergeToPrevInput","onMergeFromNextInput","inputRef","fakeDefaultValue","setFakeDefaultValue","updateText","newHtmlValue","temporalDivElement","document","innerHTML","stripHtml","trim","handleTextBlur","keyDownHandler","shiftKey","execCommand","preventDefault","caret","start","slice","end","texts","handlePaste","originalEvent","clipboardData","getData","onKeyDown","onInput","onPaste","rebuild_textarea","show_placeholder","contentEditable","copyTextToClipboard","clipboard","writeText","info","err","textArea","appendChild","focus","select","msg","removeChild","fallbackCopyTextToClipboard","SharingEditor","defaultBlock","setPath","initialPath","savePath","newPath","newProperties","Modal","hideBackdrop","backdrop","dialog","inputWrapper","paddingRight","linebreak","marginInlineStart","marginInlineEnd","emails_regex","EmailInput","multiple","emails","LocalizedRole","role","RolesMenu","changeRole","removePermission","setAnchorEl","handleClose","currentTarget","Edit","Delete","sortPermissions","permissions","owner","p","email","special","other","PermissionsEditor","defaultPermissions","user_email","inputRepaintKey","setInputRepaintKey","setPermissions","newEmails","setNewEmails","newRole","setNewRole","setNewPermission","newPermissions","obj","obj_new","tmp_id","uuidv4","permission","unshift","addPermissions","newEmail","addNewPermissionFromInput","oldInputRepaintKey","doesNotHaveVoltEuropa","doesNotHavePublic","dialogsWrapper","emailInput","menuButton","KeyboardArrowDown","permissionRow","ownerInfo","CheckboxInput","setChecked","publishChanges","checkBlock","uncheckBlock","MultiButton","ariaLabel","items","choosen","setChoosen","handleClick","newValue","dataset","iconValue","isAbsoluteUrlRegexp","RegExp","defaultValueIsUrl","iconValueIsUrl","coverphotoIsSet","coverphotoIsNotSet","iconIsSet","iconIsNotSet","button_wrapper","changeCoverphotoButton","volt_bonn_thumb","welcome_to_volt_thumb","plakatschlange_thumb","portugal_thumb","aktion_thumb","src","coverphotoValue","coverphotoValueIsUrl","iconWrapper","no_image","changeIconButton","TriggerInput","setProperties","updateProperty","propertyKey","newPropertyValue","propertyTypes","morePropsInput","minWidth","flexWrap","gap","ActionInput","defaultProperties","silent","imprint","privacy_policy","tags","pronouns","publishProperties","propertiesFrameContent","properties_row","main_headline","propertiesFrame","InlineEditorBlockText","onSaveBlock","onAddRowAfter","publishTextChange","InlineEditorBlockButton","link","setLink","InlineEditorBlockHeadline","InlineEditorBlockDivider","InlineEditorBlockCheckbox","saveChecked","InlineEditorBlockPerson","InlineEditorBlockPage","InlineEditorBlockInbetweenComponent","InlineEditorBlock","contentConfig","reorderHandle","actionButton","addRowAfter","setBlock","handleChange_Type","handleBlockChange","handleSaveBlock","block_input","form_active","form_deactivated","useLoadBlocks","getFirstLineStartNode","getLastLineStartNode","reverse","lastLineNode","childNode","thisChildNodes","moveCursorToOffsetInLine","contentEditableElement","lastLineStartNode","lastLineStartNodeLength","createRange","setStart","collapse","sel","removeAllRanges","addRange","ContentEditor","contentConfigs_Ref","contentConfigs","inputRefs_Ref","inputRefs","updateCounter","setUpdateCounter","loadBlocks","deleteBlock","useDeleteBlock","setAutoFocus","firstLineStartNode","newContentConfigs","loadedBlocks","old","saveInputRef","newInputRefs","goToPrevInput","index","prevInputRef","thisIndex","goToNextInput","nextInputRef","focusLastLine","lastInputRef","handleRowChange","newContentConfig","oldContentConfig","addRowByIndex","isNaN","new_rows","splice","clonedContentConfigs","prev_index","prev_contentConfig","prev_tmp_id","this_block","prev_block","new_prev_block","savedPrevBlock","new_tmp_id","next_index","this_old_contentConfig","next_block","new_block","savedBlock","splitText","firstBlock","secondBlock","savedFirstBlock","savedSecondBlock","nextContentConfig","filteredContentConfigs","onDragEnd","destination","source","list","startIndex","endIndex","from","removed","reorder","droppableId","isDropDisabled","provided","innerRef","droppableProps","draggableId","isDragDisabled","disableInteractiveElementBlocking","shouldRespectForcePress","draggableProps","row","form","Tooltip","textAlign","inlineRowButton","dragHandleButton","dragHandleProps","attr","LoginScreen","Editor","loadBlock","isSharingEditorOpen","setIsSharingEditorOpen","openSharingEditor","closeSharingEditor","isPermissionsEditorOpen","setIsPermissionsEditorOpen","openPermissionsEditor","closePermissionsEditor","loadedTheBlock","useParams","canEdit","setCanEdit","matchesRoles","saveType","newType","saveProperties","saveContent","newContent","savePermissions","manuallySaveEverything","editor","Viewer","loadingTheBlock","contentBlocks","setContentBlocks","canView","setCanView","loadedContentBlocks","contentBlocksOrdered","app","spine_aligned","contentWrapper","flatMap","i","contentBlock","App","useLocation","customLocation","setCustomLocation","real_path","URLSearchParams","search","get","pathname","history","replaceState","isStartpage","Shortcode","locales","de","en","fr","_supportedLocales_","_defaultLocale_","fetchMessages","default","messages","FluentResource","createMessagesGenerator","all","fetched","cur","assign","generateBundles","bundle","FluentBundle","addResource","f","AppLocalizationProvider","onLocaleChange","ReactLocalization","getDefaultBundles","bundles","setBundles","new_bundles","loadBundles","frontend","client","ApolloClient","uri","cache","InMemoryCache","defaultOptions","watchQuery","fetchPolicy","Start","languages","setUserLocales","currentLocale","setCurrentLocale","umami","systemLocales","language","toLowerCase","trackEvent","handleLanguageChange","handleCurrentLocalesChange","prefersDarkMode","theme","useMemo","createTheme","palette","ApolloProvider","ThemeProvider","variantSuccess","snackbarClasses","snackbar","success","variantError","variantWarning","warning","variantInfo","domRoot","getElementById","onLanguageChange","ReactDOM","render"],"mappings":"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","file":"static/js/main.5de17fad.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerPageLine_icon__GiwAD\",\"title\":\"ViewerPageLine_title__3zDUr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"coverphoto\":\"ViewerPageCard_coverphoto__tOV8d\",\"icon\":\"ViewerPageCard_icon__Vn_YM\",\"title\":\"ViewerPageCard_title__Lgi9t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"SidebarContent_content__RAi8X\",\"header\":\"SidebarContent_header__1pYRG\",\"headerBar\":\"SidebarContent_headerBar__2xkje\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"blockRow\":\"BlockTree_blockRow__80Vim\",\"blockRowActions\":\"BlockTree_blockRowActions__GDOGf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"ViewerPersonCard_icon__3fe_H\",\"name\":\"ViewerPersonCard_name__3Ddq3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__3mObx\",\"headerBar\":\"Header_headerBar__2YU41\",\"notificationBanner\":\"Header_notificationBanner__104SP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3hbGO\",\"isStartpage\":\"App_isStartpage__1Q6rs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"Sidebar_main__1MCX5\",\"open\":\"Sidebar_open__gnBQb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"Shortcode_input__Av6rm\",\"hideSubmitButton\":\"Shortcode_hideSubmitButton__mbXgB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rebuild_textarea\":\"HtmlInput_rebuild_textarea__ZfRzZ\",\"show_placeholder\":\"HtmlInput_show_placeholder__hM8g2\"};","const { negotiateLanguages } = require('@fluent/langneg')\n\nfunction fluentByObject(object = {}, userLocales = ['en']){\n  const supportedLocales = Object.keys(object)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return object[lookupedLocale[0]]\n}\n\nfunction fluentByArray(array = [], userLocales = ['en'], key = 'locale') {\n  const supportedLocales = array.map(item => item[key]).filter(Boolean)\n\n  if (supportedLocales.length === 0) {\n    return null\n  }\n\n  const lookupedLocale = negotiateLanguages(\n    userLocales,\n    supportedLocales,\n    {\n      defaultLocale: supportedLocales[0],\n      strategy: 'lookup',\n    }\n  )\n\n  if (lookupedLocale.length === 0) {\n    return null\n  }\n\n  return array.filter(item => item[key] === lookupedLocale[0])\n}\n\nfunction fluentByAny(any = '', userLocales = ['en'], fallback = '') {\n  if (Array.isArray(any)) {\n    const result = fluentByArray(any, userLocales)\n    if (Array.isArray(result) && result.length > 0) {\n      any = result[0].value\n    }\n  } else if (typeof any === 'object') {\n    any = fluentByObject(any, userLocales)\n  }\n  if (typeof any !== 'string') {\n    any = fallback\n  }\n  return any\n}\n\nmodule.exports = {\n  fluentByObject,\n  fluentByArray,\n  fluentByAny,\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ViewerAuto_root__1p6KG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"error\":\"FancyInput_error__2DFWE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editor\":\"Editor_editor__2hX0g\",\"loadingContent\":\"Editor_loadingContent__2fqdK\",\"editor_form_row\":\"Editor_editor_form_row__17Pul\"};","var map = {\n\t\"./de.ftl\": [\n\t\t225,\n\t\t3\n\t],\n\t\"./en.ftl\": [\n\t\t226,\n\t\t4\n\t],\n\t\"./fr.ftl\": [\n\t\t227,\n\t\t5\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 216;\nmodule.exports = webpackAsyncContext;","import { gql } from '@apollo/client'\n\nexport const getBlock_Query = gql`\n  query getBlock ($_id: ObjectID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        created\n      }\n    }\n  }\n`\n\nexport const getBlocks_Query = gql`\n  query getBlocks ($ids: [ObjectID], $types: [String]) {\n    blocks (ids: $ids, types: $types) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        modified\n        created\n      }\n    }\n  }\n`\n\nexport const getBlockBySlug_Query = gql`\n  query getBlockBySlug ($slug: ObjectID!) {\n    blockBySlug (slug: $slug) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n      }\n\t\t  parent\n\t\t  metadata {\n        modified\n        created\n      }\n      permissions {\n        email\n        role\n      }\n    }\n  }\n`\n\nexport const getSelf_Query = gql`\n  query getSelf {\n    self {\n\t\t  logged_in\n\t\t  user\n\t\t  blockId\n    }\n  }\n`\n\nexport const getSiblingBlocks_Query = gql`\n  query getSiblingBlocks ($_id: ObjectID!, $types: [String]) {\n    siblingBlocks (_id: $_id, types: $types) {\n      _id\n      type\n      properties\n    }\n  }\n`\n\nexport const getParentBlocks_Query = gql`\n  query getParentBlocks ($_id: ObjectID!) {\n    parentBlocks (_id: $_id) {\n      _id\n      type\n      properties\n      computed\n    }\n  }\n`\n\nexport const blockMatchesRoles_Query = gql`\n  query blockMatchesRoles ($_id: ObjectID!, $roles: [String]) {\n    blockMatchesRoles (_id: $_id, roles: $roles)\n  }\n`\n","import { useState, useEffect } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSelf_Query } from '../graphql/queries'\n\nexport default function useUser(forceRefetch = false) {\n  const [user, setUser] = useState({})\n  const [loggedIn, setLoggedIn] = useState(false)\n\n  const apollo_client = useApolloClient()\n\n  useEffect(() => {\n    apollo_client.query({\n      query: getSelf_Query,\n    })\n      .then(async ({ data }) => {\n        if (data.hasOwnProperty('self')) {\n          setUser(data.self)\n          setLoggedIn(data.self.logged_in)\n        } else {\n          setUser({})\n          setLoggedIn(false)\n        }\n      })\n      .catch(error => {\n        console.error(error)\n        setUser({})\n        setLoggedIn(false)\n      })\n  }, [forceRefetch, setUser, setLoggedIn, apollo_client])\n\n  return {\n    ...user,\n    loggedIn,\n  }\n}\n","import { useState, useEffect } from \"react\";\n\nconst useMediaQuery = (query) => {\n  const [matches, setMatches] = useState(false);\n\n  useEffect(() => {\n    const media = window.matchMedia(query);\n    if (media.matches !== matches) {\n      setMatches(media.matches);\n    }\n    const listener = () => setMatches(media.matches);\n    window.addEventListener(\"resize\", listener);\n    return () => window.removeEventListener(\"resize\", listener);\n  }, [matches, query]);\n\n  return matches;\n}\n\nexport default useMediaQuery;\n","import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\nimport fluentBy from './fluentBy.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\nfunction useLocalization() {\n  const l10n = React.useContext(FluentContext)\n\n  const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n  const fluentByAny = (any = [], fallback = '') => fluentBy.fluentByAny(any, l10n.userLocales, fallback)\n\n  return {\n    ...l10n,\n    getString,\n    fluentByAny,\n  }\n}\n\nexport {\n  negotiateLanguages,\n  withLocalization,\n  Localized,\n  Localized as default,\n  useLocalization,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","import { gql } from '@apollo/client'\n\nexport const saveBlock_Mutation = gql`\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n`\n\nexport const deleteBlock_Mutation = gql`\n  mutation deleteBlock ($_id: ObjectID!) {\n    deleteBlock (_id: $_id)\n  }\n`\n\nexport const moveBlock_Mutation = gql`\n  mutation moveBlock ($movingBlockId: ObjectID!, $newParentId: ObjectID!, $newIndex: Int!) {\n    moveBlock(movingBlockId: $movingBlockId, newParentId: $newParentId, newIndex: $newIndex)\n  }\n`\n","import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { saveBlock_Mutation } from '../graphql/mutations.js'\n\nimport { useSnackbar } from 'notistack'\n\nfunction useSaveBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleSaveBlock = useCallback((newBlock) => {\n    return new Promise(final_resolve => {\n      let snackbarKey = null\n\n      newBlock = {...newBlock}\n\n      if (\n        typeof newBlock === 'object'\n        && newBlock !== null\n        && newBlock.hasOwnProperty('__typename')\n      ) {\n        delete newBlock.__typename\n      }\n\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.mutate({\n          mutation: saveBlock_Mutation,\n          variables: {\n            block: newBlock\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string') {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 2000,\n                })\n              }\n            } else {\n              final_resolve({\n                ...newBlock,\n                _id: data.saveBlock,\n              })\n\n              enqueueSnackbar(getString('path_editor_status_saved'), {\n                variant: 'success',\n                preventDuplicate: false,\n                autoHideDuration: 2000,\n              })\n            }\n          })\n          .catch(async error => {\n            console.error(error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar(getString('path_editor_status_error_while_saving', {\n              error: error.message,\n            }), {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_saving'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleSaveBlock\n}\n\nexport default useSaveBlock\n","import { useState, useRef } from 'react'\n\nimport {\n  Portal,\n  Fade,\n  Popper,\n} from '@mui/material'\n\nconst randomString = () => (Math.random() + 1).toString(36).substring(7)\n\nfunction Popover ({\n  trigger,\n  children = () => {},\n}) {\n  const anchorRef = useRef(null)\n  const [open, setOpen] = useState(false)\n\n  const handlePopoverToggleClick = () => {\n    setOpen((prevOpen) => !prevOpen)\n  }\n\n  const closePopover = () => {\n    setOpen(false)\n  }\n\n  const id = open ? 'popover-'+randomString() : undefined\n\n  return <>\n\n    {trigger({\n      ref: anchorRef,\n      'aria-describedby': id,\n      onClick: handlePopoverToggleClick,\n      style: {\n        pointerEvents: open ? 'none' : 'all',\n      },\n    })}\n\n  <Portal>\n    <div\n      onClick={closePopover}\n      style={{\n        display: (open ? 'block' : 'none'),\n        position: 'fixed',\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0,\n        zIndex: 1299,\n        cursor: 'pointer',\n      }}\n    />\n\n    <Popper\n      id={id}\n      open={open}\n      anchorEl={anchorRef.current}\n      transition\n      placement=\"bottom-start\"\n      disablePortal={true}\n      modifiers={[\n        {\n          name: 'flip',\n          enabled: true,\n          options: {\n            altBoundary: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n        {\n          name: 'preventOverflow',\n          enabled: true,\n          options: {\n            altAxis: true,\n            altBoundary: true,\n            tether: true,\n            rootBoundary: 'viewport',\n            padding: 8,\n          },\n        },\n      ]}\n      style={{\n        zIndex: 1300,\n      }}\n    >\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps}>\n          <div>\n          {\n            !!children && typeof children === 'function'\n            ? children({\n              open,\n              style: {\n                transformOrigin: 'top left',\n              },\n              closePopover,\n            })\n            : null\n          }\n          </div>\n        </Fade>\n      )}\n    </Popper>\n\n    </Portal>\n  </>\n}\n\nexport default Popover\n","import {\n  Paper,\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\nimport Popover from './Popover.js'\n\nexport default function PopoverMenu ({\n  trigger,\n  children,\n}) {\n  return <>\n  <Popover\n    trigger={trigger}\n  >\n    {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              marginTop: '-8px',\n            }}\n          >\n            {children}\n\n            <Divider style={{opacity: 0.2}} />\n\n            <MenuItem style={{marginTop:'8px'}} onClick={closePopover}>\n              <ListItemIcon>\n                <CloseIcon />\n              </ListItemIcon>\n              <ListItemText>\n                <Localized id=\"block_menu_close_menu\" />\n              </ListItemText>\n            </MenuItem>\n\n          </MenuList>\n        </Paper>\n    )}\n  </Popover>\n  </>\n}\n","\nimport {\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\n\nimport {\n  InsertDriveFileSharp as PageIcon,\n  AutoAwesomeSharp as ActionIcon,\n  // LinkSharp as RedirectIcon,\n  PersonSharp as PersonIcon,\n  // Crop75Sharp as ButtonIcon,\n  // TitleSharp as HeadlineIcon,\n  // NotesSharp as TextIcon,\n  // Remove as DividerIcon,\n  // EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport useUser from '../../hooks/useUser.js'\nimport PopoverMenu from '../PopoverMenu.js'\nimport { Localized } from '../../fluent/Localized.js'\n\nconst blockTypeIcons = {\n  page: <PageIcon />,\n  person: <PersonIcon />,\n  action: <ActionIcon />,\n}\n\nconst types = [\n  'page',\n  'action',\n]\n\nfunction AddMenuContent({ createBlock }) {\n  return <>\n    {\n      types\n        .map(type => (\n          <MenuItem key={type} onClick={() => createBlock({ type })}>\n            <ListItemIcon>\n              {blockTypeIcons[type]}\n            </ListItemIcon>\n            <ListItemText>\n              <Localized id={'create_new_'+type} />\n            </ListItemText>\n          </MenuItem>\n        ))\n    }\n  </>\n}\n\nfunction AddMenu ({ trigger, createBlock }) {\n  const { loggedIn } = useUser()\n\n  if (loggedIn) {\n    return <PopoverMenu trigger={trigger}>\n      <div style={{ marginTop: '8px' }}></div>\n      <AddMenuContent createBlock={createBlock} />\n    </PopoverMenu>\n  }\n\n  return null\n}\n\nexport {\n  AddMenuContent,\n  AddMenu as default,\n}\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\n\nfunction useMutation() {\n  const apollo_client = useApolloClient()\n\n  const handleMutation = useCallback(option => {\n    return new Promise((resolve,reject) => {\n      apollo_client.mutate(option)\n        .then(({ data }) => {\n          if (typeof data.error === 'string') {\n            reject(data.error)\n          } else {\n            resolve(data)\n          }\n        })\n        .catch(reject)\n    })\n  }, [ apollo_client ])\n\n  return handleMutation\n}\n\nexport default useMutation\n","import { useRef, useState, useCallback } from 'react'\n\nimport {\n  Divider,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n} from '@mui/material'\n\nimport {\n  Close as CloseIcon,\n  ArrowRight as ArrowRightIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../fluent/Localized.js'\n\n// INFO: Some code is copied from: https://github.com/azmenak/material-ui-nested-menu-item/blob/master/src/index.tsx\n\nexport default function SubMenu ({\n  parentMenuIsOpen = true,\n  label = '',\n  triggerProps = {},\n  MenuListProps = {},\n  position = 'right',\n  onOpen = () => {},\n  children,\n}) {\n  const triggerRef = useRef(null)\n  const [isSubMenuOpen, setIsSubMenuOpen] = useState(false)\n  const open = isSubMenuOpen && parentMenuIsOpen\n\n  const toggleSubmenu = useCallback(() => {\n    const newOpen = !open\n    setIsSubMenuOpen(newOpen)\n    if (newOpen === true) {\n      onOpen()\n    }\n  }, [ setIsSubMenuOpen, open, onOpen ])\n\n  const closeSubmenu = useCallback(() => {\n    setIsSubMenuOpen(false)\n  }, [ setIsSubMenuOpen ])\n\n  return <>\n    <MenuItem\n      {...triggerProps}\n\n      ref={triggerRef}\n      onClick={toggleSubmenu}\n      style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        ...triggerProps.style,\n      }}\n    >\n      <div style={{ display: 'flex' }}>\n        {label}\n      </div>\n      <ArrowRightIcon style={{ marginRight: '-10px' }} />\n    </MenuItem>\n    <Menu\n      // Set pointer events to 'none' to prevent the invisible Popover div from capturing events for clicks and hovers\n      style={{ pointerEvents: 'none' }}\n      anchorEl={triggerRef.current}\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'right' : 'left'),\n      }}\n      transformOrigin={{\n        vertical: 'top',\n        horizontal: (position === 'right' ? 'left' : 'right'),\n      }}\n      open={open}\n      autoFocus={false}\n      disableAutoFocus\n      disableEnforceFocus\n      onClose={closeSubmenu}\n      sx={{\n        marginTop: '-8px', // align with parent menu\n      }}\n      MenuListProps={{\n        ...MenuListProps,\n        sx: {\n          maxWidth: 380,\n          maxHeight: 'calc(100vh - 32px)',\n          overflow: 'auto',\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n          ...MenuListProps.sx,\n        },\n      }}\n    >\n      <div style={{pointerEvents: 'auto'}}>\n        {children}\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem style={{marginTop:'8px'}} onClick={closeSubmenu}>\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <Localized id=\"block_menu_close_menu\" />\n        </MenuItem>\n      </div>\n    </Menu>\n  </>\n}\n","import { useCallback } from 'react'\n\nimport {\n  useNavigate,\n} from 'react-router-dom'\n\nimport {\n  Paper,\n  MenuList,\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListSubheader,\n  ListItemText,\n  ListItem,\n} from '@mui/material'\n\nimport {\n  Visibility as VisibilityIcon,\n  VisibilityOff as VisibilityOffIcon,\n  // Delete as DeleteIcon,\n  Close as CloseIcon,\n  // VerticalAlignTop as VerticalAlignTopIcon,\n  // VerticalAlignBottom as VerticalAlignBottomIcon,\n  Add as AddIcon,\n  RepeatSharp as RepeatIcon,\n  AccountTreeSharp as BlockTreeIcon,\n  RemoveCircleSharp as RemoveCircleIcon,\n\n  InsertDriveFileSharp as PageIcon,\n  // LinkSharp as RedirectIcon,\n  PersonSharp as PersonIcon,\n  Crop75Sharp as ButtonIcon,\n  TitleSharp as HeadlineIcon,\n  NotesSharp as TextIcon,\n  // CodeSharp as CodeIcon,\n  Remove as DividerIcon,\n  CheckBox as CheckboxIcon,\n  AutoAwesomeSharp as ActionIcon,\n\n  PreviewSharp as ViewIcon,\n  EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport { moveBlock_Mutation } from '../../graphql/mutations.js'\nimport useMutation from '../../hooks/useMutation.js'\n\nimport Popover from '../Popover.js'\nimport SubMenu from '../SubMenu.js'\nimport BlockTree from '../BlockTree.js'\nimport { AddMenuContent } from './AddMenu.js'\n\nfunction BlockMenu ({\n  block = {},\n  getString,\n\n  trigger,\n\n  setType,\n  createBlock,\n\n  toggle_active = null,\n  active = null,\n  onRemoveRow = null,\n  addRowBefore = null,\n  // addRowAfter = null,\n}) {\n  const navigate = useNavigate()\n\n  const { _id = '', type = '' } = block\n\n  // const handleAddRowBefore = useCallback(() => {\n  //\n  //   // const newBlock = {\n  //   //   type,\n  //   // }\n  //\n  //   const newBlockId = ''\n  //\n  //   addRowBefore({\n  //     blockId: newBlockId,\n  //   })\n  // }, [ addRowBefore ])\n\n  const viewBlock = useCallback(() => {\n    navigate(`/view/${_id}`)\n  }, [ _id, navigate ])\n\n  const editBlock = useCallback(() => {\n    navigate(`/edit/${_id}`)\n  }, [ _id, navigate ])\n\n  const createChildBlock = useCallback(newBlock => {\n    createBlock({\n      ...newBlock,\n      parent: _id,\n    })\n  }, [ createBlock, _id ])\n\n  const mutationFunction = useMutation()\n  const setParent = useCallback(newParentId => {\n    mutationFunction({\n      mutation: moveBlock_Mutation,\n      variables: {\n        movingBlockId: block._id,\n        newParentId: newParentId,\n        newIndex: 0,\n      },\n    })\n    .then(() => {\n      console.log('moved block')\n    })\n    .catch(console.error)\n  }, [ mutationFunction, block ])\n\n  const metadata = block.metadata || {}\n\n  return <>\n  <Popover\n    trigger={trigger}\n  >\n    {({closePopover, open, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 380,\n            // height: 325,\n            maxHeight: 'calc(100vh - 32px)',\n            overflow: 'auto',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <MenuList\n            autoFocus={true}\n            style={{\n              width: '100%',\n              maxWidth: '100%',\n              // marginTop: '-8px',\n            }}\n          >\n\n            {\n              typeof setType === 'function'\n              ? <SubMenu\n                  parentMenuIsOpen={open}\n                  label={<>\n                    <ListItemIcon>\n                      <RepeatIcon />\n                    </ListItemIcon>\n                    <Localized id=\"block_menu_choose_type_label\" />\n                  </>}\n                  MenuListProps={{\n                    style: {\n                      marginTop: '-8px',\n                    },\n                  }}\n                >\n                  <ListSubheader\n                    style={{\n                      whiteSpace: 'nowrap',\n                      lineHeight: '1',\n                      margin: '-8px 0 0 0',\n                      padding: '12px 16px 12px',\n                      backgroundColor: 'var(--background-contrast)',\n                      color: 'var(--on-background)',\n                    }}\n                  >\n                    <Localized id=\"block_menu_choose_type_label\" />\n                  </ListSubheader>\n\n                  <div style={{height: '4px'}}></div>\n\n                  {\n                    [\n                      { value: 'page', icon: <PageIcon />, label: getString('block_menu_type_label_page') },\n                      // { value: 'redirect', icon: <RedirectIcon />, label: getString('block_menu_type_label_redirect') },\n                      { value: 'person', icon: <PersonIcon />, label: getString('block_menu_type_label_person') },\n                      { value: 'button', icon: <ButtonIcon />, label: getString('block_menu_type_label_button') },\n                      { value: 'headline', icon: <HeadlineIcon />, label: getString('block_menu_type_label_headline') },\n                      // { value: 'headline3', label: getString('block_menu_type_label_headline3') },\n                      { value: 'text', icon: <TextIcon />, label: getString('block_menu_type_label_text') },\n                      // { value: 'code', icon: <CodeIcon />, label: getString('block_menu_type_label_code') },\n                      { value: 'divider', icon: <DividerIcon />, label: getString('block_menu_type_label_divider') },\n                      { value: 'checkbox', icon: <CheckboxIcon />, label: getString('block_menu_type_label_checkbox') },\n                      { value: 'action', icon: <ActionIcon />, label: getString('block_menu_type_label_action') },\n                    ]\n                    .map(option => (\n                      <MenuItem\n                        key={option.value}\n                        selected={option.value === type}\n                        onClick={() => setType(option.value)}\n                      >\n                        <ListItemIcon>\n                          {option.icon}\n                        </ListItemIcon>\n                        {option.label}\n                      </MenuItem>\n                    ))\n                  }\n                </SubMenu>\n              : null\n            }\n\n            {/*\n              addRowBefore\n                ? <MenuItem onClick={handleAddRowBefore}>\n                    <ListItemIcon>\n                      <VerticalAlignTopIcon />\n                    </ListItemIcon>\n                    <Localized id=\"block_menu_add_before\" />\n                  </MenuItem>\n                : null\n            */}\n\n            {/*\n              addRowAfter\n                ? <MenuItem onClick={addRowAfter}>\n                    <ListItemIcon>\n                      <VerticalAlignBottomIcon />\n                    </ListItemIcon>\n                    <Localized id=\"block_menu_add_after\" />\n                  </MenuItem>\n                : null\n            */}\n\n            {/*\n              onRemoveRow\n                ? <MenuItem style={{marginTop:'8px'}} onClick={onRemoveRow}>\n                    <ListItemIcon>\n                      <DeleteIcon />\n                    </ListItemIcon>\n                    <Localized id=\"block_menu_delete\" />\n                  </MenuItem>\n                : null\n            */}\n\n            {\n              typeof createBlock === 'function'\n                ? <SubMenu\n                    parentMenuIsOpen={open}\n                    label={<>\n                      <ListItemIcon>\n                        <AddIcon />\n                      </ListItemIcon>\n                      <Localized id=\"block_menu_create_child_block\" />\n                    </>}\n                  >\n                    <AddMenuContent createBlock={createChildBlock} />\n                  </SubMenu>\n                : null\n            }\n\n            <SubMenu\n              parentMenuIsOpen={open}\n              label={<>\n                <ListItemIcon>\n                  <BlockTreeIcon />\n                </ListItemIcon>\n                <Localized id=\"block_menu_move_block\" />\n              </>}\n              MenuListProps={{\n                style: {\n                  marginTop: '-8px',\n                },\n              }}\n            >\n              <ListSubheader\n                style={{\n                  whiteSpace: 'nowrap',\n                  lineHeight: '1',\n                  margin: '-8px 0 0 0',\n                  padding: '12px 16px 12px',\n                  backgroundColor: 'var(--background-contrast)',\n                  color: 'var(--on-background)',\n                }}\n              >\n                <Localized id=\"block_menu_move_block\" />\n              </ListSubheader>\n\n              <div style={{height: '8px'}}></div>\n\n              <MenuItem\n                onClick={thisBlock => setParent(null)}\n              >\n                <ListItemIcon>\n                  <RemoveCircleIcon />\n                </ListItemIcon>\n                <Localized id=\"block_menu_change_parent_none\" />\n              </MenuItem>\n\n              <Divider style={{opacity: 0.2}} />\n\n              <div style={{ padding: '0 var(--basis_x2)', marginBottom: '8px' }}>\n                <BlockTree\n                  onClick={thisBlock => setParent(thisBlock._id)}\n                  blockMenu={false}\n                  types={['page', 'person']}\n                  filterBlockIds={[_id]}\n                />\n              </div>\n            </SubMenu>\n\n            {\n              typeof active === 'boolean' && toggle_active\n                ? <MenuItem onClick={toggle_active}>\n                    <ListItemIcon>\n                      {\n                        active\n                        ? <VisibilityOffIcon />\n                        : <VisibilityIcon />\n                      }\n                    </ListItemIcon>\n                    {\n                      active\n                      ? <Localized id=\"block_menu_hide\" />\n                      : <Localized id=\"block_menu_show\" />\n                    }\n                  </MenuItem>\n                : null\n            }\n\n            {\n              typeof _id === 'string' && _id !== ''\n                ? <div>\n                    {\n                      typeof setType === 'function'\n                      // || addRowBefore\n                      // || addRowAfter\n                      || (typeof active === 'boolean' && toggle_active)\n                      || onRemoveRow\n                      || typeof createBlock === 'function'\n                        ? <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px' }} />\n                        : null\n                    }\n\n                    <MenuItem style={{marginTop:'8px'}} onClick={viewBlock}>\n                      <ListItemIcon>\n                        <ViewIcon />\n                      </ListItemIcon>\n                      <Localized id=\"view_block\" />\n                    </MenuItem>\n                    <MenuItem onClick={editBlock}>\n                      <ListItemIcon>\n                        <EditIcon />\n                      </ListItemIcon>\n                      <Localized id=\"edit_block\" />\n                    </MenuItem>\n                  </div>\n                : null\n            }\n\n            <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px'}} />\n\n            <MenuItem onClick={closePopover}>\n              <ListItemIcon>\n                <CloseIcon />\n              </ListItemIcon>\n              <Localized id=\"block_menu_close_menu\" />\n            </MenuItem>\n\n            <Divider style={{opacity: 0.2, marginTop:'8px', marginBottom:'8px'}} />\n\n            <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n              <ListItemText\n                primary={<Localized id=\"block_menu_info_created\" />}\n                secondary={(metadata.created || '').replace(/[TZ]/g, ' ')}\n              />\n            </ListItem>\n            <ListItem sx={{ paddingTop: '0', paddingBottom: '0' }}>\n              <ListItemText\n                primary={<Localized id=\"block_menu_info_modified\" />}\n                secondary={(metadata.modified || '').replace(/[TZ]/g, ' ')}\n              />\n            </ListItem>\n\n          </MenuList>\n        </Paper>\n    )}\n  </Popover>\n  </>\n}\n\nexport default withLocalization(BlockMenu)\n","function ViewerHeadlineCard ({ block }) {\n  return <h2 dir=\"auto\">{block.properties.text || ''}</h2>\n}\n\nexport default ViewerHeadlineCard\n","import { useState, useEffect } from 'react'\n\nfunction ViewerTextCard ({ block }) {\n  const [html, setHtml] = useState({ __html: '' })\n\n  useEffect(() => {\n    let text = block.properties.text || ''\n    text = text.replace(/\\n/g, '<br>')\n    // text = text.replace(/\\t/g, '&emsp;')\n\n    setHtml({ __html: text })\n  }, [block, setHtml])\n\n  return <p\n    dir=\"auto\"\n    dangerouslySetInnerHTML={html}\n    style={{\n      whiteSpace: 'pre-wrap',\n    }}\n  ></p>\n}\n\nexport default ViewerTextCard\n","function ViewerButtonCard ({ block, actions = {} }) {\n  let url = ''\n  if (\n    block\n    && block.properties\n    && block.properties.trigger\n    && block.properties.action\n    && block.properties.action.url\n    && block.properties.trigger.type === 'click'\n    && block.properties.action.type === 'open_url'\n  ) {\n    url = block.properties.action.url\n  }\n\n  const text = block.properties.text || ''\n\n  const hasClickAction = actions.hasOwnProperty('click')\n\n  if (hasClickAction === false && url !== '') {\n    return <a href={url}>\n      <button\n        dir=\"auto\"\n        style={{\n          margin: '0',\n        }}\n      >\n        {text}\n      </button>\n    </a>\n  }\n\n  if (hasClickAction === true) {\n    return <button\n      dir=\"auto\"\n      disabled=\"disabled\"\n      style={{\n        margin: '0',\n      }}\n      onClick={actions.onclick}\n    >{text}</button>\n  }\n\n  return <button\n    dir=\"auto\"\n    disabled=\"disabled\"\n    style={{\n      margin: '0',\n    }}\n  >{text}</button>\n}\n\nexport default ViewerButtonCard\n","export default function ViewerDividerCard () {\n  return <hr />\n}\n","import {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction ViewerCheckboxCard ({ block }) {\n  const text = block.properties.text || ''\n\n  const checked = Boolean(block.properties.checked)\n\n  const checkboxStyle = {\n    verticalAlign: 'middle',\n    paddingInlineEnd: 'var(--basis)',\n    height: 'calc(var(--font-add) + var(--basis))',\n    width: 'auto',\n  }\n\n  return <p dir=\"auto\">\n    {\n      checked\n      ? <CheckBoxIcon style={checkboxStyle} />\n      : <CheckBoxOutlineBlankIcon style={checkboxStyle} />\n    }\n    {text}\n  </p>\n}\n\nexport default ViewerCheckboxCard\n","import { useCallback } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport {\n  InsertDriveFile as PagePlaceholderIcon,\n} from '@mui/icons-material'\n\nimport classes from './ViewerPageLine.module.css'\n\nfunction ViewerPageLine ({ block, actions = {} }) {\n  const { getString } = useLocalization()\n\n  let navigate = useNavigate()\n\n  const blockId = block._id\n\n  const viewBlock = useCallback(()=>{\n    navigate(`/view/${blockId}`)\n  }, [navigate, blockId])\n\n  const icon_url = block.properties.icon || ''\n  const text = block.properties.text || getString('placeholder_main_headline')\n\n  return <div\n    onClick={actions.hasOwnProperty('click') ? actions.click : viewBlock}\n    className={`clickable_card ${classes.root}`}\n  >\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      {\n        icon_url === ''\n          ? <PagePlaceholderIcon className={classes.icon} />\n          : <div className={classes.icon} style={{ backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(icon_url)})` }} alt={text}></div>\n      }\n\n      <span dir=\"auto\" className={classes.title}>{text}</span>\n    </div>\n  </div>\n}\n\nexport default ViewerPageLine\n","import { useCallback } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { useLocalization } from '../../fluent/Localized.js'\n\nimport {\n  InsertDriveFile as PagePlaceholderIcon,\n} from '@mui/icons-material'\n\nimport classes from './ViewerPageCard.module.css'\n\nfunction ViewerPageCard ({ block, actions = {} }) {\n  const { getString } = useLocalization()\n\n  let navigate = useNavigate()\n\n  const blockId = block._id\n\n  const viewBlock = useCallback(()=>{\n    navigate(`/view/${blockId}`)\n  }, [navigate, blockId])\n\n  const coverphoto_url = block.properties.coverphoto || ''\n  const icon_url = block.properties.icon || ''\n  const text = block.properties.text || getString('placeholder_main_headline')\n  const description = block.properties.description || ''\n\n  return <div\n    onClick={actions.hasOwnProperty('click') ? actions.click : viewBlock}\n    className=\"clickable_card\"\n  >\n    {\n      coverphoto_url === ''\n        ? null\n        : <div className={classes.coverphoto} style={{ backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(coverphoto_url)})` }} alt={text}></div>\n    }\n\n    <div className=\"type_p\" style={{ margin: '0' }}>\n      {\n        icon_url === ''\n          ? <PagePlaceholderIcon className={classes.icon} />\n          : <div className={classes.icon} style={{ backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(icon_url)})` }} alt={text}></div>\n      }\n\n      <span dir=\"auto\" className={`${classes.title}`}>{text}</span>\n      {description !== '' ? <p dir=\"auto\" style={{ marginTop: '0' }}>{description}</p> : null}\n    </div>\n  </div>\n}\n\nexport default ViewerPageCard\n","import { useCallback } from 'react'\nimport { useNavigate } from 'react-router-dom'\n\nimport {\n  Face as PersonPlaceholderIcon,\n} from '@mui/icons-material'\n\nimport classes from './ViewerPersonCard.module.css'\n\nfunction ViewerPersonCard ({ block, actions = {} }) {\n  let navigate = useNavigate()\n\n  const blockId = block._id\n\n  const viewBlock = useCallback(()=>{\n    navigate(`/view/${blockId}`)\n  }, [navigate, blockId])\n\n  const icon_url = block.properties.icon || ''\n  const text = block.properties.text || ''\n\n  return <div\n    onClick={actions.hasOwnProperty('click') ? actions.click : viewBlock}\n    className=\"clickable_card\"\n    style={{ display: 'flex', alignItems: 'center' }}\n  >\n    {\n      icon_url === ''\n        ? <PersonPlaceholderIcon className={classes.icon} />\n        : <div className={classes.icon} style={{ backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(icon_url)})` }} alt={text}></div>\n    }\n    <span className={classes.name} dir=\"auto\">{text}</span>\n  </div>\n}\n\nexport default ViewerPersonCard\n","import { useCallback } from 'react'\nimport { useNavigate } from 'react-router-dom'\n\nimport {\n  AutoAwesomeSharp as ActionIcon,\n} from '@mui/icons-material'\n\nimport MdiIcon from '@mdi/react'\nimport {\n  mdiGestureTapButton,\n  mdiRayStartArrow,\n  mdiWeb,\n  mdiApplicationOutline,\n  mdiFileCode,\n  mdiCubeSend,\n  mdiSetRight,\n  mdiTimer,\n  mdiOpenInApp,\n} from '@mdi/js'\n\nimport classes from './ViewerActionCard.module.css'\n\nfunction ViewerActionCard ({ block = {}, actions = {} }) {\n  const navigate = useNavigate()\n\n  const blockId = block._id\n\n  const viewBlock = useCallback(()=>{\n    navigate(`/view/${blockId}`)\n  }, [navigate, blockId])\n\n  const text = block.properties.text || '' // getString('placeholder_main_headline'))\n  const description = block.properties.description || ''\n\n  let triggerInfo = null\n  const triggerProperties = ((block.properties || {}).trigger || {})\n  const triggerType = triggerProperties.type\n  if (triggerType === 'path') {\n    triggerInfo = <>\n      <MdiIcon\n        path={mdiOpenInApp}\n        size={1}\n        className={classes.icon}\n      />\n      <p>volt.link/{triggerProperties.path}</p>\n    </>\n  } else if (triggerType === 'click') {\n    triggerInfo = <>\n      <MdiIcon\n        path={mdiGestureTapButton}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{triggerProperties.blockId}</p>\n    </>\n  } else if (triggerType === 'cron') {\n    triggerInfo = <>\n      <MdiIcon\n        path={mdiTimer}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{triggerProperties.cron}</p>\n    </>\n  } else if (triggerType === 'block_change') {\n    triggerInfo = <>\n      <MdiIcon\n        path={mdiSetRight}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{triggerProperties.blockId}</p>\n    </>\n  } else {\n    triggerInfo = <>\n      <ActionIcon\n        className={classes.icon}\n      />\n      <p>{\n        Object.keys(triggerProperties).length > 0\n        ? JSON.stringify(triggerProperties)\n        : null\n      }</p>\n    </>\n  }\n\n  let actionInfo = null\n  const actionProperties = ((block.properties || {}).action || {})\n  const actionType = actionProperties.type\n  if (actionType === 'open_url') {\n    actionInfo = <>\n      <MdiIcon\n        path={mdiWeb}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{actionProperties.url}</p>\n    </>\n  } else if (actionType === 'render_block') {\n    actionInfo = <>\n      <MdiIcon\n        path={mdiApplicationOutline}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{actionProperties.blockId}</p>\n    </>\n  } else if (actionType === 'run_block') {\n    actionInfo = <>\n      <MdiIcon\n        path={mdiFileCode}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{actionProperties.blockId}</p>\n    </>\n  } else if (actionType === 'send_payload') {\n    actionInfo = <>\n      <MdiIcon\n        path={mdiCubeSend}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{actionProperties.blockId}</p>\n    </>\n  } else {\n    actionInfo = <>\n      <MdiIcon\n        path={mdiRayStartArrow}\n        size={1}\n        className={classes.icon}\n      />\n      <p>{\n        Object.keys(actionProperties).length > 0\n        ? JSON.stringify(actionProperties)\n        : null\n      }</p>\n    </>\n  }\n\n  return <div\n    onClick={actions.hasOwnProperty('click') ? actions.click : viewBlock}\n    className={`clickable_card ${classes.root}`}\n  >\n    <div>\n      {text !== '' ? <div dir=\"auto\" className={classes.title}>{text}</div> : null}\n      {description !== '' ? <p dir=\"auto\">{description}</p> : null}\n\n      {triggerInfo !== null ? <div className={classes.iconLine}>{triggerInfo}</div> : null}\n      {actionInfo !== null ? <div className={classes.iconLine}>{actionInfo}</div> : null}\n\n    </div>\n  </div>\n}\n\nexport default ViewerActionCard\n","import React from 'react'\n\nimport ViewerHeadlineCard from './ViewerHeadlineCard.js'\nimport ViewerTextCard from './ViewerTextCard.js'\nimport ViewerButtonCard from './ViewerButtonCard.js'\nimport ViewerDividerCard from './ViewerDividerCard.js'\nimport ViewerCheckboxCard from './ViewerCheckboxCard.js'\nimport ViewerPageLine from './ViewerPageLine.js'\nimport ViewerPageCard from './ViewerPageCard.js'\nimport ViewerPersonCard from './ViewerPersonCard.js'\nimport ViewerActionCard from './ViewerActionCard.js'\n\nimport classes from './ViewerAuto.module.css'\n\nfunction ViewerAuto ({ block = {}, actions = {}, size = 'card', style, ...props }) {\n  let component = null\n\n  const type = block.type || null\n\n  switch (type) {\n    case 'headline':\n      component = <ViewerHeadlineCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'text':\n      component = <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'button':\n      component = <ViewerButtonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'divider':\n      component = <ViewerDividerCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'checkbox':\n      component = <ViewerCheckboxCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'page':\n      switch (size) {\n        case 'line':\n          component = <ViewerPageLine key={block._id} block={block} actions={actions} {...props} />\n          break\n        default:\n          component = <ViewerPageCard key={block._id} block={block} actions={actions} {...props} />\n      }\n      break\n    case 'person':\n      component = <ViewerPersonCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    case 'action':\n      component = <ViewerActionCard key={block._id} block={block} actions={actions} {...props} />\n      break\n    default:\n      component = JSON.stringify(block) // <ViewerTextCard key={block._id} block={block} actions={actions} {...props} />\n  }\n\n  return <div\n    key={block._id}\n    className={classes.root}\n    style={style}\n  >\n    {component}\n  </div>\n}\n\nexport default ViewerAuto\n","import { useEffect, useState, useCallback } from 'react'\nimport classes from './BlockTree.module.css'\n\nimport {\n  Collapse,\n} from '@mui/material'\n\nimport {\n  MoreHorizSharp as BlockMenuIcon,\n  ArrowDropDownSharp as ExpandLessIcon,\n  ArrowRightSharp as ExpandMoreIcon,\n} from '@mui/icons-material'\n\nimport { useQuery } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\nimport BlockMenu from './edit/BlockMenu.js'\nimport ViewerAuto from './view/ViewerAuto.js'\n\nconst checkIfArrayHasContent = level => !!level && Array.isArray(level) && level.length > 0\n\nfunction BlockRows ({\n  levels,\n  level,\n  createBlock,\n  onClick,\n  blockMenu,\n  filterBlockIds,\n}) {\n  if (!checkIfArrayHasContent(level)) {\n    return null\n  }\n\n  return level\n    .filter(block => (!filterBlockIds || filterBlockIds.length === 0) ? true : !filterBlockIds.includes(block._id))\n    .map(block => <BlockRow\n      key={block._id}\n      block={block}\n      levels={levels}\n      createBlock={createBlock}\n      onClick={onClick}\n      blockMenu={blockMenu}\n      filterBlockIds={filterBlockIds}\n    />)\n}\n\nfunction BlockRow ({\n  block,\n  levels,\n  createBlock,\n  onClick,\n  blockMenu,\n  filterBlockIds,\n}) {\n  // const navigate = useNavigate()\n\n  const [open, setOpen] = useState(false)\n\n  const handleExpandToggle = useCallback(() => {\n    setOpen(oldOpen => !oldOpen)\n  }, [setOpen])\n\n  const actions = {\n    click: () => {\n      onClick(block)\n      // navigate(`/view/${block._id}`)\n    }\n  }\n\n  const rowContent = <>\n    <ViewerAuto\n      size=\"line\"\n      block={block}\n      actions={actions}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n      }}\n    />\n\n    {\n      blockMenu === true\n      ? <div className={classes.blockRowActions}>\n          <BlockMenu\n            {...{\n              block,\n              createBlock,\n              // setType: saveType,\n            }}\n            trigger={props => (\n              <button\n                {...props}\n                className=\"text hasIcon\"\n                style={{\n                  margin: '0 0 0 var(--basis_x2)',\n                  padding: 'var(--basis) 0',\n                  flexShrink: '0',\n                }}\n              >\n                <BlockMenuIcon className=\"icon\" />\n              </button>\n            )}\n          />\n        </div>\n      : null\n    }\n  </>\n\n  const nextLevel = levels[block._id]\n  if (checkIfArrayHasContent(nextLevel)) {\n    return <>\n      <div style={{\n        display: 'flex',\n        minHeight: 'calc(6 * var(--basis))',\n      }}>\n        <button\n          className=\"text hasIcon\"\n          style={{\n            background: 'transparent',\n            margin: '0 calc(-0.8 * var(--basis)) 0 calc(-7 * var(--basis))',\n            padding: '0',\n            flexShrink: '0',\n          }}\n          onClick={handleExpandToggle}\n        >\n          {open ? <ExpandLessIcon className=\"icon\" /> : <ExpandMoreIcon className=\"icon\" />}\n        </button>\n\n        <div\n          key={block._id}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            flexDirection: 'row',\n            width: '100%',\n          }}\n          className={classes.blockRow}\n        >\n          {rowContent}\n        </div>\n      </div>\n      <div style={{\n        marginLeft: 'calc(6 * var(--basis))',\n      }}>\n        <Collapse in={open} timeout=\"auto\">\n          <BlockRows\n            levels={levels}\n            level={nextLevel}\n            createBlock={createBlock}\n            onClick={onClick}\n            blockMenu={blockMenu}\n            filterBlockIds={filterBlockIds}\n          />\n        </Collapse>\n      </div>\n    </>\n  } else {\n    return <div\n      key={block._id}\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        flexDirection: 'row',\n        marginLeft: 'calc(-2.5 * var(--basis))',\n        minHeight: 'calc(6 * var(--basis))',\n      }}\n      className={classes.blockRow}\n    >\n      {rowContent}\n    </div>\n  }\n}\n\nexport default function BlockTree ({\n  createBlock = ()=>{},\n  onClick = ()=>{},\n  blockMenu = false,\n  onGetRefetch = ()=>{},\n  types = ['page', 'person', 'action'],\n  filterBlockIds = [],\n}) {\n  const { data, refetch } = useQuery(getBlocks_Query, {\n    variables: {\n      types,\n     },\n  })\n\n  useEffect(() => {\n    refetch()\n  }, [ types, refetch ])\n\n  useEffect(() => {\n    onGetRefetch(refetch)\n  }, [ onGetRefetch, refetch ])\n\n  const blocks = data?.blocks || []\n\n  const levels = blocks.reduce((acc, block) => {\n    // compute parent based on content\n    const parentId = blocks.find(possibleParentBlock => possibleParentBlock.content.some(cc => cc.blockId === block._id))?._id || '_root'\n\n    if (!acc[parentId]) {\n      acc[parentId] = []\n    }\n    acc[parentId].push(block)\n    return acc\n  }, {})\n  // get levelKeys and sort by string values\n  const levelKeys = Object.keys(levels).sort((a, b) => a.localeCompare(b))\n\n  return <div style={{\n    marginLeft: 'calc(5 * var(--basis))',\n  }}>\n     {\n      blocks.length > 0\n        ? <BlockRows\n            levels={levels}\n            level={levels[levelKeys[0]]}\n            createBlock={createBlock}\n            onClick={onClick}\n            blockMenu={blockMenu}\n            filterBlockIds={filterBlockIds}\n          />\n        : null\n      }\n  </div>\n}\n","import { useState, useCallback, useRef } from 'react'\nimport classes from './SidebarContent.module.css'\n\nimport {\n  MenuList,\n  MenuItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n} from '@mui/material'\n\nimport {\n  MenuOpen as MenuOpenIcon,\n  Replay as RequeryIcon,\n  Add as AddIcon,\n  FilterList as FilterListIcon,\n\n  Email as ContactIcon,\n  GitHub as SourceCodeIcon,\n  Login as LoginIcon,\n  Logout as LogoutIcon,\n\n  // Search as SearchIcon,\n\n  InsertDriveFileSharp as PageIcon,\n  AutoAwesomeSharp as ActionIcon,\n  // LinkSharp as RedirectIcon,\n  PersonSharp as PersonIcon,\n  // Crop75Sharp as ButtonIcon,\n  // TitleSharp as HeadlineIcon,\n  // NotesSharp as TextIcon,\n  // Remove as DividerIcon,\n  // EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nimport useSaveBlock from '../hooks/useSaveBlock.js'\n\nimport { useNavigate, useMatch } from 'react-router-dom'\n\nimport { Localized } from '../fluent/Localized.js'\nimport useUser from '../hooks/useUser.js'\nimport { useSidebarContext } from './Sidebar.js'\nimport AddMenu from './edit/AddMenu.js'\nimport BlockTree from './BlockTree.js'\n\nimport PopoverMenu from './PopoverMenu.js'\n\nconst blockTypeIcons = {\n  page: <PageIcon />,\n  person: <PersonIcon />,\n  action: <ActionIcon />,\n}\n\nexport default function SidebarContent() {\n  const { loggedIn } = useUser()\n  const { toggleSidebar } = useSidebarContext()\n\n  const matchesStartpage = useMatch('/')\n\n  const refetchRef = useRef(null)\n  const refetch = refetchRef.current\n  const saveRefetchFunction = newRefetchFunction => {\n    refetchRef.current = newRefetchFunction\n  }\n\n  const [types, setTypes] = useState({\n    page: true,\n    person: true,\n    action: true,\n  })\n  const filteredTypes = Object.entries(types)\n    .filter(([, value]) => value === true)\n    .map(([key, ]) => key)\n\n  const saveBlock = useSaveBlock()\n  const navigate = useNavigate()\n\n  const createBlock = useCallback(newBlock => {\n    saveBlock(newBlock)\n      .then(gottenBlock => {\n        navigate(`/edit/${gottenBlock._id}`)\n      })\n      .catch(error => {\n        console.error(error)\n      })\n  }, [ saveBlock, navigate ])\n\n  const toggleType = useCallback(type2toggle => {\n    const newTypes = { ...types }\n    newTypes[type2toggle] = !newTypes[type2toggle]\n\n    setTypes(newTypes)\n    refetch()\n  }, [ types, setTypes, refetch ])\n\n  const viewBlock = useCallback(block => {\n    navigate(`/view/${block._id}`)\n  }, [ navigate ])\n\n  return <div className={classes.content}>\n    <header className={classes.header}>\n      <div className={classes.headerBar}>\n        {\n          matchesStartpage\n          ? <h1>Volt.Link</h1>\n          : <button onClick={toggleSidebar} className=\"text hasIcon\" style={{ margin: '0' }}>\n              <MenuOpenIcon className=\"icon\" />\n            </button>\n        }\n\n        <div>\n\n          <button className=\"text hasIcon\" onClick={() => refetch()}>\n            <RequeryIcon className=\"icon\" />\n            {/* <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>Reload</span> */}\n          </button>\n\n          <PopoverMenu\n            trigger={triggerProps => (\n              <button className=\"text hasIcon\" {...triggerProps}>\n                <FilterListIcon className=\"icon\" />\n                {/* <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>Filter</span> */}\n              </button>\n            )}\n          >\n            {/*\n              { value: 'page', icon: <PageIcon className=\"icon\"/>, title: getString('block_menu_type_label_plural_page') },\n              { value: 'person', icon: <PersonIcon className=\"icon\" />, title: getString('block_menu_type_label_plural_person') },\n              { value: 'action', icon: <ActionIcon className=\"icon\" />, title: getString('block_menu_type_label_plural_action') },\n            */}\n\n            <div style={{ marginTop: '8px' }}></div>\n\n            {\n              Object.keys(types)\n                .map(type => (\n                  <MenuItem\n                    key={type}\n                    onClick={() => toggleType(type)}\n                    selected={filteredTypes.includes(type)}\n                  >\n                    <ListItemIcon>\n                      {blockTypeIcons[type]}\n                    </ListItemIcon>\n                    <ListItemText>\n                      <Localized id={'block_menu_type_label_plural_'+type} />\n                    </ListItemText>\n                  </MenuItem>\n                ))\n            }\n\n          </PopoverMenu>\n\n          <AddMenu\n            trigger={triggerProps => (\n              <button className=\"white hasIcon\" {...triggerProps}>\n                <AddIcon className=\"icon\" />\n                {/* <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>Add</span> */}\n              </button>\n            )}\n            createBlock={createBlock}\n          />\n        </div>\n      </div>\n    </header>\n\n      <BlockTree\n        onClick={viewBlock}\n        createBlock={createBlock}\n        blockMenu={true}\n        onGetRefetch={saveRefetchFunction}\n        types={filteredTypes}\n      />\n\n      <br/>\n      <Divider style={{ opacity: 0.2 }} />\n      <br/>\n\n      <MenuList style={{ maxWidth: '100%' }}>\n\n        {\n          loggedIn\n            ? <a href={`${window.domains.backend}logout?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n                <MenuItem>\n                  <ListItemIcon>\n                    <LogoutIcon />\n                  </ListItemIcon>\n                  <ListItemText primary={<Localized id=\"logout\" />} />\n                </MenuItem>\n              </a>\n            : <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n                <MenuItem>\n                  <ListItemIcon>\n                    <LoginIcon />\n                  </ListItemIcon>\n                  <ListItemText primary={<Localized id=\"login\" />} />\n                </MenuItem>\n              </a>\n        }\n\n        <a href=\"mailto:thomas.rosen@volteuropa.org\">\n          <MenuItem>\n            <ListItemIcon>\n              <ContactIcon />\n            </ListItemIcon>\n            <ListItemText primary={<Localized id=\"contact\" />} />\n          </MenuItem>\n        </a>\n\n        <a href=\"https://github.com/voltbonn/edit.volt.link\" target=\"_blank\" rel=\"noopener noreferrer\">\n          <MenuItem>\n            <ListItemIcon>\n              <SourceCodeIcon />\n            </ListItemIcon>\n            <ListItemText primary={<Localized id=\"source_code\" />} />\n          </MenuItem>\n        </a>\n\n      </MenuList>\n\n  </div>\n}\n","import React, {\n  useState,\n  useCallback,\n  createContext,\n  useContext,\n} from 'react'\n\nimport {\n  SwipeableDrawer,\n} from '@mui/material'\n\nimport { useMatch } from 'react-router-dom'\n\nimport useMediaQuery from '../hooks/useMediaQuery.js'\nimport SidebarContent from './SidebarContent.js'\n\nimport classes from './Sidebar.module.css'\n\nconst SidebarContext = createContext({})\n\nfunction useSidebarContext() {\n  return useContext(SidebarContext)\n}\n\nfunction SidebarProvider({ children }) {\n  const [open, setOpen] = useState(false)\n\n  const matchesStartpage = useMatch('/')\n  const realOpen = matchesStartpage ? false : open\n\n  const toggleSidebar = useCallback(() => {\n    setOpen(oldOpen => !oldOpen)\n  }, [ setOpen ])\n\n  return (\n    <SidebarContext.Provider value={{\n      open: realOpen,\n      setOpen,\n      toggleSidebar,\n    }}>\n      {children}\n    </SidebarContext.Provider>\n  )\n}\n\nconst sidebarWidth = 320\n\nfunction Sidebar() {\n  const { open, toggleSidebar } = useSidebarContext()\n\n  const iOS = (typeof navigator !== 'undefined' && /iPad|iPhone|iPod/.test(navigator.userAgent))\n  const isDesktop = useMediaQuery('(min-width: 960px)')\n\n  if (open) {\n    return <SwipeableDrawer\n      variant={isDesktop ? 'permanent' : 'temporary'}\n      anchor=\"left\"\n      open={open}\n      onOpen={toggleSidebar}\n      onClose={toggleSidebar}\n      disableBackdropTransition={!iOS}\n      disableDiscovery={iOS}\n      sx={{\n        width: sidebarWidth,\n        flexShrink: 0,\n        [`& .MuiDrawer-paper`]: {\n          width: sidebarWidth,\n          boxSizing: 'border-box',\n          backgroundColor: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n          border: 'none',\n        },\n      }}\n      PaperProps={{\n        sx: {\n          background: 'var(--background-contrast)',\n          color: 'var(--on-background)',\n        }\n      }}\n    >\n      <SidebarContent />\n    </SwipeableDrawer>\n  }\n\n  return null\n}\nfunction Main({ children }) {\n  const { open } = useSidebarContext()\n\n  return <main\n    className={`${classes.main} ${open ? classes.open : ''}`}\n    style={{\n      '--sidebarWidth': sidebarWidth+'px',\n    }}\n  >\n    {children}\n  </main>\n}\n\nexport {\n  SidebarContext,\n  useSidebarContext,\n  SidebarProvider,\n  SidebarContent,\n  Sidebar,\n  Main,\n}\n\n/*\n      <Drawer\n        variant={isDesktop ? 'permanent' : ''}\n        anchor=\"left\"\n        open={open}\n        sx={{\n          width: drawerWidth,\n          flexShrink: 0,\n          [`& .MuiDrawer-paper`]: {\n            width: drawerWidth,\n            boxSizing: 'border-box',\n            backgroundColor: 'var(--background)',\n            color: 'var(--on-background)',\n          },\n        }}\n        PaperProps={{\n          sx: {\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }\n        }}\n      >\n        <Sidebar />\n      </Drawer>\n      */\n","import { useState, useCallback, useEffect } from 'react'\n\nimport classes from './Header.module.css'\n\nimport {\n  Menu as MenuIcon,\n  MoreHoriz as MoreHorizIcon,\n  Home as HomeIcon,\n} from '@mui/icons-material'\n\nimport { Link } from 'react-router-dom'\n\nimport { useSidebarContext } from './Sidebar.js'\nimport ViewerAuto from './view/ViewerAuto.js'\nimport PopoverMenu from './PopoverMenu.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getSiblingBlocks_Query, getParentBlocks_Query } from '../graphql/queries'\n\nexport default function Header({ title, block = {}, rightActions, notificationBanner }) {\n  const { open, toggleSidebar } = useSidebarContext()\n  const apollo_client = useApolloClient()\n\n  const blockId = block ? block._id : null\n\n  const [parentBlocks, setParentBlocks] = useState([])\n  const [siblingBlocks, setSiblingBlocks] = useState([])\n\n  const loadParentBlocks = useCallback(blockId => {\n    apollo_client.query({\n      query: getParentBlocks_Query,\n      variables: {\n        _id: blockId,\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.parentBlocks) {\n          console.error(data.error)\n          setParentBlocks([])\n        }else{\n          setParentBlocks(data.parentBlocks || [])\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setParentBlocks([])\n      })\n  }, [apollo_client, setParentBlocks])\n\n  const loadSiblingBlocks = useCallback(blockId => {\n    apollo_client.query({\n      query: getSiblingBlocks_Query,\n      variables: {\n        _id: blockId,\n        types: ['page', 'person', 'action'],\n      },\n    })\n      .then(async ({ data }) => {\n        if (typeof data.error === 'string' || !data.siblingBlocks) {\n          console.error(data.error)\n          setSiblingBlocks([])\n        }else{\n          setSiblingBlocks(\n            (data.siblingBlocks || [])\n              .filter(block => block._id !== blockId)\n          )\n        }\n      })\n      .catch(async error => {\n        console.error('error', error)\n        setSiblingBlocks([])\n      })\n  }, [apollo_client, setSiblingBlocks])\n\n  useEffect(() => {\n    if (blockId) {\n      loadParentBlocks(blockId)\n      loadSiblingBlocks(blockId)\n    }\n  }, [blockId, loadParentBlocks, loadSiblingBlocks])\n\n  const leftActions = <>\n    {\n      !open\n      ? <button onClick={toggleSidebar} className=\"text hasIcon\" style={{ margin: '0' }}>\n          <MenuIcon className=\"icon\" />\n        </button>\n      : null\n    }\n\n    <div style={{ flexGrow: '1' }}>\n      <Link to=\"/\">\n        <button className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n          <HomeIcon style={{ verticalAlign: 'middle' }} />\n        </button>\n      </Link>\n      <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n\n    {\n      blockId\n      && parentBlocks.length > 0\n        ? <>\n          <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <MoreHorizIcon style={{ verticalAlign: 'middle' }} />\n              </button>\n            )}\n          >\n            {\n              parentBlocks\n              .map((block) => {\n                return <ViewerAuto\n                  key={block._id}\n                  block={block}\n                  size=\"line\"\n                  style={{\n                    margin: 'var(--basis_x4) var(--basis_x2)',\n                  }}\n                />\n              })\n            }\n          </PopoverMenu>\n          <span style={{ margin: 'var(--basis_x2)', opacity: 'var(--alpha)' }}>/</span>\n        </>\n        : null\n    }\n\n    {\n      siblingBlocks.length > 0\n        ? <PopoverMenu\n            trigger={triggerProps => (\n              <button {...triggerProps} className=\"text\" style={{ margin: 'calc(-2 * var(--basis))' }}>\n                <span style={{ fontWeight: 'bold' }}>\n                  {title}\n                </span>\n              </button>\n            )}\n          >\n            {\n              siblingBlocks\n              .map((block) => {\n                return <ViewerAuto\n                  key={block._id}\n                  block={block}\n                  size=\"line\"\n                  style={{\n                    margin: 'var(--basis_x4) var(--basis_x2)',\n                  }}\n                />\n              })\n            }\n          </PopoverMenu>\n        : <span style={{ fontWeight: 'bold' }}>\n            {title}\n          </span>\n    }\n    </div>\n  </>\n\n  return <header className={classes.header}>\n    <div className={classes.headerBar}>\n      {leftActions}\n      {rightActions}\n    </div>\n    {\n      !!notificationBanner\n        ? <div className={classes.notificationBanner}>{notificationBanner}</div>\n        : null\n    }\n  </header>\n}\n","import { useCallback, useState } from 'react'\n\nconst url_regex = /^([A-Z0-9+-.]+:(?:\\/\\/)?)[\\w\\u00C0-\\u00FF_.-]+(?:\\.[\\w\\u00C0-\\u00FF_.-]+)+[\\w\\u00C0-\\u00FF_~:/?#[\\]!%$&'()@*+,;=.-]+$/gui\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui\nconst is_email_not_url_regex = /^[^:/]+@.+$/gui\n\nfunction UrlInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  onError,\n  placeholder = 'https://',\n  style,\n  className\n}) {\n  const [text, setText] = useState(defaultValue)\n\n  const handleTextChange = useCallback((event) => {\n    const value = event.target.value || ''\n    // let isSubmittable = false\n    let error = ''\n\n    if (value !== '') {\n      const schema_parts = value.split(':')\n      const schema = schema_parts.shift()\n      const after_schema = schema_parts.join(':')\n\n      if (schema === 'tel') {\n        // isSubmittable = true\n      } else if (schema === 'mailto' || value.match(is_email_not_url_regex)) {\n        if (after_schema.match(email_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_mailto_url'\n        }\n      } else {\n        if (value.match(url_regex)) {\n          // isSubmittable = true\n        } else {\n          error = 'invalid_url'\n        }\n      }\n    }\n\n    if (onChange) {\n      onChange(value)\n    }\n\n    if (onError) {\n      onError(error)\n    }\n\n    setText(value)\n  }, [onChange, onError])\n\n  const handleBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  return <input\n    type=\"url\"\n    onChange={handleTextChange}\n    onBlur={handleBlur}\n    defaultValue={defaultValue}\n    placeholder={placeholder}\n    style={style}\n    className={className}\n  />\n}\n\nexport default UrlInput\n","import { useState } from 'react'\n\nimport { Localized } from '../../fluent/Localized.js'\nimport classes from './FancyInput.module.css'\n\nfunction FancyInput({ children, className, style, ...props }) {\n  const [error, setError] = useState('')\n\n  return <div\n    className={className}\n    style={style}\n  >\n    {children({ setError })}\n    {error ? <div className={classes.error}><Localized id={'error_'+error} /></div> : null}\n  </div>\n}\n\nexport default FancyInput\n","import React, { useState, useCallback } from 'react'\nimport classes from './Shortcode.module.css'\n\nimport { useNavigate } from 'react-router-dom'\n\nimport { withLocalization, Localized } from '../fluent/Localized.js'\nimport useKeyPress from '../hooks/useKeyPress.js'\nimport Header from '../components/Header.js'\nimport UrlInput from '../components/edit/UrlInput.js'\nimport FancyInput from '../components/edit/FancyInput.js'\n\nfunction Redirect({ getString, rightHeaderActions }) {\n  const navigate = useNavigate()\n  const [redirectLink, setRedirectLink] = useState('')\n  const [isSubmittable, setIsSubmittable] = useState(false)\n  const [error, setError] = useState('')\n\n  useKeyPress(['Enter'], () => {\n    if (isSubmittable) {\n      generateRedirectLink()\n    }\n  })\n\n  const handleRedirectLink = useCallback(value => {\n    setRedirectLink(value)\n\n    if (value === '') {\n      setIsSubmittable(false)\n    } else {\n      setIsSubmittable(true)\n    }\n  }, [setRedirectLink, setIsSubmittable])\n\n  const generateRedirectLink = useCallback(() => {\n    if (isSubmittable) {\n      const data = {\n        use_as: 'redirect',\n        redirect: redirectLink,\n      }\n\n      fetch(`${window.domains.backend}set_redirect`, {\n        mode: 'cors',\n        credentials: 'include',\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8'\n        },\n        body: JSON.stringify(data)\n      })\n        .then(r => r.json())\n        .then(async data => {\n          if (typeof data.error === 'string') {\n            console.error(data.error)\n            setError(data.error)\n          } else if (typeof data.code === 'string') {\n            navigate(`/edit/${data.code}`)\n          } else {\n            setError('Undefined Error. Please contact thomas.rosen@volteuropa.org')\n          }\n        })\n        .catch(async error => {\n          console.error(error)\n          setError(error)\n        })\n    }\n  }, [isSubmittable, redirectLink, navigate])\n\n  return <div>\n    <Header\n      title={<Localized id=\"create_shortcode_headline\" />}\n      rightActions={rightHeaderActions || null}\n    />\n\n    <p><Localized id=\"create_shortcode_info\" /></p>\n\n    <div className={`${classes.input} ${isSubmittable === true ? '' : classes.hideSubmitButton }`}>\n      <FancyInput\n        style={{ flexGrow: '1', display: 'flex', flexDirection: 'column' }}\n      >\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            placeholder={getString('create_shortcode_url_placeholder')}\n            onChange={handleRedirectLink}\n          />\n        )}\n      </FancyInput>\n      {\n        isSubmittable === true\n          ? <button className=\"green\" onClick={generateRedirectLink}>\n              <Localized id=\"create_shortcode_url_submit\" />\n            </button>\n          : null\n      }\n    </div>\n\n    {\n      error !== ''\n        ? <>\n          <h3 className=\"red\"><Localized id=\"headline_errors\" /></h3>\n          <p>{error}</p>\n        </>\n        : null\n    }\n  </div>\n}\n\nexport default withLocalization(Redirect)\n","import { useEffect } from 'react'\n\nexport default function useKeyPress(keys, callback) {\n  useEffect(() => {\n    function onKeyup(event) {\n      if (keys.includes(event.key)) {\n        callback(event)\n      }\n    }\n    window.addEventListener('keyup', onKeyup)\n    return () => window.removeEventListener('keyup', onKeyup)\n  }, [keys, callback])\n}\n","import { useCallback } from 'react'\n\nimport { useLocalization } from '../fluent/Localized.js'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlock_Query } from '../graphql/queries'\n\nimport { useSnackbar } from 'notistack'\n\nfunction useLoadBlock() {\n  const { getString } = useLocalization()\n\n  const apollo_client = useApolloClient()\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const handleLoadBlock = useCallback(_id => {\n    return new Promise(final_resolve => {\n    let snackbarKey = null\n\n    if (!_id || _id === '') {\n      final_resolve({\n        type: 'text',\n      })\n    } else {\n      const loadingDataPromise = new Promise(resolve => {\n        apollo_client.query({\n          query: getBlock_Query,\n          variables: {\n            _id,\n          },\n        })\n          .then(async ({ data }) => {\n            resolve('got-data')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            if (typeof data.error === 'string' || !data.block) {\n              if (data.error === 'no_edit_permission') {\n                enqueueSnackbar(getString('path_editor_edit_permission_error'), {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              } else {\n                enqueueSnackbar('' + data.error, {\n                  variant: 'error',\n                  preventDuplicate: true,\n                  autoHideDuration: 5000,\n                })\n              }\n            }else{\n              const loadedBlock = data.block\n              final_resolve(loadedBlock)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve('got-error')\n\n            if (snackbarKey !== null) {\n              closeSnackbar(snackbarKey)\n            }\n\n            enqueueSnackbar('[could not load data] '+error.message, {\n              variant: 'error',\n              preventDuplicate: true,\n              autoHideDuration: 2000,\n            })\n          })\n      })\n\n      // Show a loading-info-snackbar if loading the data takes too long.\n      Promise.race([\n        new Promise(resolve => {\n          setTimeout(() => {\n            resolve('show-loading')\n          }, 300)\n        }),\n        loadingDataPromise,\n      ])\n        .then(response => {\n          if (response === 'show-loading') {\n            snackbarKey = enqueueSnackbar(getString('path_editor_status_started_loading'), {\n              persist: true,\n              preventDuplicate: true,\n            })\n          }\n        })\n        .catch(error => console.error)\n    }\n    })\n  }, [\n    enqueueSnackbar,\n    closeSnackbar,\n    apollo_client,\n    getString,\n  ])\n\n  return handleLoadBlock\n}\n\nexport default useLoadBlock\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { blockMatchesRoles_Query } from '../graphql/queries'\n\nexport default function useBlockMatchesRoles() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadRoles = useCallback((_id, roles = []) => {\n    return new Promise(resolve => {\n      if (!_id || _id === '') {\n        resolve(false)\n      } else {\n        apollo_client.query({\n          query: blockMatchesRoles_Query,\n          variables: {\n            _id,\n            roles,\n          },\n        })\n          .then(async ({ data }) => {\n            if (data.hasOwnProperty('blockMatchesRoles')) {\n              resolve(data.blockMatchesRoles)\n            }else{\n              resolve(false)\n            }\n          })\n          .catch(async error => {\n            console.error('error', error)\n            resolve(false)\n          })\n      }\n    })\n  }, [ apollo_client ])\n\n  return handleLoadRoles\n}\n","import React, { useCallback, useRef, useState, useEffect } from 'react'\n\n// import hljs from 'highlight.js/lib/core'\n// import javascript from 'highlight.js/lib/languages/javascript'\n// // import 'highlight.js/styles/github.css'\n// import '../../highlightjs-volt-theme.css'\n\nimport {\n  offset as getCaretOffset,\n  getOffset,\n} from 'caret-pos'\n\nimport classes from './HtmlInput.module.css'\n\n// hljs.registerLanguage('javascript', javascript)\n\nfunction stripHtml(html){\n  // source: https://ourcodeworld.com/articles/read/376/how-to-strip-html-from-a-string-extract-only-text-content-in-javascript\n  // Create a new div element\n  var temporalDivElement = document.createElement(\"div\");\n  // Set the HTML content with the providen\n  temporalDivElement.innerHTML = html;\n  // Retrieve the text property of the element (cross-browser support)\n  return temporalDivElement.textContent || temporalDivElement.innerText || \"\";\n}\n\nfunction getRangeLengthWithLinebreaks(element){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  for (const node of content.childNodes) {\n    if (node.nodeType === 3) { // node type = 3 is a text node\n      rangeLength += node.textContent.length\n    } else if (node.nodeType === 1 && node.nodeName === 'BR') { // node type = 1 is an element node\n      rangeLength += 1\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getInLineRangeLength(element, whichLine){\n  element.normalize()\n\n  if (!window.getSelection) {\n    return 0;\n  }\n\n  const selection = window.getSelection()\n  const range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\n  if (!range) {\n    return 0;\n  }\n\n  const clonedRange = range.cloneRange()\n  clonedRange.selectNodeContents(element)\n  clonedRange.setEnd(range.endContainer, range.endOffset)\n  const content = clonedRange.cloneContents()\n\n  let rangeLength = 0\n  if (content.childNodes.length > 0) {\n    if (whichLine === 'first') {\n      if (content.childNodes[0].nodeType === 3) {\n        rangeLength = content.childNodes[0].length\n      } else {\n        rangeLength = 0\n      }\n    } else if (whichLine === 'last') {\n      if (content.childNodes[content.childNodes.length-1].nodeType === 3) {\n        rangeLength = content.childNodes[content.childNodes.length-1].length\n      } else {\n        if (content.childNodes.length > 1) {\n          if (content.childNodes[content.childNodes.length-2].nodeType === 3) {\n            rangeLength = content.childNodes[content.childNodes.length-2].length\n          } else {\n            rangeLength = 0\n          }\n        } else {\n          rangeLength = 0\n        }\n      }\n    }\n  }\n\n  clonedRange.detach()\n\n  return rangeLength\n}\n\nfunction getCaretPosition(element){\n  // get element height without padding and border\n  const cs = getComputedStyle(element)\n  const paddingY = parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom)\n  const borderY = parseFloat(cs.borderTopWidth) + parseFloat(cs.borderBottomWidth)\n  const elementHeight = element.offsetHeight - paddingY - borderY\n\n  // get caret position\n  const offset = getOffset(element)\n  const caretOffset = getCaretOffset(element)\n  caretOffset.top = caretOffset.top - offset.top\n  caretOffset.left = caretOffset.left - offset.left\n\n  // check if caret is in the first line\n  let inFirstLine = caretOffset.top < caretOffset.height\n\n  // check if caret is in the last line\n  let inLastLine = elementHeight - caretOffset.top < caretOffset.height\n\n  // define caret position from start of text\n  const caretPositionFromStart = getRangeLengthWithLinebreaks(element)\n\n  // calc caret position from end of text\n  let textLength = element.innerText.length || 0\n  if (textLength < 0) {\n    textLength = 0\n  }\n  const caretPositionFromEnd = textLength - caretPositionFromStart\n\n  return {\n    inFirstLine,\n    inLastLine,\n    left: caretOffset.left,\n    top: caretOffset.top,\n    height: caretOffset.height,\n    positionFromLineStart: getInLineRangeLength(element, (inFirstLine ? 'first' : 'last')),\n    positionFromStart: caretPositionFromStart,\n    positionFromEnd: caretPositionFromEnd,\n  }\n}\n\nfunction HtmlInput({\n  type = 'text',\n  defaultValue = '',\n  children,\n  className,\n  onChange,\n  onBlur,\n  onError,\n  linebreaks,\n  style,\n  placeholder = '',\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  ...props\n}) {\n  const inputRef = useRef(null)\n  const [text, setText] = useState('')\n  const [fakeDefaultValue, setFakeDefaultValue] = useState({ __html: '' })\n\n  const updateText = useCallback(defaultValue => {\n\n    let newHtmlValue = stripHtml(defaultValue)\n\n    // if (type === 'code') {\n    //   // const html = hljs.highlightAuto(newHtmlValue, { ignoreIllegals: false })\n    //   const html = hljs.highlight(newHtmlValue, { language: 'javascript', ignoreIllegals: false })\n    //   newHtmlValue = html.value\n    // // } else {\n    // //   newHtmlValue = newHtmlValue\n    // //     // .replace(/\\t/g, '&emsp;')\n    // //     .replace(/</g, '&lt;')\n    // //     .replace(/>/g, '&gt;')\n    // //     // .replace(/\\n/g, '<br />')\n    // }\n\n    if (fakeDefaultValue.__html !== newHtmlValue) {\n      return setFakeDefaultValue({__html: newHtmlValue})\n    }\n\n    setText(defaultValue)\n  }, [\n    // type,\n    fakeDefaultValue,\n    setText,\n    setFakeDefaultValue,\n  ])\n\n  useEffect(() => {\n    if (text !== defaultValue) {\n      updateText(defaultValue)\n    }\n  }, [\n    text,\n    defaultValue,\n    updateText,\n  ])\n\n  const handleTextChange = useCallback((event) => {\n    let value = event.target.innerHTML || ''\n    // .replace(/&emsp;/g, '\\t')\n    // .replace(/&lt;/g, '<')\n    // .replace(/&gt;/g, '>')\n\n    if (linebreaks === false) {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, ' ')\n    } else {\n      value = value.replace(/<\\/? ?br ?\\/?>/g, '\\n')\n    }\n\n    value = value.trim()\n    setText(value)\n\n    if (onChange) {\n      onChange(value)\n    }\n  }, [onChange, setText, linebreaks])\n\n  const handleTextBlur = useCallback(() => {\n    if (onBlur) {\n      onBlur(text)\n    }\n  }, [onBlur, text])\n\n  const keyDownHandler = useCallback(event => {\n    if (event.key === 'Enter' && event.shiftKey === true) {\n      // source: StackOverflow (https://stackoverflow.com/a/61237402)\n      if (linebreaks !== false) {\n        document.execCommand('insertLineBreak')\n      }\n      event.preventDefault()\n    } else if (event.key === 'Tab') {\n      document.execCommand('insertText', false, '\\t')\n      event.preventDefault()\n    } else if (event.key === 'ArrowUp') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine) {\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowLeft') {\n      if (onGoToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inFirstLine && caret.positionFromStart <= 0) {\n          caret.positionFromLineStart = -1\n          onGoToPrevInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowDown') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine) {\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'ArrowRight') {\n      if (onGoToNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.inLastLine && caret.positionFromEnd <= 1) {\n          caret.positionFromLineStart = 0\n          onGoToNextInput({ caret })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Enter') {\n      if (type === 'code') {\n        if (linebreaks !== false) {\n          document.execCommand('insertLineBreak')\n        }\n        event.preventDefault()\n      } else {\n        if (onSplitText) {\n          const caret = getCaretPosition(inputRef.current)\n\n          const innerText = inputRef.current.innerText\n          const start = innerText.slice(0, caret.positionFromStart)\n          const end = innerText.slice(caret.positionFromStart)\n\n          onSplitText({\n            texts: [start, end],\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Backspace') {\n      if (onMergeToPrevInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromStart === 0 && caret.inFirstLine) {\n          onMergeToPrevInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    } else if (event.key === 'Delete') {\n      if (onMergeFromNextInput) {\n        const caret = getCaretPosition(inputRef.current)\n        if (caret.positionFromEnd === 0 && caret.inLastLine) {\n          onMergeFromNextInput({\n            caret,\n            text: inputRef.current.innerText,\n          })\n          event.preventDefault()\n        }\n      }\n    }\n  }, [\n    inputRef,\n    linebreaks,\n    onGoToPrevInput,\n    onGoToNextInput,\n    onSplitText,\n    onMergeToPrevInput,\n    onMergeFromNextInput,\n    type,\n  ])\n\n  useEffect(() => {\n    if (onInputRef) {\n      onInputRef(inputRef)\n    }\n  }, [onInputRef, inputRef])\n\n  const handlePaste = useCallback(event => {\n    // only accept plain text\n\n    // cancel paste\n    event.preventDefault()\n\n    // get text representation of clipboard\n    let text = (event.originalEvent || event).clipboardData.getData('text/plain')\n\n    if (linebreaks === false) {\n      text = text.replace(/\\n/g, ' ')\n    }\n\n    // insert text manually\n    document.execCommand('insertText', false, text)\n  }, [linebreaks])\n\n  // const highlighted = hljs.highlightAuto(text, { ignoreIllegals: true })\n  // language\n  //   ? hljs.highlight(language, content)\n  //   : hljs.highlightAuto(content)\n\n  return <>\n  <div\n    ref={inputRef}\n    onKeyDown={keyDownHandler}\n    onInput={handleTextChange}\n    onBlur={handleTextBlur}\n    onPaste={handlePaste}\n    className={`${classes.rebuild_textarea} ${text.length === 0 ? classes.show_placeholder : ''} ${className}`}\n    contentEditable={true}\n    dangerouslySetInnerHTML={fakeDefaultValue}\n    style={style}\n    placeholder={placeholder}\n  />\n    {/* <pre className=\"hljs\">\n      <code dangerouslySetInnerHTML={{ __html: highlighted.value }} />\n    </pre> */}\n  </>\n}\n\nexport default HtmlInput\n","import React, { useEffect, useState, useCallback } from 'react'\n\nimport {\n  Modal,\n} from '@mui/material'\nimport {\n  QrCodeSharp as QrCodeIcon,\n  AssessmentSharp as AssessmentIcon,\n  ContentCopySharp as CopyIcon,\n} from '@mui/icons-material'\n\nimport { Localized } from '../../fluent/Localized.js' // useLocalization\n\nimport classes from './SharingEditor.module.css'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction fallbackCopyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  var textArea = document.createElement(\"textarea\");\n  textArea.value = text;\n\n  // Avoid scrolling to bottom\n  textArea.style.top = \"0\";\n  textArea.style.left = \"0\";\n  textArea.style.position = \"fixed\";\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  try {\n    var successful = document.execCommand('copy');\n    var msg = successful ? 'successful' : 'unsuccessful';\n    console.info('Fallback: Copying text command was ' + msg);\n  } catch (err) {\n    console.error('Fallback: Oops, unable to copy', err);\n  }\n\n  document.body.removeChild(textArea);\n}\n\nfunction copyTextToClipboard(text) {\n  // Source: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  if (!navigator.clipboard) {\n    fallbackCopyTextToClipboard(text);\n    return;\n  }\n  navigator.clipboard.writeText(text).then(function() {\n    console.info('Async: Copying to clipboard was successful!');\n  }, function(err) {\n    console.error('Async: Could not copy text: ', err);\n  });\n}\n\nfunction SharingEditor({\n  defaultBlock = {},\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const [ path, setPath ] = useState('')\n\n  useEffect(() => {\n    const properties = defaultBlock.properties || {}\n    const initialPath = (properties.trigger || {}).path || ''\n\n    setPath(initialPath)\n  }, [ defaultBlock, setPath ])\n\n  const savePath = useCallback(newPath => {\n    const newProperties = {...(defaultBlock.properties || {})}\n\n    if (newPath === '') {\n      if (newProperties.hasOwnProperty('trigger')) {\n        delete newProperties.trigger\n      }\n      if (newProperties.hasOwnProperty('action')) {\n        delete newProperties.action\n      }\n    } else {\n      newProperties.trigger = {\n\t\t  \ttype: 'path',\n\t\t  \tpath: newPath,\n\t\t  }\n\t\t  newProperties.action = {\n\t\t  \ttype: 'render_block',\n\t\t  }\n    }\n\n    setPath(newPath)\n    onChange(newProperties)\n  }, [\n    defaultBlock,\n    onChange,\n    setPath,\n  ])\n\n  const viewStatistics = () => {\n    const a = document.createElement('a')\n    a.href = `https://umami.qiekub.org/share/s0ZHBZbb/volt.link?url=%2F${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const gotoQrcodePage = () => {\n    const a = document.createElement('a')\n    a.href = `https://qrcode.volt.link/?c=volt.link/${path}`\n    a.target = '_blank'\n    a.rel = 'noreferrer'\n    a.click()\n  }\n\n  const copyUrl = () => {\n    copyTextToClipboard(`https://volt.link/${path}`)\n  }\n\n  if (!open) {\n    return null\n  }\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n      // BackdropComponent={<Backdrop open={true} className={classes.backdrop} />}\n      // aria-labelledby=\"modal-modal-title\"\n      // aria-describedby=\"modal-modal-description\"\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialog}>\n\n            <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>Share the link</h1>\n            {/* <p>Enter @volteuropa.org addresses to give editing rights.<br/>Groups addresses are not supported.</p> */}\n\n            {/* <hr style={{ opacity: 0.2 }} /> */}\n\n            <div className={classes.inputWrapper}>\n             <span style={{ paddingRight: 'var(--basis)' }}>volt.link/</span>\n             <HtmlInput\n                defaultValue={path}\n                onBlur={savePath}\n                linebreak={false}\n                className={classes.input}\n                style={{ margin: '0' }}\n              />\n            </div>\n\n            <hr style={{ opacity: 0.2 }} />\n\n            <div className={classes.actions}>\n              {\n                path !== ''\n                ? <div>\n                    <button className=\"text hasIcon\" onClick={gotoQrcodePage} style={{ marginInlineStart: '0' }}>\n                      <QrCodeIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_qrcode\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={viewStatistics}>\n                      <AssessmentIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_statistics\" /></span>\n                    </button>\n                    <button className=\"text hasIcon\" onClick={copyUrl}>\n                      <CopyIcon className=\"icon\" />\n                      <span className=\"hideOnSmallScreen\"><Localized id=\"sharing_copy_url\" /></span>\n                    </button>\n                  </div>\n                : <div></div>\n              }\n\n              <button onClick={onClose} className=\"green\" style={{ marginInlineEnd: '0' }}>Done</button>\n            </div>\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default SharingEditor\n","import { useCallback } from 'react'\n\nconst email_regex = /^(?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?)$/gui // is surrounded by start and end tags\nconst emails_regex = /((?:(?:[^<>()[\\]\\\\.,;:\\s@\"]+(?:\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(?:\".+\"))@(?:(?:\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})|(?:(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,})\\.?))/gui // is surrounded by a group\n\nfunction EmailInput({ multiple = false, onChange, onError, ...props }) {\n  const handleTextChange = useCallback((event) => {\n    if (onChange || onError) {\n      let value = event.target.value || ''\n      let isSubmittable = false\n      let error = ''\n\n      if (value !== '') {\n        if (multiple === true) {\n          const emails = value.match(emails_regex)\n          if (emails) {\n            value = emails\n            isSubmittable = true\n          } else {\n            error = 'Invalid email(s) format'\n          }\n        } else {\n          if (value.match(email_regex)) {\n            isSubmittable = true\n          } else {\n            error = 'invalid_email'\n          }\n        }\n      }\n\n      if (onChange) {\n        if (isSubmittable) {\n          onChange(value)\n        } else {\n          if (multiple === true) {\n            onChange([])\n          } else {\n            onChange('')\n          }\n        }\n      }\n\n      if (onError) {\n        onError(error)\n      }\n    }\n  }, [multiple, onChange, onError])\n\n  return <input\n    type=\"email\"\n    onChange={handleTextChange}\n    {...props}\n  />\n}\n\nexport default EmailInput\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport {\n  Modal,\n  Menu,\n  MenuItem,\n  Divider,\n  ListItemIcon,\n  ListItemText,\n} from '@mui/material'\nimport {\n  KeyboardArrowDown as KeyboardArrowDownIcon,\n  Delete as DeleteIcon,\n  Close as CloseIcon,\n  Visibility as ViewerIcon,\n  Edit as EditorIcon,\n} from '@mui/icons-material'\nimport { v4 as uuidv4 } from 'uuid'\n\nimport { Localized, useLocalization } from '../../fluent/Localized.js'\n\nimport useUser from '../../hooks/useUser.js'\n\nimport FancyInput from './FancyInput.js'\nimport EmailInput from './EmailInput.js'\n\nimport classes from './PermissionsEditor.module.css'\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction LocalizedRole({ role }) {\n  return <Localized id={'role-'+role} />\n}\n\nfunction RolesMenu({\n  role,\n  trigger,\n  changeRole,\n  removePermission,\n}){\n  const [anchorEl, setAnchorEl] = React.useState(null)\n  const open = Boolean(anchorEl)\n  const handleOpen = event => {\n    setAnchorEl(event.currentTarget)\n  }\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  return <>\n    {trigger({\n      onClick: handleOpen,\n    })}\n\n    <Menu\n      anchorEl={anchorEl}\n      open={open}\n      onClose={handleClose}\n      MenuListProps={{\n        style: {\n          maxWidth: '100%',\n        },\n      }}\n    >\n        {\n          role === 'editor'\n          ? <MenuItem onClick={() => changeRole('viewer')}>\n              <ListItemIcon>\n                <ViewerIcon />\n              </ListItemIcon>\n              <ListItemText>\n                <LocalizedRole role=\"viewer\" />\n              </ListItemText>\n            </MenuItem>\n          : <MenuItem onClick={() => changeRole('editor')}>\n              <ListItemIcon>\n                <EditorIcon />\n              </ListItemIcon>\n              <ListItemText>\n                <LocalizedRole role=\"editor\" />\n              </ListItemText>\n            </MenuItem>\n        }\n\n        {\n          typeof removePermission === 'function'\n          ? <MenuItem onClick={removePermission}>\n              <ListItemIcon>\n                <DeleteIcon />\n              </ListItemIcon>\n              <ListItemText>\n                Remove\n              </ListItemText>\n            </MenuItem>\n          : null\n        }\n\n        <Divider style={{opacity: 0.2}} />\n\n        <MenuItem onClick={handleClose}>\n          <ListItemIcon>\n            <CloseIcon />\n          </ListItemIcon>\n          <ListItemText>\n            Close\n          </ListItemText>\n        </MenuItem>\n    </Menu>\n  </>\n}\n\nfunction sortPermissions(permissions) {\n  const owner = permissions\n    .filter(p => p.role === 'owner')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const special = permissions\n    .filter(p => p.email === '@volteuropa.org' || p.email === '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  const other = permissions\n    .filter(p => p.role !== 'owner' && p.email !== '@volteuropa.org' && p.email !== '@public')\n    .sort((a, b) => a.email.localeCompare(b.email))\n\n  return [\n    ...owner,\n    ...special,\n    ...other,\n  ]\n}\n\nfunction PermissionsEditor({\n  defaultPermissions,\n  open = false,\n  onChange,\n  onClose,\n}) {\n  const { getString } = useLocalization()\n\n  const { email: user_email = '' } = useUser()\n\n  const [inputRepaintKey, setInputRepaintKey] = useState(0)\n  const [permissions, setPermissions] = useState([])\n  const [newEmails, setNewEmails] = useState([])\n  const [newRole, setNewRole] = useState('editor')\n\n  const setNewPermission = useCallback(newPermissions => {\n    if (user_email !== '') {\n      newPermissions = addTmpIds(newPermissions || [])\n\n      const doesNotHaveOwner = newPermissions.filter(permission => permission.role === 'owner').length === 0\n      if (doesNotHaveOwner) {\n        newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n      }\n\n      setPermissions(newPermissions)\n    }\n  }, [ user_email, setPermissions ])\n\n  useEffect(() => {\n    if (Array.isArray(defaultPermissions)) {\n      setNewPermission(defaultPermissions)\n    } else {\n      setNewPermission([])\n    }\n  }, [ setNewPermission, defaultPermissions ])\n\n  const removePermission = useCallback(email => {\n    let newPermissions = permissions.filter(p => p.email !== email)\n    if (email === '@volteuropa.org') {\n      newPermissions = newPermissions.filter(p => p.email !== '@public')\n    }\n\n    const doesNotHaveOwner = permissions.filter(p => p.role === 'owner').length === 0\n    if (doesNotHaveOwner) {\n      newPermissions.unshift({ tmp_id: uuidv4(), email: user_email, role: 'owner' })\n    }\n\n    setPermissions(newPermissions)\n    onChange(newPermissions)\n  }, [permissions, user_email, setPermissions, onChange])\n\n  const changeRole = useCallback((email, newRole) => {\n    const newPermissions = permissions.map(permission => {\n      if (permission.email === email) {\n        return {\n          ...permission,\n          role: newRole,\n        }\n      }\n      return permission\n    })\n\n    setPermissions(newPermissions)\n    onChange(newPermissions)\n  }, [permissions, setPermissions, onChange])\n\n  const addPermissions = useCallback((newEmails, newRole) => {\n    if (newEmails.includes('@public')) {\n      newEmails.push('@volteuropa.org')\n    }\n    let newPermissions = permissions.filter(permission => !newEmails.includes(permission.email))\n    for (const newEmail of newEmails) {\n      newPermissions.unshift({ tmp_id: uuidv4(), email: newEmail, role: newRole })\n    }\n\n    setPermissions(newPermissions)\n    onChange(newPermissions)\n  }, [permissions, setPermissions, onChange])\n\n  const addNewPermissionFromInput = useCallback(() => {\n    addPermissions(newEmails, newRole)\n    setNewEmails([]) // reset the email-input | don't reset the role-input so it can be reused when entering multiple emails after each other // setNewRole('editor')\n    setInputRepaintKey(oldInputRepaintKey => oldInputRepaintKey + 1) // redraw the email-input\n  }, [ newEmails, newRole, addPermissions ])\n\n  if (!open) {\n    return null\n  }\n\n  const doesNotHaveVoltEuropa = permissions.filter(permission => permission.email === '@volteuropa.org').length === 0\n  const doesNotHavePublic = permissions.filter(permission => permission.email === '@public').length === 0\n\n  return (\n    <Modal\n      open={open}\n      onClose={onClose}\n      hideBackdrop={true}\n      // BackdropComponent={<Backdrop open={true} className={classes.backdrop} />}\n      // aria-labelledby=\"modal-modal-title\"\n      // aria-describedby=\"modal-modal-description\"\n    >\n      <>\n        <div className={classes.backdrop} onClick={onClose}></div>\n\n        <div className={classes.dialogsWrapper}>\n\n        <div className={classes.dialog}>\n          <h1 style={{ margin: '0 0 var(--basis_x4) 0' }}>Give viewing and editing rights</h1>\n          <p>Enter @volteuropa.org addresses to give editing rights.<br/>Groups addresses are not supported.</p>\n          <div className={classes.inputWrapper} key={inputRepaintKey}>\n            <FancyInput className={classes.emailInput}>\n              {({ setError }) => (\n                <EmailInput\n                  multiple={true}\n                  onError={setError}\n                  defaultValue=\"\"\n                  onChange={setNewEmails}\n                  aria-label={getString('path_editor_permissions_edit_label')}\n                  placeholder={getString('path_editor_permissions_edit_placeholder')}\n                  style={{\n                    flexGrow: '1',\n                    // margin: '0',\n                    margin: 'var(--basis) 0',\n                    width: 'calc(100% - var(--basis_x2))',\n                  }}\n                />\n              )}\n            </FancyInput>\n            <RolesMenu\n              role={newRole}\n              changeRole={setNewRole}\n              trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={newRole} /> <KeyboardArrowDownIcon/></button>}\n            />\n          </div>\n\n          {\n            newEmails.length > 0 && newEmails[0].length > 0\n            ? <>\n                <hr />\n\n                <div className={classes.actions}>\n                  <button onClick={addNewPermissionFromInput} className=\"green\" style={{margin: '0'}}>\n                    {\n                      newEmails.length > 1\n                      ? <>Add People</>\n                      : <>Add Person</>\n                    }\n                  </button>\n                </div>\n              </>\n            : <>\n                {\n                  doesNotHaveVoltEuropa || doesNotHavePublic\n                  ? <div style={{ marginTop: 'var(--basis_x2)' }}>\n                    Make visible for…\n                    {\n                      doesNotHaveVoltEuropa\n                      ? <button onClick={() => addPermissions(['@volteuropa.org'], 'viewer')}>Volt Europa</button>\n                      : null\n                    }\n                    {\n                      doesNotHavePublic\n                      ? <button onClick={() => addPermissions(['@public'], 'viewer')}>Public</button>\n                      : null\n                    }\n                  </div>\n                  : null\n                }\n\n                {\n                  permissions.length === 0\n                   ? null\n                   : <hr style={{ opacity: 0.2 }} />\n                }\n\n                {\n                  sortPermissions(permissions)\n                  .map(p => <div key={p.tmp_id} className={classes.permissionRow}>\n                    {\n                      p.email === '@public'\n                        ? <strong>Public</strong>\n                        : (\n                          p.email === '@volteuropa.org'\n                            ? <strong>Volt Europa</strong>\n                            : <span>{p.email}</span>\n                        )\n                    }\n\n                    {\n                      p.role === 'owner'\n                      ? <strong className={`type_button ${classes.ownerInfo}`}><LocalizedRole role={p.role} /></strong>\n                      : <RolesMenu\n                          role={p.role}\n                          removePermission={() => removePermission(p.email)}\n                          changeRole={(newRole) => changeRole(p.email, newRole)}\n                          trigger={triggerProps => <button className={classes.menuButton} {...triggerProps}><LocalizedRole role={p.role} /> <KeyboardArrowDownIcon/></button>}\n                        />\n                    }\n                  </div>)\n                }\n\n                <hr style={{ opacity: 0.2 }} />\n\n                <div className={classes.actions}>\n                  <button onClick={onClose} className=\"green\" style={{margin: '0'}}>Done</button>\n                </div>\n              </>\n          }\n        </div>\n\n        </div>\n      </>\n    </Modal>\n  )\n}\n\nexport default PermissionsEditor\n","import { useCallback, useState } from 'react'\n\nimport {\n  CheckBox as CheckBoxIcon,\n  CheckBoxOutlineBlank as CheckBoxOutlineBlankIcon,\n} from '@mui/icons-material'\n\nfunction CheckboxInput({\n  defaultValue = '',\n  onChange,\n  onBlur,\n  style,\n  className,\n  disabled = false,\n}) {\n  // TODO: make ARIA compatible\n\n  const [ checked, setChecked ] = useState(Boolean(defaultValue))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange(checked)\n    }\n    if (onBlur) {\n      onBlur(checked)\n    }\n  }, [ onChange, onBlur, checked ])\n\n  const checkBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(true)\n  }, [ disabled, publishChanges, setChecked ])\n\n  const uncheckBlock = useCallback(() => {\n    if (disabled === true) {\n      return\n    }\n    publishChanges()\n    setChecked(false)\n  }, [ disabled, publishChanges, setChecked ])\n\n  return <div\n    style={{\n      display: 'inline-block',\n      padding: 'var(--basis)',\n      cursor: disabled === true ? 'default' : 'pointer',\n      verticalAlign: 'middle',\n      ...style,\n    }}\n    className={className}\n  >\n    {\n      checked\n      ? <CheckBoxIcon onClick={uncheckBlock} />\n      : <CheckBoxOutlineBlankIcon onClick={checkBlock} />\n    }\n  </div>\n}\n\nexport default CheckboxInput\n","import { useState, useCallback, useEffect } from 'react'\n\nfunction MultiButton({ ariaLabel, items, defaultValue, onChange, style, className }) {\n  const [choosen, setChoosen] = useState()\n\n  useEffect(() => setChoosen(defaultValue), [defaultValue, setChoosen])\n\n  const handleClick = useCallback(event => {\n    const newValue = event.target.dataset.value\n    setChoosen(newValue)\n    if (onChange) {\n      onChange(newValue)\n    }\n  }, [setChoosen, onChange])\n\n  return <div\n    aria-label={ariaLabel}\n    className={'buttonRow ' + (className || '')}\n    style={{\n      display: 'inline-block',\n      ...style\n    }}\n  >\n    {\n      items.map(item => {\n        const value = item.value\n        const title = item.title\n        const icon = item.icon || null\n        return <button\n          key={value+'_'+title}\n          className={`${choosen === value ? 'choosen' : ''} ${!!icon ? 'hasIcon' : ''}`}\n          onClick={handleClick}\n          data-value={value}\n        >\n          <span style={{pointerEvents: 'none'}}>\n            {!!icon ? icon : null}\n            {!!title ? <span style={{verticalAlign: 'middle'}}>{title}</span> : null}\n          </span>\n        </button>\n      })\n    }\n  </div>\n}\n\nexport default MultiButton\n","export default __webpack_public_path__ + \"static/media/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.3f9289d0.png\";","export default __webpack_public_path__ + \"static/media/Aktion.89c1bcdf.png\";","export default __webpack_public_path__ + \"static/media/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.6824f6ef.png\";","export default __webpack_public_path__ + \"static/media/Welcome-to-Volt.39e04eca.png\";","export default __webpack_public_path__ + \"static/media/portugal.682fc2e3.jpg\";","\nimport classes from './CoverphotoPicker.module.css'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport MultiButton from '../MultiButton.js'\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nimport plakatschlange_thumb from '../../images/coverphotos/thumbs/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.png'\nimport aktion_thumb from '../../images/coverphotos/thumbs/Aktion.png'\nimport volt_bonn_thumb from '../../images/coverphotos/thumbs/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.png'\nimport welcome_to_volt_thumb from '../../images/coverphotos/thumbs/Welcome-to-Volt.png'\nimport portugal_thumb from '../../images/coverphotos/thumbs/portugal.jpg'\n\n\nfunction CoverphotoPicker({ getString, defaultValue, iconValue, onChange, className = '', style = {} }) {\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  let defaultValueIsUrl = false\n  if (\n    typeof defaultValue === 'string'\n    && defaultValue.length > 0\n    && isAbsoluteUrlRegexp.test(defaultValue)\n  ) {\n    defaultValueIsUrl = true\n  }\n\n  let iconValueIsUrl = false\n  if (\n    typeof iconValue === 'string'\n    && iconValue.length > 0\n    && isAbsoluteUrlRegexp.test(iconValue)\n  ) {\n    iconValueIsUrl = true\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${defaultValueIsUrl ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${iconValueIsUrl ? classes.iconIsSet : classes.iconIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (\n        <div\n          className={classes.coverphoto}\n          style={{\n            backgroundImage: defaultValueIsUrl ? `url(${window.domains.backend}download_url?url=${encodeURIComponent(defaultValue)})` : '',\n          }}\n        >\n          <div className={classes.button_wrapper}>\n            <button {...triggerProps} className={classes.changeCoverphotoButton}>Set Coverphoto</button>\n          </div>\n        </div>\n      )}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_coverphoto_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_coverphoto_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onChange={onChange}\n                defaultValue={defaultValue}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <MultiButton\n            onChange={onChange}\n            ariaLabel={getString('path_editor_coverphoto_label')}\n            defaultValue={defaultValue || ''}\n            items={[\n              {\n                value: '',\n                title: getString('path_editor_no_coverphoto'),\n              },\n              ...[\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_2880x/public/inline-images/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.jpg',\n                  icon: volt_bonn_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2020-11/Welcome-to-Volt.jpg',\n                  icon: welcome_to_volt_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-07/20200912_Plakatschlange_Ko%CC%88ln_Matteo%20Sant_Unione_011.jpeg',\n                  icon: plakatschlange_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/2021-11/portugal.jpg',\n                  icon: portugal_thumb,\n                },\n                {\n                  value: 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Aktion.jpeg',\n                  icon: aktion_thumb,\n                },\n                // 'https://www.volteuropa.org/stripes/hero-desktop-green.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-red.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/hero-desktop-yellow.jpg',\n                // 'https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Colours-Background-Big.jpeg',\n                // 'https://www.volteuropa.org/stripes/intermediate-green.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-red.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-blue.jpg',\n                // 'https://www.volteuropa.org/stripes/intermediate-yellow.jpg',\n                // 'https://www.volteuropa.org/og-default.png',\n                // 'https://www.volteuropa.org/hero-default.jpg',\n              ]\n              .map(({value = '', icon = ''}) => ({\n                value,\n                icon: <img alt=\"\" src={icon} className=\"icon image\" />\n              }))\n            ]}\n          />\n\n          <hr />\n\n          <button onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(CoverphotoPicker)\n","\nimport classes from './IconPicker.module.css'\n\nimport Popover from '../Popover.js'\n\nimport { Paper } from '@mui/material'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction IconPicker({ defaultValue, coverphotoValue, onChange, className, style }) {\n  const isAbsoluteUrlRegexp = new RegExp('^(?:[a-z]+:)?//', 'i')\n\n  let defaultValueIsUrl = false\n  if (\n    typeof defaultValue === 'string'\n    && defaultValue.length > 0\n    && isAbsoluteUrlRegexp.test(defaultValue)\n  ) {\n    defaultValueIsUrl = true\n  }\n\n  let coverphotoValueIsUrl = false\n  if (\n    typeof coverphotoValue === 'string'\n    && coverphotoValue.length > 0\n    && isAbsoluteUrlRegexp.test(coverphotoValue)\n  ) {\n    coverphotoValueIsUrl = true\n  }\n\n  return <div\n    className={`\n      ${classes.root}\n      ${defaultValueIsUrl ? classes.iconIsSet : classes.iconIsNotSet}\n      ${coverphotoValueIsUrl ? classes.coverphotoIsSet : classes.coverphotoIsNotSet}\n      ${className}\n    `}\n    style={style}\n  >\n    <Popover\n      trigger={(triggerProps) => (<div className={classes.iconWrapper}>\n        <div\n          className={`${classes.icon} ${!defaultValueIsUrl ? classes.no_image : ''}`}\n          style={{\n            backgroundImage: defaultValueIsUrl ? `url(${window.domains.backend}download_url?url=${encodeURIComponent(defaultValue)})` : '',\n          }}\n        ></div>\n        <button {...triggerProps} className={classes.changeIconButton}>Set Icon</button>\n      </div>)}\n    >\n      {({closePopover, ...popoverProps}) => (\n        <Paper\n          {...popoverProps}\n          sx={{\n            maxWidth: 'calc(calc(100vw - 32px) - var(--basis_x8))',\n            maxHeight: 'calc(calc(100vh - 32px) - var(--basis_x8))',\n            overflow: 'auto',\n            padding: 'var(--basis_x4)',\n            background: 'var(--background-contrast)',\n            color: 'var(--on-background)',\n          }}\n          elevation={8}\n        >\n          <h3 style={{ marginTop: '0' }}><Localized id=\"path_editor_icon_label\" /></h3>\n\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}>\n            <Localized id=\"path_editor_icon_info\" />\n          </em>\n\n          <FancyInput>\n            {({ setError }) => (\n              <UrlInput\n                onError={setError}\n                onBlur={onChange}\n                defaultValue={defaultValue}\n                style={{\n                  marginRight: '0',\n                  marginLeft: '0',\n                  width: '100%'\n                }}\n              />\n            )}\n          </FancyInput>\n\n          <hr />\n\n          <button onClick={closePopover} style={{ margin: 0 }}>\n            Close\n          </button>\n        </Paper>\n      )}\n    </Popover>\n  </div>\n}\n\nexport default withLocalization(IconPicker)\n","import { useState, useCallback, useEffect } from 'react'\n\n// import FancyInput from './FancyInput.js'\n// import UrlInput from './UrlInput.js'\nimport HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction TriggerInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (type === 'click') {\n    morePropsInput = null\n  } else if (type === 'path') {\n    morePropsInput = <>\n      <HtmlInput\n        placeholder={getString('trigger_input_path_placeholder')}\n        defaultValue={properties.path}\n        onBlur={newValue => updateProperty('path', newValue)}\n        linebreak={false}\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n        // className=\"show_border_on_active\"\n      />\n    </>\n  // } else if (type === 'cron') {\n  //   morePropsInput = <>cron: String</>\n  // } else if (type === 'block_change') {\n  //   morePropsInput = <>blockId: ID</>\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Trigger</option>\n      <option value=\"path\">Path</option>\n      <option value=\"click\">Click</option>\n      {/* <option value=\"cron\">Cron</option> */}\n      {/* <option value=\"block_change\">Block Change</option> */}\n    </select>\n\n    {morePropsInput}\n  </div>\n}\n\nexport default TriggerInput\n","import { useState, useCallback, useEffect } from 'react'\n\nimport FancyInput from './FancyInput.js'\nimport UrlInput from './UrlInput.js'\nimport HtmlInput from './HtmlInput.js'\n\nimport { useLocalization } from '../../fluent/Localized.js'\n\nfunction ActionInput({\n  defaultValue,\n  className,\n  style,\n  onChange,\n}) {\n  const { getString } = useLocalization()\n\n  const [properties, setProperties] = useState({})\n\n  useEffect(() => {\n    setProperties(defaultValue)\n  }, [\n    defaultValue,\n    setProperties,\n  ])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue) => {\n    const propertyTypes = {\n      type: 'string',\n      path: 'string',\n      url: 'string',\n      cron: 'string',\n      blockId: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n\n      if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n        setProperties(newProperties)\n        if (onChange) {\n          onChange(newProperties)\n        }\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const type = properties.type || ''\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <FancyInput\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n      >\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onBlur={newValue => updateProperty('url', newValue)}\n            defaultValue={properties.url}\n            placeholder={getString('action_input_url_placeholder')}\n            type=\"text\"\n            style={{\n              flexGrow: 1,\n              margin: '0',\n              width: '100%'\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <HtmlInput\n        placeholder=\"blockId\"\n        defaultValue={properties.blockId}\n        onBlur={newValue => updateProperty('blockId', newValue)}\n        linebreak={false}\n        style={{\n          flexGrow: '1',\n          margin: '0',\n          minWidth: '300px',\n        }}\n        // className=\"show_border_on_active\"\n      />\n  }\n\n  return <div\n    className={className}\n    style={{\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'flex-start',\n      maxWidth: '100%',\n      flexWrap: 'wrap',\n      gap: 'var(--basis)',\n      ...style\n    }}\n  >\n    <select\n      key={properties.type}\n      onChange={event => updateProperty('type', event.target.value)}\n      defaultValue={properties.type || ''}\n      style={{\n        margin: '0',\n      }}\n    >\n      <option value=\"\">No Action</option>\n      <option value=\"open_url\">Open URL</option>\n      <option value=\"render_block\">Render Block</option>\n      {/* <option value=\"run_block\">Run Block</option> */}\n      {/* <option value=\"send_payload\">Send Payload</option> */}\n    </select>\n\n    {morePropsInput}\n  </div>\n}\n\nexport default ActionInput\n\n\n/*\n\n  let morePropsInput = null\n  if (\n    type === 'open_url'\n    || type === 'send_payload'\n  ) {\n    morePropsInput = <>\n      <UrlInput />\n    </>\n  } else if (\n    type === 'render_block'\n    || type === 'run_block'\n  ) {\n    morePropsInput = <>blockId: ID</>\n  }\n\n\n      <option key=\"editor\" value=\"\">…</option>\n      <option key=\"editor\" value=\"open_url\">Open URL</option>\n      <option key=\"viewer\" value=\"render_block\">Render Block</option>\n      <option key=\"viewer\" value=\"run_block\">Run Block</option>\n      <option key=\"viewer\" value=\"send_payload\">Send Payload</option>\n      */\n","import { useState, useCallback, useEffect } from 'react'\n\n// import { v4 as uuidv4 } from 'uuid'\n\nimport classes from './PropertiesEditor.module.css'\n\nimport { Localized, withLocalization } from '../../fluent/Localized.js'\nimport UrlInput from './UrlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport FancyInput from './FancyInput.js'\nimport CoverphotoPicker from './CoverphotoPicker.js'\nimport IconPicker from './IconPicker.js'\nimport TriggerInput from './TriggerInput.js'\nimport ActionInput from './ActionInput.js'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\n// function addTmpIds(array) {\n//   return [...(array || [])].map(obj => {\n//     if (!obj.tmp_id) {\n//       const obj_new = { ...obj }\n//       obj_new.tmp_id = uuidv4()\n//       return obj_new\n//     }\n//\n//     return obj\n//   })\n// }\n\nfunction PropertiesEditor({ getString, type, defaultProperties = {}, onChange }) {\n  const [properties, setProperties] = useState({})\n\n  // const [coverphoto, setCoverphoto] = useState('')\n  // const [imprint, setImprint] = useState('')\n  // const [privacy_policy, setPrivacyPolicy] = useState('')\n  // const [link, setLink] = useState('')\n\n  // let [voltTeams, setVoltTeams] = useState([])\n  // voltTeams = voltTeams.map(({ id, name }) => ({ value: id, label: name }))\n\n  // const [voltTeamInfos, setVoltTeamInfos] = useState({\n  //   id: null,\n  //   name: ''\n  // })\n  // const setVoltTeamInfosFromSelect = useCallback((data) => {\n  //   setVoltTeamInfos({\n  //     id: data.value,\n  //     name: data.label,\n  //   })\n  // }, [setVoltTeamInfos])\n\n  const updateProperty = useCallback((propertyKey, newPropertyValue, silent = false) => {\n    const propertyTypes = {\n      text: 'string',\n      description: 'string',\n      coverphoto: 'string',\n      icon: 'string',\n      imprint: 'string',\n      privacy_policy: 'string',\n      tags: 'string',\n      checked: 'boolean',\n      trigger: 'object',\n      action: 'object',\n      pronouns: 'string',\n    }\n\n    const newProperties = { ...properties }\n\n    if (propertyTypes.hasOwnProperty(propertyKey)) {\n      switch (propertyTypes[propertyKey]) {\n        case 'array':\n          if (newPropertyValue.length > 0) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'string':\n          if (newPropertyValue !== '') {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'boolean':\n          if (newPropertyValue === true) {\n            newProperties[propertyKey] = true\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        case 'object':\n          if (\n            typeof newPropertyValue === 'object'\n            && newPropertyValue !== null\n            && Object.keys(newPropertyValue).length > 0\n          ) {\n            newProperties[propertyKey] = newPropertyValue\n          } else if (newProperties.hasOwnProperty(propertyKey)) {\n            delete newProperties[propertyKey]\n          }\n        break\n        default:\n          newProperties[propertyKey] = newPropertyValue\n      }\n    }\n\n    if (JSON.stringify(newProperties) !== JSON.stringify(properties)) {\n      setProperties(newProperties)\n      if (silent === false && onChange) {\n        onChange(newProperties)\n      }\n    }\n  }, [\n    properties,\n    setProperties,\n    onChange,\n  ])\n\n  const publishProperties = useCallback(() => {\n    if (onChange) {\n      onChange(properties)\n    }\n  }, [properties, onChange])\n\n  useEffect(() => {\n    setProperties({\n      ...defaultProperties,\n      text: defaultProperties.text || '',\n      description: defaultProperties.description || '',\n    })\n  }, [\n    defaultProperties,\n    setProperties,\n  ])\n\n\n  // useEffect(() => {\n  //   fetch(`${window.domains.backend}teams_simple.json`, {\n  //     mode: 'cors',\n  //     credentials: 'include',\n  //   })\n  //     .then(response => response.json())\n  //     .then(data => {\n  //       if (typeof data.error === 'string') {\n  //         setVoltTeams([])\n  //       } else {\n  //         setVoltTeams(data)\n  //       }\n  //     })\n  //     .catch(error => {\n  //       console.error(error)\n  //       setVoltTeams([])\n  //     })\n  // }, [ setVoltTeams ])\n\n  let propertiesFrameContent = null\n  if (type === 'page') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n      <h3><Localized id=\"properties_editor_imprint_label\" /></h3>\n      <div>\n      <FancyInput>\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onBlur={newValue => updateProperty('imprint', newValue)}\n            defaultValue={properties.imprint}\n            type=\"text\"\n            style={{\n              margin: '0',\n              width: '100%'\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n      </div>\n      </div>\n\n      <div className={classes.properties_row}>\n      <h3><Localized id=\"properties_editor_privacy_policy_label\" /></h3>\n      <div>\n      <FancyInput>\n        {({ setError }) => (\n          <UrlInput\n            onError={setError}\n            onBlur={newValue => updateProperty('privacy_policy', newValue)}\n            defaultValue={properties.privacy_policy}\n            type=\"text\"\n            style={{\n              margin: '0',\n              width: '100%'\n            }}\n            // className=\"show_border_on_active\"\n          />\n        )}\n      </FancyInput>\n      </div>\n      </div>\n    </>\n  // } else if (type === 'redirect') {\n  //   propertiesFrameContent = <>\n  //     <div className={classes.properties_row}>\n  //     <h3><Localized id=\"path_editor_redirect_label\" /></h3>\n  //     <FancyInput>\n  //       {({ setError }) => (\n  //         <UrlInput\n  //           onError={setError}\n  //           onBlur={newValue => updateProperty('link', newValue)}\n  //           type=\"text\"\n  //           placeholder={getString('path_editor_redirect_placeholder')}\n  //           aria-label={getString('path_editor_redirect_label')}\n  //           defaultValue={properties.link}\n  //           style={{\n  //             marginRight: '0',\n  //             marginLeft: '0',\n  //             width: '100%'\n  //           }}\n  //           className=\"show_border_on_active\"\n  //         />\n  //       )}\n  //     </FancyInput>\n  //     </div>\n  //   </>\n  } else if (type === 'person') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_pronouns_label\" /></h3>\n        <HtmlInput\n          defaultValue={properties.pronouns}\n          onChange={newValue => updateProperty('pronouns', newValue, true)}\n          onBlur={publishProperties}\n          placeholder={'…'}\n          style={{\n            margin: '0',\n            width: '100%',\n          }}\n          linebreaks={false}\n          className={`type_text`}\n        />\n      </div>\n    </>\n  } else if (type === 'checkbox') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_checked_label\" /></h3>\n        <CheckboxInput\n          onChange={newValue => updateProperty('checked', newValue)}\n          defaultValue={Boolean(properties.checked)}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'button') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  } else if (type === 'action') {\n    propertiesFrameContent = <>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_trigger_label\" /></h3>\n        <TriggerInput\n          onChange={newValue => updateProperty('trigger', newValue)}\n          defaultValue={properties.trigger || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n      <div className={classes.properties_row}>\n        <h3><Localized id=\"properties_editor_action_label\" /></h3>\n        <ActionInput\n          onChange={newValue => updateProperty('action', newValue)}\n          defaultValue={properties.action || {}}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: '100%'\n          }}\n        />\n      </div>\n    </>\n  }\n\n  return <>\n    {\n      type === 'page' || type === 'person'\n      ? <>\n          <CoverphotoPicker\n            defaultValue={properties.coverphoto}\n            iconValue={properties.icon}\n            onChange={newValue => updateProperty('coverphoto', newValue)}\n          />\n          <IconPicker\n            defaultValue={properties.icon}\n            coverphotoValue={properties.coverphoto}\n            onChange={newValue => updateProperty('icon', newValue)}\n          />\n        </>\n      : null\n    }\n\n    <div className={classes.main_headline}>\n      <HtmlInput\n        defaultValue={properties.text}\n        onChange={newValue => updateProperty('text', newValue, true)}\n        onBlur={publishProperties}\n\n        placeholder={getString('placeholder_main_headline')}\n        style={{ margin: '0' }}\n        linebreaks={true}\n        className={`type_h1`}\n      />\n\n      <HtmlInput\n        defaultValue={properties.description}\n        onChange={newValue => updateProperty('description', newValue, true)}\n        onBlur={publishProperties}\n\n        aria-label={getString('path_editor_description_label')}\n        placeholder={getString('path_editor_description_placeholder')}\n        style={{ margin: '0' }}\n        linebreaks={true}\n        className={`type_text`}\n      />\n    </div>\n\n    <div className={classes.propertiesFrame} style={\n      propertiesFrameContent === null\n        ? { display: 'none' }\n        : null\n    }>\n      {propertiesFrameContent}\n\n      {/* <div className={classes.properties_row}>\n        <h3><Localized id=\"path_editor_tags_label\" /></h3>\n        <HtmlInput\n          onBlur={newValue => updateProperty('tags', newValue)}\n          type=\"text\"\n          placeholder={getString('path_editor_tags_placeholder')}\n          aria-label={getString('path_editor_tags_label')}\n          defaultValue={properties.tags}\n          style={{\n            marginRight: '0',\n            marginLeft: '0',\n            width: 'calc(100% - var(--basis_x2))'\n          }}\n        />\n      </div> */}\n\n      {/*\n        voltTeams && voltTeams.length > 0\n        ? <>\n          <h3><Localized id=\"path_editor_belongs_to_team_label\" /></h3>\n          <em className=\"body2\" style={{ display: 'block', marginBottom: 'var(--basis)' }}><Localized id=\"path_editor_belongs_to_team_info\" /></em>\n          <Select\n            defaultValue={{\n              value: voltTeamInfos !== null ? voltTeamInfos.id || null : null,\n              label: voltTeamInfos !== null ? voltTeamInfos.name || '' : '',\n            }}\n            defaultInputValue={voltTeamInfos !== null ? voltTeamInfos.name || '' : ''}\n            onChange={setVoltTeamInfosFromSelect}\n            ariaLabel={getString('path_editor_belongs_to_team_search_placeholder')}\n            label={getString('path_editor_belongs_to_team_search_placeholder')}\n            placeholder={getString('path_editor_belongs_to_team_search_placeholder')}\n            options={voltTeams}\n            styles={custom_react_select_styles}\n            theme={custom_react_select_theme}\n          />\n        </>\n        : null\n      */}\n    </div>\n  </>\n}\n\nexport default withLocalization(PropertiesEditor)\n","import React, { useState, useEffect, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockTextRaw({\n  getString,\n  block = {},\n  onChange,\n  onSaveBlock,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  onAddRowAfter,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    setText(properties.text || '')\n  }, [properties.text, setText])\n\n  const publishTextChange = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  return <HtmlInput\n    defaultValue={text}\n    onChange={setText}\n    onBlur={publishTextChange}\n\n    placeholder={getString('placeholder_text')}\n    style={{ margin: '0' }}\n    linebreaks={true}\n    className=\"hide_border type_text\"\n\n    onInputRef={onInputRef}\n    onGoToPrevInput={onGoToPrevInput}\n    onGoToNextInput={onGoToNextInput}\n    onMergeToPrevInput={() => onMergeToPrevInput(block)}\n    onMergeFromNextInput={() => onMergeFromNextInput(block)}\n    onSplitText={onSplitText}\n  />\n}\n\nconst InlineEditorBlockText = withLocalization(InlineEditorBlockTextRaw)\n\nexport default InlineEditorBlockText\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport FancyInput from './FancyInput.js'\nimport HtmlInput from './HtmlInput.js'\nimport UrlInput from './UrlInput.js'\n\nfunction InlineEditorBlockButtonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const {\n    action = {}\n  } = properties\n  const [link, setLink] = useState(action.url || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      const newBlock = {\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      }\n\n      if (link === '') {\n        if (newBlock.properties.hasOwnProperty('trigger')) {\n          delete newBlock.properties.trigger\n        }\n        if(newBlock.properties.hasOwnProperty('action')) {\n          delete newBlock.properties.action\n        }\n      } else {\n        newBlock.properties.trigger = {\n          type: 'click'\n        }\n        newBlock.properties.action = {\n\t\t\t\t  type: 'open_url',\n\t\t\t\t  url: link,\n\t\t\t  }\n      }\n\n      onChange(newBlock)\n    }\n  }, [onChange, block, text, link])\n\n  return <div style={{\n    padding: 'var(--basis) 0',\n  }}>\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_button')}\n      style={{ margin: '0' }}\n      linebreaks={true}\n      className=\"hide_border type_button\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n\n    <FancyInput>\n      {({ setError }) => (\n        <UrlInput\n          onError={setError}\n          onChange={setLink}\n          onBlur={publishChanges}\n          type=\"text\"\n          defaultValue={link}\n          placeholder={getString('path_editor_item_link_label')}\n          style={{\n            margin: 'var(--basis) 0',\n            width: '100%',\n          }}\n        />\n      )}\n    </FancyInput>\n  </div>\n}\n\nconst InlineEditorBlockButton = withLocalization(InlineEditorBlockButtonRaw)\n\nexport default InlineEditorBlockButton\n","import React, { useState, useEffect, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockHeadlineRaw({\n  getString,\n  block = {},\n  onChange,\n  onSaveBlock,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n\n  onAddRowAfter,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState('')\n\n  useEffect(() => {\n    setText(properties.text || '')\n  }, [properties.text, setText])\n\n  const publishTextChange = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  return <HtmlInput\n    defaultValue={text}\n    onChange={setText}\n    onBlur={publishTextChange}\n\n    placeholder={getString('placeholder_headline')}\n    style={{ margin: '0' }}\n    linebreaks={true}\n    className=\"hide_border type_h2\"\n\n    onInputRef={onInputRef}\n    onGoToPrevInput={onGoToPrevInput}\n    onGoToNextInput={onGoToNextInput}\n    onMergeToPrevInput={() => onMergeToPrevInput(block)}\n    onMergeFromNextInput={() => onMergeFromNextInput(block)}\n    onSplitText={onSplitText}\n  />\n}\n\nconst InlineEditorBlockHeadline = withLocalization(InlineEditorBlockHeadlineRaw)\n\nexport default InlineEditorBlockHeadline\n","export default function InlineEditorBlockDivider() {\n  return <hr style={{\n    margin: 'calc(3.4 * var(--basis)) 0',\n  }} />\n}\n","import React, { useState, useCallback, useRef } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport HtmlInput from './HtmlInput.js'\nimport CheckboxInput from './CheckboxInput.js'\n\nfunction InlineEditorBlockCheckboxRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n  const checked = useRef(Boolean(properties.checked))\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n          checked: checked.current,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  const saveChecked = useCallback(newValue => {\n    checked.current = newValue\n    publishChanges()\n  }, [ publishChanges ])\n\n  return <div style={{ display: 'flex' }}>\n    <CheckboxInput\n      checked={checked.current}\n      onChange={saveChecked}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockCheckbox = withLocalization(InlineEditorBlockCheckboxRaw)\n\nexport default InlineEditorBlockCheckbox\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport {\n  Face as PersonPlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPersonRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  return <div style={{ display: 'flex' }}>\n    <PersonPlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_text')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPerson = withLocalization(InlineEditorBlockPersonRaw)\n\nexport default InlineEditorBlockPerson\n","import React, { useState, useCallback } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport {\n  InsertDriveFile as PagePlaceholderIcon,\n} from '@mui/icons-material'\n\nimport HtmlInput from './HtmlInput.js'\n\nfunction InlineEditorBlockPageRaw({\n  getString,\n  block = {},\n  onChange,\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const properties = block.properties || {}\n  const [text, setText] = useState(properties.text || '')\n\n  const publishChanges = useCallback(() => {\n    if (onChange) {\n      onChange({\n        ...block,\n        properties: {\n          ...block.properties,\n          text,\n        },\n      })\n    }\n  }, [onChange, block, text])\n\n  return <div style={{ display: 'flex' }}>\n    <PagePlaceholderIcon\n      style={{\n        margin: 'var(--basis)',\n      }}\n    />\n\n    <HtmlInput\n      defaultValue={text}\n      onChange={setText}\n      onBlur={publishChanges}\n\n      placeholder={getString('placeholder_headline_main')}\n      style={{\n        flexGrow: '1',\n        width: '100%',\n        margin: '0',\n        fontWeight: 'bold',\n      }}\n      linebreaks={true}\n      className=\"hide_border type_text\"\n\n      onInputRef={onInputRef}\n      onGoToPrevInput={onGoToPrevInput}\n      onGoToNextInput={onGoToNextInput}\n      onMergeToPrevInput={() => onMergeToPrevInput(block)}\n      onMergeFromNextInput={() => onMergeFromNextInput(block)}\n      onSplitText={onSplitText}\n    />\n  </div>\n}\n\nconst InlineEditorBlockPage = withLocalization(InlineEditorBlockPageRaw)\n\nexport default InlineEditorBlockPage\n","import React, { useState, useCallback, useEffect } from 'react'\n\nimport { withLocalization } from '../../fluent/Localized.js'\n\nimport BlockMenu from './BlockMenu.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\n\nimport InlineEditorBlockText from './InlineEditorBlockText.js'\nimport InlineEditorBlockButton from './InlineEditorBlockButton.js'\nimport InlineEditorBlockHeadline from './InlineEditorBlockHeadline.js'\nimport InlineEditorBlockDivider from './InlineEditorBlockDivider.js'\nimport InlineEditorBlockCheckbox from './InlineEditorBlockCheckbox.js'\nimport InlineEditorBlockPerson from './InlineEditorBlockPerson.js'\nimport InlineEditorBlockPage from './InlineEditorBlockPage.js'\n// import InlineEditorBlockCode from './InlineEditorBlockCode.js'\n\nimport classes from './InlineEditorBlock.module.css'\n\n// function addIds(array){\n//   if (Array.isArray(array)) {\n//     return array.map(item => {\n//       let new_item = { ...item }\n//       if (!new_item.hasOwnProperty('_id')) {\n//         new_item._id = uuidv4()\n//       }\n//       return new_item\n//     })\n//   }\n//   return array\n// }\n\n// function stripIDs(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction InlineEditorBlockInbetweenComponent({ type = 'text', ...props }){\n  let component = null\n\n  switch (type) {\n    case 'button':\n      component = <InlineEditorBlockButton {...props} />\n    break;\n    case 'headline':\n      component = <InlineEditorBlockHeadline {...props} />\n    break;\n    case 'divider':\n      component = <InlineEditorBlockDivider {...props} />\n    break;\n    case 'checkbox':\n      component = <InlineEditorBlockCheckbox {...props} />\n    break;\n    case 'person':\n      component = <InlineEditorBlockPerson {...props} />\n    break;\n    case 'page':\n      component = <InlineEditorBlockPage {...props} />\n    break;\n    // case 'code':\n    //   component = <InlineEditorBlockCode {...props} />\n    // break;\n    default:\n      component = <InlineEditorBlockText {...props} />\n  }\n\n  return component\n}\n\nfunction InlineEditorBlockRaw({\n  fluentByObject,\n  getString,\n  contentConfig = {},\n  className,\n  onChange,\n  reorderHandle,\n  onRemoveRow,\n  actionButton,\n  dataset = {},\n  addRowBefore,\n  addRowAfter,\n  permissions = [],\n\n  onInputRef,\n  onGoToPrevInput,\n  onGoToNextInput,\n  onSplitText,\n  onMergeToPrevInput,\n  onMergeFromNextInput,\n}) {\n  const saveBlock = useSaveBlock()\n\n  // const defaultLocale = getString('default_locale')\n\n  const [block, setBlock] = useState({\n    ...(contentConfig.block || { type: 'text' }),\n    _id: contentConfig.blockId || null,\n  })\n  const properties = block.properties || {}\n  const active = typeof properties.active === 'boolean' ? properties.active : true\n\n  useEffect(() => {\n    if (contentConfig.block) {\n      setBlock(contentConfig.block)\n    }\n  }, [contentConfig.block])\n\n  const handleChange_Type = useCallback(newValue => {\n    const newBlock = {\n      ...block,\n      type: newValue,\n    }\n\n    saveBlock(newBlock)\n      .then((newBlock) => {\n        setBlock(newBlock)\n        if (!block._id || block._id !== newBlock._id) {\n          onChange({\n            blockId: newBlock._id,\n            block: newBlock,\n          })\n        }\n      })\n  }, [setBlock, block, saveBlock, onChange])\n\n  // const handleChange = useCallback(newBlock => {\n  //   setBlock(newBlock)\n\n  //   if (onChange) {\n  //     const target = wrapperDiv.current\n  //     target.value = newBlock\n  //     onChange({ target })\n  //   }\n  // }, [setBlock, onChange])\n\n  const toggle_active = useCallback(() => {\n    const newBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        active: !active,\n      },\n    }\n\n    saveBlock(newBlock)\n      .then((newBlock) => {\n        setBlock(newBlock)\n        if (!block._id || block._id !== newBlock._id) {\n          onChange({\n            blockId: newBlock._id,\n            block: newBlock,\n          })\n        }\n      })\n  }, [block, active, saveBlock, setBlock, onChange])\n\n  const handleBlockChange = useCallback(newBlock => {\n    if (JSON.stringify(newBlock) !== JSON.stringify(block)) {\n      saveBlock(newBlock)\n        .then((newBlock) => {\n          setBlock(newBlock)\n          if (!block._id || block._id !== newBlock._id) {\n            onChange({\n              blockId: newBlock._id,\n              block: newBlock,\n            })\n          }\n        })\n    }\n  }, [saveBlock, block, onChange])\n\n  const handleSaveBlock = useCallback((newBlock, callback) => {\n    saveBlock(newBlock)\n      .then(newBlock => {\n        if (callback) {\n          callback(newBlock)\n        }\n      })\n      .catch(console.error)\n  }, [ saveBlock ])\n\n  return <div\n    className={`${classes.block} ${className}`}\n    {...dataset}\n  >\n\n    <BlockMenu\n      {...{\n        block,\n        setType: handleChange_Type,\n        toggle_active,\n        active,\n        onRemoveRow,\n        addRowBefore,\n        addRowAfter,\n      }}\n\n      trigger={props => (\n        <div\n          {...props}\n          className={classes.reorderHandle}\n        >\n          {reorderHandle}\n        </div>\n      )}\n    />\n\n    <div className={`${classes.block_input} ${(active ? classes.form_active : classes.form_deactivated)}`}>\n      <InlineEditorBlockInbetweenComponent\n        type={block.type}\n        block={block}\n        onChange={handleBlockChange}\n        onSaveBlock={handleSaveBlock}\n\n        onInputRef={onInputRef}\n        onGoToPrevInput={onGoToPrevInput}\n        onGoToNextInput={onGoToNextInput}\n        onSplitText={onSplitText}\n        onMergeToPrevInput={onMergeToPrevInput}\n        onMergeFromNextInput={onMergeFromNextInput}\n\n        onAddRowAfter={addRowAfter}\n      />\n    </div>\n\n  </div>\n}\n\nconst InlineEditorBlock = withLocalization(InlineEditorBlockRaw)\n\nexport default InlineEditorBlock\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { getBlocks_Query } from '../graphql/queries'\n\nfunction useLoadBlocks() {\n  const apollo_client = useApolloClient()\n\n  const handleLoadBlocks = useCallback(variables => {\n    return new Promise(resolve => {\n      apollo_client.query({\n        query: getBlocks_Query,\n        variables,\n      })\n        .then(async ({ data }) => {\n          if (typeof data.error === 'string' || !data.blocks) {\n            console.error(data.error)\n            resolve([])\n          }else{\n            resolve(data.blocks || [])\n          }\n        })\n        .catch(async error => {\n          console.error('error', error)\n          resolve([])\n        })\n    })\n  }, [apollo_client])\n\n  return handleLoadBlocks\n}\n\nexport default useLoadBlocks\n","import { useCallback } from 'react'\n\nimport { useApolloClient } from '@apollo/client'\nimport { deleteBlock_Mutation } from '../graphql/mutations.js'\n\nfunction useSaveBlock() {\n  const apollo_client = useApolloClient()\n\n  const handleSaveBlock = useCallback(({ _id }) => {\n    return new Promise(resolve => {\n      apollo_client.mutate({\n        mutation: deleteBlock_Mutation,\n        variables: {\n          _id,\n        },\n      })\n        .then(async ({ data }) => {\n          resolve('got-data')\n        })\n        .catch(async error => {\n          console.error(error)\n          resolve('got-error')\n        })\n    })\n  }, [ apollo_client ])\n\n  return handleSaveBlock\n}\n\nexport default useSaveBlock\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nimport { v4 as uuidv4 } from 'uuid'\n\nimport {\n  Add as AddIcon,\n} from '@mui/icons-material'\nimport {\n  Tooltip,\n} from '@mui/material'\n\nimport { Localized } from '../../fluent/Localized.js'\nimport InlineEditorBlock from './InlineEditorBlock.js'\nimport useLoadBlocks from '../../hooks/useLoadBlocks.js'\nimport useSaveBlock from '../../hooks/useSaveBlock.js'\nimport useDeleteBlock from '../../hooks/useDeleteBlock.js'\n// import { useTranslatedInputContext } from './TranslatedInput.js'\n\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\nimport DragIndicatorIcon from '@mui/icons-material/DragIndicator'\n\nimport classes from './ContentEditor.module.css'\n\n// function stripTmpIds(array){\n//   return [...array].map(obj => {\n//     const obj_new = { ...obj }\n//     delete obj_new._id\n//     return obj_new\n//   })\n// }\n\nfunction addTmpIds(array) {\n  return [...array].map(obj => {\n    const obj_new = { ...obj }\n    obj_new.tmp_id = uuidv4()\n    return obj_new\n  })\n}\n\nfunction getFirstLineStartNode(element){\n  element.normalize()\n\n  const childNodes = element.childNodes\n  if (childNodes.length > 0) {\n    return childNodes[0]\n  }\n\n  return element\n}\n\nfunction getLastLineStartNode(element) {\n  element.normalize()\n\n  const childNodes = [...element.childNodes].reverse()\n  if (childNodes.length > 0) {\n    let lastLineNode = element\n    if (childNodes[0].nodeType === 3) {\n      for (const childNode of childNodes) {\n        if (childNode.nodeType === 3) {\n          lastLineNode = childNode\n        } else if (childNode.nodeType === 1) {\n          break\n        }\n      }\n    } else {\n      if (childNodes.length > 1) {\n        if (childNodes[1].nodeType === 3) {\n          const thisChildNodes = childNodes.slice(1)\n          for (const childNode of thisChildNodes) {\n            if (childNode.nodeType === 3) {\n              lastLineNode = childNode\n            } else if (childNode.nodeType === 1) {\n              break\n            }\n          }\n        }\n      }\n    }\n\n    return lastLineNode\n  }\n\n  return element\n}\n\nfunction moveCursorToOffsetInLine(contentEditableElement, lastLineStartNode, offset = 0) {\n  contentEditableElement.focus()\n\n  // If this function exists... (IE 9+)\n  if (window.getSelection) {\n    const lastLineStartNodeLength = (\n      lastLineStartNode.nodeType === 3\n        ? lastLineStartNode.length\n        : lastLineStartNode.innerText.length\n    )\n\n    if (offset === -1 || offset > lastLineStartNodeLength) {\n      offset = lastLineStartNodeLength\n    }\n\n    const range = document.createRange()\n    range.setStart(lastLineStartNode, 0)\n    range.setEnd(lastLineStartNode, offset)\n    range.collapse(false) // false = collapse to end\n    const sel = window.getSelection()\n    sel.removeAllRanges()\n    sel.addRange(range)\n  }\n}\n\nfunction reorder(list, startIndex, endIndex) {\n  const result = Array.from(list)\n  const [removed] = result.splice(startIndex, 1)\n  result.splice(endIndex, 0, removed)\n\n  return result\n}\n\nfunction ContentEditor({ defaultValue = [], onChange }) {\n  // const [contentConfigs, setContentConfigs] = useState([])\n  const contentConfigs_Ref = useRef([])\n  const contentConfigs = contentConfigs_Ref.current\n\n  // const [inputRefs, setInputRefs] = useState({})\n  const inputRefs_Ref = useRef({})\n  const inputRefs = inputRefs_Ref.current\n\n  const [updateCounter, setUpdateCounter] = useState(0)\n\n  const loadBlocks = useLoadBlocks()\n  const saveBlock = useSaveBlock()\n  const deleteBlock = useDeleteBlock()\n\n\n  const [autoFocus, setAutoFocus] = useState(null)\n  useEffect(()=>{\n    if (typeof autoFocus === 'object' && autoFocus !== null) {\n      if (\n        inputRefs.hasOwnProperty(autoFocus.tmp_id)\n      ) {\n        const inputRef = inputRefs[autoFocus.tmp_id]\n        if (\n          typeof inputRef === 'object'\n          && inputRef !== null\n        ) {\n          if (autoFocus.inFirstLine === true) {\n            const firstLineStartNode = getFirstLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, firstLineStartNode, autoFocus.positionFromLineStart)\n          } else if (autoFocus.inLastLine === true) {\n            const lastLineStartNode = getLastLineStartNode(inputRef.current)\n            moveCursorToOffsetInLine(inputRef.current, lastLineStartNode, autoFocus.positionFromLineStart)\n          }\n          setAutoFocus(null)\n        }\n      }\n    }\n  }, [\n    autoFocus,\n    setAutoFocus,\n    inputRefs,\n  ])\n\n  useEffect(()=>{\n    if (contentConfigs.length === 0) {\n      if (defaultValue.length > 0) {\n        let newContentConfigs = [...addTmpIds(defaultValue)]\n\n        const ids = newContentConfigs.map(contentConfig => contentConfig.blockId)\n\n        loadBlocks({ ids })\n          .then(loadedBlocks => {\n            newContentConfigs = newContentConfigs\n              .map(contentConfig => ({\n                ...contentConfig,\n                block: loadedBlocks.find(block => block._id === contentConfig.blockId),\n              }))\n\n            contentConfigs_Ref.current = newContentConfigs\n            setUpdateCounter(old => old + 1)\n          })\n      }\n    } else {\n\n    }\n  }, [contentConfigs, defaultValue, loadBlocks, contentConfigs_Ref, setUpdateCounter])\n\n  const saveInputRef = useCallback((keys, inputRef) => {\n    const newInputRefs = {...inputRefs_Ref.current}\n\n    // console.log('saveInputRef-keys', keys)\n    console.log('saveInputRef-newInputRefs', newInputRefs)\n\n    if (\n      !newInputRefs.hasOwnProperty(keys.tmp_id)\n      || newInputRefs[keys.tmp_id] !== inputRef\n    ) {\n      newInputRefs[keys.tmp_id] = inputRef\n      inputRefs_Ref.current = newInputRefs\n    }\n  }, [ inputRefs_Ref ])\n\n  const goToPrevInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let prevInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex < index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        prevInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (prevInputRef) {\n      const lastLineStartNode = getLastLineStartNode(prevInputRef.current)\n      moveCursorToOffsetInLine(prevInputRef.current, lastLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const goToNextInput = useCallback((keys, { caret }) => {\n    const index = keys.index\n\n    let nextInputRef = null\n    for (let thisIndex = 0; thisIndex < contentConfigs.length; thisIndex++) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (thisIndex > index && inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        nextInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (nextInputRef) {\n      const firstLineStartNode = getFirstLineStartNode(nextInputRef.current)\n      moveCursorToOffsetInLine(nextInputRef.current, firstLineStartNode, caret.positionFromLineStart)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const focusLastLine = useCallback(() => {\n    let lastInputRef = null\n    for (let thisIndex = contentConfigs.length-1; thisIndex >= 0; thisIndex--) {\n      const tmp_id = contentConfigs[thisIndex].tmp_id\n      if (inputRefs[tmp_id] && inputRefs[tmp_id].current) {\n        lastInputRef = inputRefs[tmp_id]\n        break\n      }\n    }\n\n    if (lastInputRef) {\n      const lastLineStartNode = getLastLineStartNode(lastInputRef.current)\n      moveCursorToOffsetInLine(lastInputRef.current, lastLineStartNode, -1)\n    }\n  }, [ contentConfigs, inputRefs ])\n\n  const handleRowChange = useCallback((keys, newContentConfig) => {\n    const newContentConfigs = [...contentConfigs]\n    for (const index in newContentConfigs) {\n      const oldContentConfig = newContentConfigs[index]\n      if (oldContentConfig.tmp_id === keys.tmp_id) {\n        newContentConfigs[index] = {\n          ...oldContentConfig,\n          ...newContentConfig,\n        }\n        break\n      }\n    }\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n\n    return new Promise(resolve => {\n      resolve(newContentConfigs)\n    })\n  }, [contentConfigs, contentConfigs_Ref, onChange])\n\n  const addRowByIndex = useCallback((index, offset = 0, newValue) => {\n    if (typeof newValue === 'object') {\n      newValue = {\n        tmp_id: uuidv4(),\n        ...newValue,\n      }\n    } else {\n      newValue = newValue || { tmp_id: uuidv4() }\n    }\n\n    if (typeof index === 'number' && !isNaN(index)) {\n      let new_rows = [...contentConfigs]\n      new_rows.splice(index + offset, 0, newValue)\n      contentConfigs_Ref.current = new_rows\n      onChange(new_rows)\n    }\n  }, [contentConfigs, contentConfigs_Ref, onChange])\n\n  const onMergeToPrevInput = useCallback(keys => {\n    const {\n      index,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index > 0) {\n      const prev_index = index - 1\n      const prev_contentConfig = clonedContentConfigs[prev_index]\n      const prev_tmp_id = prev_contentConfig.tmp_id\n\n      const this_block = clonedContentConfigs[index].block\n      const prev_block = clonedContentConfigs[prev_index].block\n\n      const new_prev_block = {\n        ...prev_block,\n        properties: {\n          ...prev_block.properties,\n          text: prev_block.properties.text + this_block.properties.text,\n        },\n      }\n\n      const thisRef = inputRefs_Ref.current[prev_tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_prev_block)\n        .then(savedPrevBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange({\n            index: prev_index,\n            tmp_id: prev_tmp_id,\n          }, {\n            ...prev_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedPrevBlock._id,\n            block: savedPrevBlock,\n          })\n            .then(newContentConfigs => {\n              const this_block = newContentConfigs[index].block\n              newContentConfigs.splice(index, 1) // delete the block\n\n              deleteBlock({ _id: this_block._id })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n    } else {\n      // This is the first row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, deleteBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const onMergeFromNextInput = useCallback(keys => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const clonedContentConfigs = [...contentConfigs]\n    if (index < clonedContentConfigs.length - 1) {\n\n      const next_index = index + 1\n\n      const this_old_contentConfig = clonedContentConfigs[index]\n      const this_block = clonedContentConfigs[index].block\n      const next_block = clonedContentConfigs[next_index].block\n\n      console.log('next_block', next_block)\n\n      const new_block = {\n        ...this_block,\n        properties: {\n          ...this_block.properties,\n          text: this_block.properties.text + next_block.properties.text,\n        },\n      }\n\n      console.log('new_block', new_block)\n\n      const thisRef = inputRefs_Ref.current[tmp_id]\n      const textLength = thisRef.current.textContent.length\n\n      saveBlock(new_block)\n        .then(savedBlock => {\n          const new_tmp_id = uuidv4()\n          handleRowChange(keys, {\n            ...this_old_contentConfig,\n            tmp_id: new_tmp_id,\n            blockId: savedBlock._id,\n            block: savedBlock,\n          })\n            .then(newContentConfigs => {\n              const next_block = newContentConfigs[next_index].block\n              newContentConfigs.splice(next_index, 1) // delete the block\n\n              deleteBlock({ _id: next_block._id })\n                .then(() => {\n                  contentConfigs_Ref.current = newContentConfigs\n                  setAutoFocus({\n                    tmp_id: new_tmp_id,\n                    positionFromLineStart: textLength,\n                    inFirstLine: false,\n                    inLastLine: true,\n                  })\n                  onChange(newContentConfigs)\n                })\n            })\n        })\n        .catch(console.error)\n\n\n\n\n      // // const firstBlock = rows[index]\n      // // const secondBlock = rows[index + 1]\n\n      // // get current text length (we know the caret is at the end of the text)\n      // const thisRef = inputRefs[tmp_id]\n      // const textLength = thisRef.current.textContent.length\n\n      // // refocus the input at the last caret position\n      // const lastLineStartNode = getLastLineStartNode(thisRef.current)\n      // moveCursorToOffsetInLine(thisRef.current, lastLineStartNode, textLength) // we can't use a text length of -1, as the text length will be changed after the merge\n    } else {\n      // This is the last row. Nothing to merge into.\n    }\n  }, [ contentConfigs, inputRefs_Ref, saveBlock, handleRowChange, deleteBlock, contentConfigs_Ref, setAutoFocus, onChange ])\n\n  const splitText = useCallback((keys, { texts }) => {\n    const {\n      index,\n      tmp_id,\n    } = keys\n\n    const newContentConfigs = [...contentConfigs]\n\n    const block = (newContentConfigs.find(block => block.tmp_id === tmp_id)).block || {}\n\n    const firstBlock = {\n      ...block,\n      properties: {\n        ...block.properties,\n        text: texts[0],\n      },\n    }\n\n    const secondBlock = {\n      type: block.type,\n      properties: {\n        text: texts[1],\n      },\n    }\n\n    saveBlock(firstBlock)\n      .then(savedFirstBlock => {\n        saveBlock(secondBlock)\n          .then(savedSecondBlock => {\n            newContentConfigs[index] = {\n              ...newContentConfigs[index],\n              tmp_id: uuidv4(),\n              blockId: savedFirstBlock._id,\n              block: savedFirstBlock,\n            }\n\n            const nextContentConfig = {\n              tmp_id: uuidv4(),\n              blockId: savedSecondBlock._id,\n              block: savedSecondBlock,\n            }\n            newContentConfigs.splice(index + 1, 0, nextContentConfig)\n\n            contentConfigs_Ref.current = newContentConfigs\n            onChange(newContentConfigs)\n            setAutoFocus({\n              tmp_id: nextContentConfig.tmp_id,\n              positionFromLineStart: 0,\n              inFirstLine: true,\n              inLastLine: false,\n            })\n          })\n          .catch(console.error)\n        })\n      .catch(console.error)\n  }, [\n    contentConfigs,\n    saveBlock,\n    contentConfigs_Ref,\n    onChange,\n    setAutoFocus,\n  ])\n\n  function onDragEnd(result) {\n    if (!result.destination) {\n      return\n    }\n\n    if (result.destination.index === result.source.index) {\n      return\n    }\n\n    const newContentConfigs = reorder(\n      contentConfigs,\n      result.source.index,\n      result.destination.index\n    )\n\n    contentConfigs_Ref.current = newContentConfigs\n    onChange(newContentConfigs)\n  }\n\n  const filteredContentConfigs = contentConfigs\n    .filter(Boolean)\n    .filter(contentConfig => contentConfig.tmp_id)\n\n  return <>\n  <div\n    key={updateCounter}\n    style={{\n      position: 'relative',\n      width: '1000px',\n      maxWidth: '100%',\n      margin: 'var(--basis_x8) auto 0 auto',\n    }}\n  >\n    <div>\n      <button\n        onClick={() => addRowByIndex(0, 0, {})}\n        className=\"text hasIcon\"\n        style={{\n          margin: '0 0 var(--basis_x2) 0',\n        }}\n      >\n        <span style={{pointerEvents: 'none'}}>\n          <AddIcon className=\"icon\" />\n          <span style={{marginInlineStart: 'var(--basis_x2)', verticalAlign: 'middle'}}>\n            <Localized id=\"add_content_before\" />\n          </span>\n        </span>\n      </button>\n    </div>\n\n    <DragDropContext onDragEnd={onDragEnd}>\n      <Droppable\n        droppableId=\"list\"\n        isDropDisabled={false}\n      >\n        {provided => (\n          <div ref={provided.innerRef} {...provided.droppableProps} className=\"inputBorder\">\n            {\n              filteredContentConfigs\n              .map(\n                (contentConfig, index) => {\n                  const tmp_id = contentConfig.tmp_id\n                  const keys = {\n                    index,\n                    tmp_id,\n                  }\n\n                  return <Draggable\n                    key={tmp_id}\n                    draggableId={tmp_id}\n                    index={index}\n                    isDragDisabled={false}\n                    disableInteractiveElementBlocking={true}\n                    shouldRespectForcePress={true}\n                  >\n                    {provided => (\n                      <div\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n\n                        key={tmp_id}\n                        className={classes.row}\n                      >\n                      <div className={classes.form}>\n                        <InlineEditorBlock\n                          key={tmp_id}\n                          className={classes.item}\n                          dataset={{\n                            'data-index': index,\n                            'data-id': tmp_id,\n                          }}\n                          contentConfig={contentConfig}\n\n                          reorderHandle={\n                            <Tooltip title={<div style={{ textAlign: 'center' }}>\n                              <strong>Drag</strong> to move.<br />\n                              <strong>Click</strong> to open menu.\n                            </div>}>\n                              <button\n                                className={`text ${classes.inlineRowButton} ${classes.dragHandleButton}`}\n                                {...provided.dragHandleProps}\n                              >\n                                <DragIndicatorIcon />\n                              </button>\n                            </Tooltip>\n                          }\n\n                          onRemoveRow={ () => {/*handleRemoveRow(index)*/} }\n                          addRowBefore={ (newValue) => addRowByIndex(index, 0, newValue) }\n                          addRowAfter={ (newValue) => addRowByIndex(index, 1, newValue) }\n\n                          onInputRef={(inputRef) => saveInputRef(keys, inputRef)}\n                          onGoToPrevInput={(attr) => goToPrevInput(keys, attr)}\n                          onGoToNextInput={(attr) => goToNextInput(keys, attr)}\n                          onSplitText={(attr) => splitText(keys, attr)}\n                          onChange={(attr) => handleRowChange(keys, attr)}\n                          onMergeToPrevInput={(attr) => onMergeToPrevInput(keys, attr)}\n                          onMergeFromNextInput={(attr) => onMergeFromNextInput(keys, attr)}\n                          // {...repeater_props}\n                        />\n                      </div>\n                    </div>\n                    )}\n                  </Draggable>\n                }\n              )\n            }\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n  </div>\n\n  <div\n    style={{\n      position: 'relative',\n      height: '50vh',\n      cursor: (filteredContentConfigs.length === 0 ? 'default' : 'text'),\n    }}\n    onClick={filteredContentConfigs.length === 0 ? null : focusLastLine}\n  ></div>\n  </>\n}\n\nexport default ContentEditor\n","\nimport {\n  Login as LoginIcon,\n} from '@mui/icons-material'\n\nimport Localized from '../fluent/Localized.js'\n\nexport default function LoginScreen () {\n  return <>\n    <h1>Login to view content</h1>\n    <a href={`${window.domains.backend}login?redirect_to=${encodeURIComponent(window.location.toString())}`}>\n      <button className=\"hasIcon\" style={{ margin: 'var(--basis_x4) 0 0 0' }}>\n        <LoginIcon className=\"icon\" />\n        <span>\n          <Localized id=\"login\" />\n        </span>\n      </button>\n    </a>\n  </>\n}\n","import { useRef, useState, useCallback, useEffect } from 'react'\n\nimport {\n  useParams,\n} from 'react-router-dom'\n\nimport useSaveBlock from '../hooks/useSaveBlock.js'\nimport useLoadBlock from '../hooks/useLoadBlock.js'\nimport useBlockMatchesRoles from '../hooks/useBlockMatchesRoles.js'\n\n// import Select from 'react-select'\n\nimport {\n  // TranslateSharp as TranslateIcon,\n  IosShareSharp as ShareIcon,\n  LockSharp as PermissionsIcon,\n  SaveSharp as SaveIcon,\n  MoreHorizSharp as BlockMenuIcon,\n} from '@mui/icons-material'\n\nimport classes from './Editor.module.css'\n\nimport { Localized, useLocalization } from '../fluent/Localized.js'\n// import { useTranslatedInputContext, LocalesMenu } from '../components/edit/TranslatedInput.js'\n\nimport Header from '../components/Header.js'\nimport BlockMenu from '../components/edit/BlockMenu.js'\nimport SharingEditor from '../components/edit/SharingEditor.js'\nimport PermissionsEditor from '../components/edit/PermissionsEditor.js'\nimport PropertiesEditor from '../components/edit/PropertiesEditor.js'\nimport ContentEditor from '../components/edit/ContentEditor.js'\nimport LoginScreen from '../components/LoginScreen.js'\n\n// const custom_react_select_styles = {\n//   menu: (provided, state) => ({\n//     ...provided,\n//     background: 'var(--purple)',\n//   }),\n// }\n// const custom_react_select_theme = theme => ({\n//   ...theme,\n//   borderRadius: 0,\n//   colors: {\n//     ...theme.colors,\n//     primary: 'var(--green)',\n//     primary25: 'var(--purple-dark)',\n//   },\n// })\n\nfunction Editor() {\n  const { getString, fluentByAny } = useLocalization()\n\n  const saveBlock = useSaveBlock()\n  const loadBlock = useLoadBlock()\n\n  // const { currentLocale, setLocales } = useTranslatedInputContext()\n\n  const [ isSharingEditorOpen, setIsSharingEditorOpen ] = useState(false)\n  const openSharingEditor = useCallback(() => setIsSharingEditorOpen(true), [ setIsSharingEditorOpen ])\n  const closeSharingEditor = useCallback(() => setIsSharingEditorOpen(false), [ setIsSharingEditorOpen ])\n\n  const [ isPermissionsEditorOpen, setIsPermissionsEditorOpen ] = useState(false)\n  const openPermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(true), [ setIsPermissionsEditorOpen ])\n  const closePermissionsEditor = useCallback(() => setIsPermissionsEditorOpen(false), [ setIsPermissionsEditorOpen ])\n\n  const loadedTheBlock = useRef(false)\n  let { id = '' } = useParams()\n\n  const [block, setBlock] = useState({\n    type: 'page',\n    properties: {},\n    content: [],\n  })\n  const type = block.type\n  const properties = block.properties\n  const content = block.content\n  const permissions = block.permissions\n\n  const [ canEdit, setCanEdit ] = useState(null)\n  const blockMatchesRoles = useBlockMatchesRoles()\n  useEffect(() => {\n    blockMatchesRoles(id, ['editor', 'owner'])\n      .then(matchesRoles => {\n        setCanEdit(matchesRoles)\n      })\n      .catch(error => {\n        console.error(error)\n        setCanEdit(false)\n      })\n  }, [ id, blockMatchesRoles, setCanEdit ])\n\n  useEffect(() => {\n    if (\n      canEdit\n      && typeof id === 'string'\n      && id !== ''\n      && (\n        !loadedTheBlock.current\n        || id !== block._id\n      )\n    ) {\n      loadBlock(id)\n        .then(loadedBlock => {\n          loadedTheBlock.current = true\n\n          // // get locales from text and description\n          // // TODO: also look at the locales from sub-blocks\n          // if (\n          //   loadedBlock.properties\n          //   && (\n          //     loadedBlock.properties.text\n          //     || loadedBlock.properties.description\n          //   )\n          // ) {\n          //   setLocales([...new Set([\n          //     ...(loadedBlock.properties.text ? loadedBlock.properties.text.map(t => t.locale) : []),\n          //     ...(loadedBlock.properties.description ? loadedBlock.properties.description.map(t => t.locale) : []),\n          //   ])])\n          // }\n\n          setBlock(loadedBlock)\n        })\n    }\n  }, [\n    canEdit,\n    id,\n    block,\n    loadBlock,\n    setBlock,\n    // setLocales,\n  ])\n\n  const saveType = useCallback(newType => {\n    if (newType !== block.type) {\n      const newBlock = {\n        ...block,\n        type: newType,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          setBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, setBlock])\n\n  const saveProperties = useCallback(newProperties => {\n    if (newProperties !== block.properties) {\n      const newBlock = {\n        ...block,\n        properties: newProperties,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          setBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, setBlock])\n\n  const saveContent = useCallback(newContent => {\n    if (newContent !== block.content) {\n      const newBlock = {\n        ...block,\n        content: newContent,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          setBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, setBlock])\n\n  const savePermissions = useCallback(newPermissions => {\n    if (newPermissions !== block.permissions) {\n      const newBlock = {\n        ...block,\n        permissions: newPermissions,\n      }\n\n      saveBlock(newBlock)\n        .then(gottenBlock => {\n          setBlock(gottenBlock)\n        })\n    }\n  }, [block, saveBlock, setBlock])\n\n  const manuallySaveEverything = useCallback(() => {\n    saveBlock(block)\n      .then(gottenBlock => {\n        if (gottenBlock._id !== block._id) {\n          setBlock(gottenBlock)\n        }\n      })\n  }, [saveBlock, block, setBlock])\n\n  // const isFirstRun = useRef(true)\n  // useEffect(() => {\n  //   if (isFirstRun.current) {\n  //     isFirstRun.current = false\n  //     return;\n  //   }\n  //\n  //   if (\n  //     Object.keys(block).length > 0\n  //     && JSON.stringify(initialBlock) !== JSON.stringify(block)\n  //   ) {\n  //   }\n  // }, [isFirstRun, initialBlock, block])\n\n  if (canEdit === false) {\n    return <LoginScreen />\n  } else if (canEdit === true) {\n\n  const rightHeaderActions = <div className=\"buttonRow\" style={{ whiteSpace: 'nowrap' }}>\n    {/* <button className=\"text\"><Localized id=\"path_editor_share\"/></button> */}\n\n\n    {/*\n    <LocalesMenu\n      trigger={triggerProps => (\n        <button {...triggerProps} className=\"text hasIcon\">\n          <TranslateIcon className=\"icon\" />\n          <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}>\n            <Localized id=\"path_editor_translate\" />\n            {getString('locale_'+currentLocale)}\n          </span>\n        </button>\n      )}\n    />\n    */}\n\n    {\n      isSharingEditorOpen\n      ? <SharingEditor\n          defaultBlock={block}\n          open={isSharingEditorOpen}\n          onClose={closeSharingEditor}\n          onChange={saveProperties}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openSharingEditor}>\n      <ShareIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_share\" /></span>\n    </button>\n\n    {\n      isPermissionsEditorOpen\n      ? <PermissionsEditor\n          defaultPermissions={permissions}\n          open={isPermissionsEditorOpen}\n          onClose={closePermissionsEditor}\n          onChange={savePermissions}\n        />\n      : null\n    }\n    <button className=\"text hasIcon\" onClick={openPermissionsEditor}>\n      <PermissionsIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_permissions\" /></span>\n    </button>\n\n    <button className=\"text hasIcon\" onClick={manuallySaveEverything}>\n      <SaveIcon className=\"icon\" />\n      <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"path_editor_publish\" /></span>\n    </button>\n\n    <BlockMenu\n      {...{\n        block,\n        setType: saveType,\n      }}\n\n      trigger={props => (\n        <button\n          {...props}\n          className=\"white hasIcon\"\n        >\n          <BlockMenuIcon className=\"icon\" />\n        </button>\n      )}\n    />\n  </div>\n\n  const pagetitle = fluentByAny(block.properties.text, getString('placeholder_main_headline'))\n  const title = pagetitle\n\n  return <div key={block._id} className={`hasHeader ${classes.editor}`}>\n    <Header\n      block={block}\n      // title={<a href={`https://volt.link/${slug}`} target=\"_blank\" rel=\"noopener noreferrer\"><span className=\"hideOnSmallScreen\">volt.link</span>/{slug}</a>}\n      title={title}\n      rightActions={rightHeaderActions}\n    />\n\n    <PropertiesEditor\n      type={type}\n      defaultProperties={properties}\n      onChange={saveProperties}\n    />\n\n    <ContentEditor\n      onChange={saveContent}\n      defaultValue={content}\n    />\n  </div>\n  } else {\n    return null\n  }\n}\n\nexport default Editor\n","import { useRef, useState, useEffect } from 'react'\n\nimport {\n  useParams,\n  Link,\n} from 'react-router-dom'\n\nimport { Localized, useLocalization } from '../fluent/Localized.js'\nimport useLoadBlock from '../hooks/useLoadBlock.js'\nimport useLoadBlocks from '../hooks/useLoadBlocks.js'\nimport useUser from '../hooks/useUser.js'\nimport useBlockMatchesRoles from '../hooks/useBlockMatchesRoles.js'\n\nimport LoginScreen from '../components/LoginScreen.js'\nimport Header from '../components/Header.js'\nimport ViewerAuto from '../components/view/ViewerAuto.js'\n\nimport classes from './Viewer.module.css'\n\nimport {\n  EditSharp as EditIcon,\n} from '@mui/icons-material'\n\nfunction Viewer () {\n  const loadingTheBlock = useRef(false)\n  const { getString } = useLocalization()\n\n  const { loggedIn } = useUser()\n\n  const loadBlock = useLoadBlock()\n  const loadBlocks = useLoadBlocks()\n\n  let { id = '' } = useParams()\n\n  const [block, setBlock] = useState({\n    type: 'page',\n    properties: {},\n    content: [],\n  })\n  const [contentBlocks, setContentBlocks] = useState([])\n\n  const [canView, setCanView] = useState(null)\n  const blockMatchesRoles = useBlockMatchesRoles()\n  useEffect(() => {\n    blockMatchesRoles(id, ['viewer', 'owner'])\n      .then(matchesRoles => {\n        setCanView(matchesRoles)\n      })\n      .catch(error => {\n        console.error(error)\n        setCanView(false)\n      })\n  }, [ id, blockMatchesRoles, setCanView ])\n\n  useEffect(() => {\n    if (\n      canView\n      && loadingTheBlock.current === false\n      && typeof id === 'string'\n      && id !== ''\n      && id !== block._id\n    ) {\n      loadingTheBlock.current = true\n      loadBlock(id)\n        .then(loadedBlock => {\n          setBlock(loadedBlock)\n          const ids = loadedBlock.content.map(content => content.blockId)\n          loadBlocks({ ids })\n            .then(loadedContentBlocks => {\n              const contentBlocksOrdered = [...ids].map(id => loadedContentBlocks.find(block => block._id === id))\n              setContentBlocks([...contentBlocksOrdered])\n              loadingTheBlock.current = false\n            })\n        })\n    }\n  }, [\n    canView,\n    id,\n    block._id,\n    loadBlock,\n    setBlock,\n    loadBlocks,\n    setContentBlocks,\n  ])\n\n  if (canView === false) {\n    return <LoginScreen />\n  } else if (canView === true) {\n  const type = block.type || null\n\n  const title = block.properties.text || getString('placeholder_main_headline')\n  const description = block.properties.description || ''\n  const coverphoto_url = block.properties.coverphoto || ''\n  const icon_url = block.properties.icon || ''\n  const pronouns = block.properties.pronouns || ''\n\n  const rightHeaderActions = <div className=\"buttonRow\" style={{ whiteSpace: 'nowrap' }}>\n    <Link to={`/edit/${block._id}`}>\n      <button className=\"text hasIcon\">\n        <EditIcon className=\"icon\" />\n        <span className=\"hideOnSmallScreen\" style={{verticalAlign: 'middle'}}><Localized id=\"edit_block\" /></span>\n      </button>\n    </Link>\n  </div>\n\n  return <>\n    <Header\n      block={block}\n      title={title}\n      rightActions={loggedIn ? rightHeaderActions : null}\n    />\n\n    <div className={`basis_x1 ${classes.app} ${classes.spine_aligned}`} dir=\"auto\">\n      {\n      (type === 'page' || type === 'person')\n      && coverphoto_url !== ''\n          ? <div style={{ backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(coverphoto_url)})` }} className={classes.coverphoto}></div>\n          : null\n      }\n      <main className={`${classes.contentWrapper}`}>\n        {\n          (type === 'page' || type === 'person')\n          && icon_url !== ''\n            ? <div\n                style={{\n                  backgroundImage: `url(${window.domains.backend}download_url?url=${encodeURIComponent(icon_url)})`\n                }}\n                className={`${classes.icon} ${coverphoto_url === '' ? classes.coverphotoIsNotSet : classes.coverphotoIsSet}`}\n              ></div>\n            : null\n        }\n        { title !== '' ? <h1 dir=\"auto\">{title}</h1> : null }\n        { type === 'person' && pronouns !== '' ? <p dir=\"auto\"><strong style={{\n          padding: 'var(--basis)',\n          margin: 'var(--basis_x0_5) calc(-1 * var(--basis))',\n          display: 'inline-block',\n          backgroundColor: 'rgba(var(--on-background-rgb), var(--alpha-less))',\n        }}>{pronouns}</strong></p> : null }\n        { description !== '' ? <p dir=\"auto\">{description.split(/\\n/g).flatMap(i => [i, <br key={i}/>])}<br/></p> : null }\n        <div className={classes.items}>\n          {\n            contentBlocks\n            .filter(block => !!block)\n            .map(contentBlock => <ViewerAuto key={contentBlock._id} block={contentBlock} />)\n          }\n        </div>\n      </main>\n    </div>\n  </>\n  } else {\n    return null\n  }\n}\n\nexport default Viewer\n","import React, { useState, useEffect } from 'react'\n\nimport classes from './App.module.css'\n\nimport {\n  Routes,\n  Route,\n  useLocation,\n  useMatch,\n} from 'react-router-dom'\n\nimport useUser from '../hooks/useUser.js'\nimport { SidebarProvider, Sidebar, SidebarContent, Main } from '../components/Sidebar.js'\nimport Shortcode from './Shortcode.js'\nimport Editor from './Editor.js'\nimport Viewer from './Viewer.js'\nimport LoginScreen from '../components/LoginScreen.js'\n\nfunction App() {\n  const { loggedIn } = useUser()\n\n  const matchesStartpage = useMatch('/')\n  const location = useLocation()\n\n  const [customLocation, setCustomLocation] = useState({})\n\n  useEffect(() => {\n    const urlParams = new URLSearchParams(location.search)\n    const real_path = urlParams.get('real_path')\n\n    if (\n      customLocation.pathname !== real_path\n    ) {\n      if (\n        typeof real_path === 'string'\n        && real_path.length > 0\n      ) {\n        window.history.replaceState(null, '', location.pathname)\n        setCustomLocation({\n          pathname: real_path,\n        })\n      } else {\n        setCustomLocation(location)\n      }\n    }\n  }, [ location, customLocation, setCustomLocation ])\n\n  return (<>\n    <div className={`${classes.app} ${matchesStartpage ? classes.isStartpage : ''}`}>\n      <SidebarProvider>\n        {\n          matchesStartpage\n          ? null\n          : <Sidebar />\n        }\n        <Main>\n        {\n          loggedIn\n          ? <Routes location={customLocation}>\n              <Route path=\"/view/:id\" element={<Viewer />} />\n              <Route path=\"/edit/:id\" element={<Editor />} />\n              <Route path=\"/shortcode\" element={<Shortcode />} />\n              <Route path=\"/\" element={<SidebarContent />} />\n            </Routes>\n          : <Routes location={customLocation}>\n              <Route path=\"/view/:id\" element={<Viewer />} />\n              <Route path=\"/edit/:id\" element={<LoginScreen />} />\n              <Route path=\"/shortcode\" element={<LoginScreen />} />\n              <Route path=\"/\" element={<SidebarContent />} />\n            </Routes>\n        }\n        </Main>\n      </SidebarProvider>\n    </div>\n  </>)\n}\n\nexport default App\n","import React, { useEffect, useState } from 'react'\n\n// https://projectfluent.org/play/\n\n// import { LocalizationProvider, Localized } from '@fluent/react' // '@fluent/react/compat'\nimport { ReactLocalization, LocalizationProvider } from '@fluent/react'\nimport { FluentBundle, FluentResource } from '@fluent/bundle'\nimport { negotiateLanguages } from '@fluent/langneg'\n\n\nexport const locales = {\n  de: 'Deutsch',\n  en: 'English',\n  // es: 'Español',\n  // pt: 'Português',\n  fr: 'Français',\n  // it: 'Italiano',\n  // nl: 'Dutch',\n  // pl: 'Polska',\n  // ru: 'Pусский',\n}\n\nconst _supportedLocales_ = Object.keys(locales)\nconst _defaultLocale_ = 'en'\n\n\nasync function fetchMessages(locale) {\n  const path = await import('../locales/' + locale + '.ftl')\n\n  const response = await fetch(path.default)\n  const messages = await response.text()\n\n  return { [locale]: new FluentResource(messages) }\n}\n\nfunction getDefaultBundles() {\n  const bundle = new FluentBundle('')\n  bundle.addResource(new FluentResource(''))\n  return new ReactLocalization([bundle])\n}\n\nasync function createMessagesGenerator(currentLocales) {\n  const fetched = await Promise.all(\n    currentLocales.map(fetchMessages)\n  )\n  const messages = fetched.reduce(\n    (obj, cur) => Object.assign(obj, cur)\n  )\n\n  return function* generateBundles() {\n    for (const locale of currentLocales) {\n      const bundle = new FluentBundle(locale)\n      bundle.addResource(messages[locale])\n      yield bundle\n    }\n  }\n}\n\nexport function AppLocalizationProvider({ userLocales, children, onLocaleChange }) {\n  const [bundles, setBundles] = useState(getDefaultBundles())\n\n  useEffect(() => {\n    async function loadBundles() {\n      const currentLocales = negotiateLanguages(\n        userLocales,\n        _supportedLocales_,\n        { defaultLocale: _defaultLocale_ }\n      )\n\n      if (!!onLocaleChange) {\n        onLocaleChange(currentLocales)\n      }\n\n      const generateBundles = await createMessagesGenerator(currentLocales)\n\n      const new_bundles = new ReactLocalization(generateBundles())\n      new_bundles.userLocales = userLocales\n      new_bundles.defaultLocale = _defaultLocale_\n      new_bundles.supportedLocales = _supportedLocales_\n      setBundles(new_bundles)\n    }\n    loadBundles()\n  }, [userLocales, onLocaleChange])\n\n  if (!bundles) {\n    // Show a loader.\n    return <div>Loading texts…</div>\n  }\n\n  return <LocalizationProvider l10n={bundles}>\n    {children}\n  </LocalizationProvider>\n}\n\n","import React, { useState, useEffect, useCallback } from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\n\nimport snackbarClasses from './Snackbar.module.css'\n\nimport App from './pages/App.js'\n// import reportWebVitals from './reportWebVitals'\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nimport 'intl-pluralrules'\nimport { AppLocalizationProvider, locales } from './fluent/l10n.js'\n// import { TranslatedInputProvider } from './components/edit/TranslatedInput.js'\n\nimport useMediaQuery from '@mui/material/useMediaQuery'\nimport { createTheme, ThemeProvider } from '@mui/material/styles'\n\nimport { SnackbarProvider } from 'notistack'\n\nimport {\n  ApolloClient,\n  InMemoryCache,\n  ApolloProvider,\n} from '@apollo/client'\n\nwindow.domains = {\n  // frontend: 'http://localhost:3000/',\n  backend: 'https://api.volt.link/',\n  // backend: 'http://localhost:4004/',\n  frontend: 'https://beta.volt.link/',\n}\n\nconst client = new ApolloClient({\n  uri: window.domains.backend+'graphql/v1/',\n  cache: new InMemoryCache(),\n  credentials: 'include',\n  defaultOptions: {\n    watchQuery: {\n      fetchPolicy: 'cache-and-network',\n    },\n  },\n})\n\n// client\n//   .query({\n//     query: gql`\n//       query GetRates {\n//         rates(currency: \"USD\") {\n//           currency\n//         }\n//       }\n//     `\n//   })\n//   .then(result => console.info(result));\n\nfunction Start() {\n  // const [userLocales, setUserLocales] = useState(['de'])\n  const [userLocales, setUserLocales] = useState(navigator.languages)\n  const [currentLocale, setCurrentLocale] = useState(null)\n\n  useEffect(() => {\n    if (!!window.umami) {\n      let systemLocales = navigator.languages\n      if (!!systemLocales || Array.isArray(systemLocales)) {\n        for (let locale of systemLocales) {\n          locale = locale.toLowerCase() // Not really correct but the system locales sadly don't conform to the standard.\n\n          const language = locale.split('-')[0]\n          if (language !== locale) {\n            window.umami.trackEvent('L: ' + language) // Log just the language.\n          }\n          window.umami.trackEvent('L: ' + locale) // Log the full locale.\n        }\n      }\n    }\n  }, [])\n\n  const handleLanguageChange = useCallback(event => {\n    setUserLocales([event.target.dataset.locale])\n  }, [setUserLocales])\n\n  const handleCurrentLocalesChange = useCallback(currentLocales => {\n    setCurrentLocale(currentLocales.length > 0 ? currentLocales[0] : '')\n  }, [setCurrentLocale])\n\n\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)')\n\n  const theme = React.useMemo(\n    () =>\n      createTheme({\n        palette: {\n          mode: prefersDarkMode ? 'dark' : 'light',\n        },\n      }),\n    [prefersDarkMode],\n  )\n\n  return <>\n  <div\n    id=\"react-notification\"\n    key=\"react-notification\"\n    style={{zIndex: '10000'}}\n  ></div>\n\n  <AppLocalizationProvider\n    key=\"AppLocalizationProvider\"\n    userLocales={userLocales}\n    onLocaleChange={handleCurrentLocalesChange}\n  >\n    <ApolloProvider client={client}>\n      <ThemeProvider theme={theme}>\n        <SnackbarProvider\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n          style={{ minWidth: 'unset' }}\n          classes={{\n            variantSuccess: `${snackbarClasses.snackbar} ${snackbarClasses.success}`,\n            variantError: `${snackbarClasses.snackbar} ${snackbarClasses.error}`,\n            variantWarning: `${snackbarClasses.snackbar} ${snackbarClasses.warning}`,\n            variantInfo: `${snackbarClasses.snackbar} ${snackbarClasses.info}`,\n          }}\n          domRoot={document.getElementById('react-notification')}\n        >\n          {/* <TranslatedInputProvider> */}\n            <Router>\n              <App locales={locales} currentLocale={currentLocale} onLanguageChange={handleLanguageChange} />\n            </Router>\n          {/* </TranslatedInputProvider> */}\n        </SnackbarProvider>\n      </ThemeProvider>\n    </ApolloProvider>\n  </AppLocalizationProvider>\n  </>\n}\n\nReactDOM.render(<Start />, document.getElementById('root'))\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.info))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals()\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"coverphoto\":\"ViewerActionCard_coverphoto__3octg\",\"icon\":\"ViewerActionCard_icon__3zy8N\",\"title\":\"ViewerActionCard_title__1HxR6\",\"iconLine\":\"ViewerActionCard_iconLine__1TXjK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogsWrapper\":\"PermissionsEditor_dialogsWrapper__1xVvi\",\"dialog\":\"PermissionsEditor_dialog__2rpyk\",\"backdrop\":\"PermissionsEditor_backdrop__1dRPN\",\"inputWrapper\":\"PermissionsEditor_inputWrapper__4DGsr\",\"emailInput\":\"PermissionsEditor_emailInput__1uH8s\",\"permissionRow\":\"PermissionsEditor_permissionRow__2HaWO\",\"menuButton\":\"PermissionsEditor_menuButton__2jIMI\",\"ownerInfo\":\"PermissionsEditor_ownerInfo__EEKXP\",\"actions\":\"PermissionsEditor_actions__k4oBn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main_headline\":\"PropertiesEditor_main_headline__3wy7R\",\"propertiesFrame\":\"PropertiesEditor_propertiesFrame__1uBEz\",\"properties_row\":\"PropertiesEditor_properties_row__2tX7M\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"IconPicker_root__2okyv\",\"iconIsSet\":\"IconPicker_iconIsSet__SnQwA\",\"coverphotoIsSet\":\"IconPicker_coverphotoIsSet__3m9Dw\",\"icon\":\"IconPicker_icon__JWgfX\",\"iconWrapper\":\"IconPicker_iconWrapper__1zo6g\",\"sizing_pixel\":\"IconPicker_sizing_pixel__3TeE0\",\"iconIsNotSet\":\"IconPicker_iconIsNotSet__1T0Zd\",\"changeIconButton\":\"IconPicker_changeIconButton__TxsdG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"snackbar\":\"Snackbar_snackbar__119_w\",\"default\":\"Snackbar_default__31-eU\",\"success\":\"Snackbar_success__zvTW8\",\"error\":\"Snackbar_error__3XeD6\",\"warning\":\"Snackbar_warning__2CBXt\",\"info\":\"Snackbar_info__EuVSN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"coverphoto\":\"CoverphotoPicker_coverphoto__1mWB4\",\"root\":\"CoverphotoPicker_root__3T8t9\",\"coverphotoIsNotSet\":\"CoverphotoPicker_coverphotoIsNotSet__1O3-S\",\"button_wrapper\":\"CoverphotoPicker_button_wrapper__2oEjh\",\"coverphotoIsSet\":\"CoverphotoPicker_coverphotoIsSet__2o24A\",\"iconIsSet\":\"CoverphotoPicker_iconIsSet__D_4uA\",\"changeCoverphotoButton\":\"CoverphotoPicker_changeCoverphotoButton__2GnZD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Viewer_app__1_jMF\",\"spine_aligned\":\"Viewer_spine_aligned__2mJuq\",\"items\":\"Viewer_items__2FgjF\",\"coverphoto\":\"Viewer_coverphoto__16R-U\",\"icon\":\"Viewer_icon__219E5\",\"coverphotoIsSet\":\"Viewer_coverphotoIsSet__26PSP\",\"contentWrapper\":\"Viewer_contentWrapper__1HLN8\",\"type_p\":\"Viewer_type_p__O5DZS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"SharingEditor_dialog__22jfY\",\"backdrop\":\"SharingEditor_backdrop__1Gra9\",\"inputWrapper\":\"SharingEditor_inputWrapper__1UyBD\",\"input\":\"SharingEditor_input__brkXK\",\"actions\":\"SharingEditor_actions__2zz6x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"InlineEditorBlock_block__14-zd\",\"block_input\":\"InlineEditorBlock_block_input__2I1iu\",\"form_deactivated\":\"InlineEditorBlock_form_deactivated__2oktp\",\"form_active\":\"InlineEditorBlock_form_active__hi5HC\",\"reorderHandle\":\"InlineEditorBlock_reorderHandle__2_s23\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"ContentEditor_row__JonRI\",\"form\":\"ContentEditor_form__wtoB9\",\"item\":\"ContentEditor_item__3U0XE\",\"inlineRowButton\":\"ContentEditor_inlineRowButton__2pw6r\",\"dragHandleButton\":\"ContentEditor_dragHandleButton__1Y_RP\"};"],"sourceRoot":""}